"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[4067],{32163:function(e,t,n){n.d(t,{a:function(){return h},b:function(){return i},c:function(){return a},d:function(){return w},e:function(){return f},f:function(){return c},g:function(){return s},h:function(){return l},l:function(){return u},n:function(){return m},o:function(){return g},t:function(){return d}});var r=n(44444),o=n(67026);function i(e,t){s(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function s(e,t,n=2,o=n){const i=t.length/2;let s=0,u=0;if((0,r.bA)(t)||(0,r.m1)(t)){for(let r=0;r<i;++r)e[s]=t[u],e[s+1]=t[u+1],s+=n,u+=o;return}const a=(0,r.m2)(t);if((0,r.m3)(t))for(let r=0;r<i;++r)e[s]=Math.max(t[u]/a,-1),e[s+1]=Math.max(t[u+1]/a,-1),s+=n,u+=o;else for(let r=0;r<i;++r)e[s]=t[u]/a,e[s+1]=t[u+1]/a,s+=n,u+=o}function u(e,t,n,r){const o=e.typedBuffer,i=e.typedBufferStride,s=r?.count??e.count;let u=(r?.dstIndex??0)*i;for(let a=0;a<s;++a)o[u]=t,o[u+1]=n,u+=i}function a(e,t){l(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function l(e,t,n=3,r=n){const o=t.length/r;let i=0,s=0;for(let u=0;u<o;++u)e[i]=t[s],e[i+1]=t[s+1],e[i+2]=t[s+2],i+=n,s+=r}function c(e,t,n,r,o){const i=e.typedBuffer,s=e.typedBufferStride,u=o?.count??e.count;let a=(o?.dstIndex??0)*s;for(let l=0;l<u;++l)i[a]=t,i[a+1]=n,i[a+2]=r,a+=s}function f(e,t){d(e.typedBuffer,t,e.typedBufferStride)}function d(e,t,n=4){const r=t.typedBuffer,o=t.typedBufferStride,i=t.count;let s=0,u=0;for(let a=0;a<i;++a)e[s]=r[u],e[s+1]=r[u+1],e[s+2]=r[u+2],e[s+3]=r[u+3],s+=n,u+=o}function h(e,t,n,r,o,i){const s=e.typedBuffer,u=e.typedBufferStride,a=i?.count??e.count;let l=(i?.dstIndex??0)*u;for(let c=0;c<a;++c)s[l]=t,s[l+1]=n,s[l+2]=r,s[l+3]=o,l+=u}Object.freeze(Object.defineProperty({__proto__:null,fill:u,normalizeIntegerBuffer:s,normalizeIntegerBufferView:i},Symbol.toStringTag,{value:"Module"})),Object.freeze(Object.defineProperty({__proto__:null,copy:l,copyView:a,fill:c},Symbol.toStringTag,{value:"Module"})),Object.freeze(Object.defineProperty({__proto__:null,copy:d,copyView:f,fill:h},Symbol.toStringTag,{value:"Module"}));class m{constructor(e){this._streamDataRequester=e}async loadJSON(e,t){return this._load("json",e,t)}async loadBinary(e,t){return(0,r.m4)(e)?((0,r.J)(t),(0,r.m5)(e)):this._load("binary",e,t)}async loadImage(e,t){return this._load("image",e,t)}async _load(e,t,n){if(null==this._streamDataRequester)return(await(0,r.U)(t,{responseType:p[e]})).data;const o=await(0,r.jT)(this._streamDataRequester.request(t,e,n));if(!0===o.ok)return o.value;throw(0,r.B)(o.error),new r.s("glt-loader-request-error",`Request for resource failed: ${o.error}`)}}const p={image:"image",binary:"array-buffer",json:"json","image+type":void 0};function g(e,t){switch(t){case r.hW.TRIANGLES:return y(e);case r.hW.TRIANGLE_STRIP:return b(e);case r.hW.TRIANGLE_FAN:return x(e)}}function y(e){return"number"==typeof e?(0,o.l)(e):(0,r.aD)(e)?new Uint16Array(e):e}function b(e){const t="number"==typeof e?e:e.length;if(t<3)return[];const n=t-2,r=(0,o.i)(3*n);if("number"==typeof e){let e=0;for(let t=0;t<n;t+=1)t%2==0?(r[e++]=t,r[e++]=t+1,r[e++]=t+2):(r[e++]=t+1,r[e++]=t,r[e++]=t+2)}else{let t=0;for(let o=0;o<n;o+=1)o%2==0?(r[t++]=e[o],r[t++]=e[o+1],r[t++]=e[o+2]):(r[t++]=e[o+1],r[t++]=e[o],r[t++]=e[o+2])}return r}function x(e){const t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);const n=t-2,r=n<=65536?new Uint16Array(3*n):new Uint32Array(3*n);if("number"==typeof e){let e=0;for(let t=0;t<n;++t)r[e++]=0,r[e++]=t+1,r[e++]=t+2;return r}const o=e[0];let i=e[1],s=0;for(let u=0;u<n;++u){const t=e[u+2];r[s++]=o,r[s++]=i,r[s++]=t,i=t}return r}const w=2.1},22889:function(e,t,n){function r(e){return e=e||globalThis.location.hostname,l.some((t=>null!=e?.match(t)))}function o(e,t){return e?(t=t||globalThis.location.hostname)?null!=t.match(i)||null!=t.match(u)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(s)||null!=t.match(a)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e:null}n.d(t,{a:function(){return o},c:function(){return r}});const i=/^devext\.arcgis\.com$/,s=/^qaext\.arcgis\.com$/,u=/^[\w-]*\.mapsdevext\.arcgis\.com$/,a=/^[\w-]*\.mapsqa\.arcgis\.com$/,l=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,i,s,/^jsapps\.esri\.com$/,u,a]},74067:function(e,t,n){n.d(t,{fetch:function(){return W}});var r=n(22889),o=n(44444),i=n(10769),s=n(77703),u=n(15317),a=n(50940),l=n(62381),c=n(16537),f=n(32163),d=n(84411),h=n(77485),m=n(67026),p=n(34550),g=n(9498),y=n(36012),b=n(30726),x=n(52454),w=n(71807),B=n(50094);function v(e,t){if(!e)return!1;const{size:n,data:r,indices:i}=e;(0,o.dQ)(t,0,0,0),(0,o.dQ)(O,0,0,0);let s=0,u=0;for(let a=0;a<i.length-2;a+=3){const e=i[a]*n,l=i[a+1]*n,c=i[a+2]*n;(0,o.dQ)(_,r[e],r[e+1],r[e+2]),(0,o.dQ)(M,r[l],r[l+1],r[l+2]),(0,o.dQ)(I,r[c],r[c+1],r[c+2]);const f=(0,b.S)(_,M,I);f?((0,o.dE)(_,_,M),(0,o.dE)(_,_,I),(0,o.dC)(_,_,1/3*f),(0,o.dE)(t,t,_),s+=f):((0,o.dE)(O,O,_),(0,o.dE)(O,O,M),(0,o.dE)(O,O,I),u+=3)}return(0!==u||0!==s)&&(0!==s?((0,o.dC)(t,t,1/s),!0):0!==u&&((0,o.dC)(t,O,1/u),!0))}function T(e,t){if(!e)return!1;const{size:n,data:r,indices:i}=e;(0,o.dQ)(t,0,0,0);let s=-1,u=0;for(let o=0;o<i.length;o++){const e=i[o]*n;s!==e&&(t[0]+=r[e],t[1]+=r[e+1],t[2]+=r[e+2],u++),s=e}return u>1&&(0,o.dC)(t,t,1/u),u>0}function S(e,t,n){if(!e)return!1;(0,o.dQ)(n,0,0,0),(0,o.dQ)(O,0,0,0);let r=0,i=0;const{size:s,data:u,indices:a}=e,l=a.length-1,c=l+(t?2:0);for(let f=0;f<c;f+=2){const e=f<l?f+1:0,t=a[f<l?f:l]*s,c=a[e]*s;_[0]=u[t],_[1]=u[t+1],_[2]=u[t+2],M[0]=u[c],M[1]=u[c+1],M[2]=u[c+2],(0,o.dC)(_,(0,o.dE)(_,_,M),.5);const d=(0,o.mk)(_,M);d>0?((0,o.dE)(n,n,(0,o.dC)(_,_,d)),r+=d):0===r&&((0,o.dE)(O,O,_),i++)}return 0!==r?((0,o.dC)(n,n,1/r),!0):0!==i&&((0,o.dC)(n,O,1/i),!0)}const _=(0,o.ap)(),M=(0,o.ap)(),I=(0,o.ap)(),O=(0,o.ap)();class A{constructor(){this.uid=(0,o.ir)()}}class R extends A{constructor(e){super(),this.highlightGroupName=e,this.channel=y.t.Highlight}}class E extends u.r{constructor(e,t,n=null,r=u.e.Mesh,o=null,i=-1){super(),this.material=e,this.mapPositions=n,this.type=r,this.objectAndLayerIdColor=o,this.edgeIndicesLength=i,this.highlights=new Set,this._highlightGroupCounts=new Map,this.visible=!0,this._attributes=new Map,this._boundingInfo=null;for(const[s,u]of t)this._attributes.set(s,{...u,indices:(0,m.t)(u.indices)}),s===w.e.POSITION&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._attributes.get(s).indices.length:this.edgeIndicesLength)}instantiate(e={}){const t=new E(e.material||this.material,[],this.mapPositions,this.type,this.objectAndLayerIdColor,this.edgeIndicesLength);return this._attributes.forEach(((e,n)=>{e.exclusive=!1,t._attributes.set(n,e)})),t._boundingInfo=this._boundingInfo,t.transformation=e.transformation||this.transformation,t}get attributes(){return this._attributes}getMutableAttribute(e){let t=this._attributes.get(e);return t&&!t.exclusive&&(t={...t,exclusive:!0,data:(0,u.o)(t.data)},this._attributes.set(e,t)),t}setAttributeData(e,t){const n=this._attributes.get(e);n&&this._attributes.set(e,{...n,exclusive:!0,data:t})}get indexCount(){return this._attributes.values().next().value.indices?.length??0}get faceCount(){return this.indexCount/3}get boundingInfo(){return null==this._boundingInfo&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(e){return!!(this.type===u.e.Mesh?this._computeAttachmentOriginTriangles(e):this.type===u.e.Line?this._computeAttachmentOriginLines(e):this._computeAttachmentOriginPoints(e))&&(null!=this._transformation&&(0,o.dX)(e,e,this._transformation),!0)}_computeAttachmentOriginTriangles(e){const t=this.attributes.get(w.e.POSITION);return v(t,e)}_computeAttachmentOriginLines(e){const t=this.attributes.get(w.e.POSITION);return S(t,C(this.material.parameters,t),e)}_computeAttachmentOriginPoints(e){const t=this.attributes.get(w.e.POSITION);return T(t,e)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const e=this.attributes.get(w.e.POSITION);if(!e||0===e.indices.length)return null;const t=this.type===u.e.Mesh?3:1;(0,x.s)(e.indices.length%t==0,"Indexing error: "+e.indices.length+" not divisible by "+t);const n=(0,m.l)(e.indices.length/t);return new u.a(n,t,e)}get transformation(){return this._transformation??s.o}set transformation(e){this._transformation=e&&e!==s.o?(0,s.r)(e):null}get highlightGroups(){return this._highlightGroupCounts}get hasHighlights(){return this._highlightGroupCounts.size>0}foreachHighlightGroup(e){this._highlightGroupCounts.forEach(((t,n)=>e(n)))}allocateIdAndHighlight(e){const t=new R(e);return this.addHighlight(t)}addHighlight(e){this.highlights.add(e);const{highlightGroupName:t}=e,n=(this._highlightGroupCounts.get(t)??0)+1;return this._highlightGroupCounts.set(t,n),e}removeHighlight(e){if(this.highlights.delete(e)){const{highlightGroupName:t}=e,n=this._highlightGroupCounts.get(t)??0;n<=1?this._highlightGroupCounts.delete(t):this._highlightGroupCounts.set(t,n-1)}}}function C(e,t){return!(!("isClosed"in e)||!e.isClosed)&&t.indices.length>2}function P(e){if(null==e)return null;const t=null!=e.offset?e.offset:o.ml,n=null!=e.rotation?e.rotation:0,r=null!=e.scale?e.scale:o.mm,s=(0,i.t)(1,0,0,0,1,0,t[0],t[1],1),u=(0,i.t)(Math.cos(n),-Math.sin(n),0,Math.sin(n),Math.cos(n),0,0,0,1),a=(0,i.t)(r[0],0,0,0,r[1],0,0,0,1),l=(0,i.e)();return(0,o.gF)(l,u,a),(0,o.gF)(l,s,l),l}class L{constructor(){this.geometries=new Array,this.materials=new Array,this.textures=new Array}}class N{constructor(e,t,n){this.name=e,this.lodThreshold=t,this.pivotOffset=n,this.stageResources=new L,this.numberOfVertices=0}}const j=()=>o.G.getLogger("esri.views.3d.layers.graphics.objectResourceUtils");async function k(e,t){const n=await G(e,t),r=await D(n.textureDefinitions??{},t);let i=0;for(const o in r)if(r.hasOwnProperty(o)){const e=r[o];i+=e?.image?e.image.width*e.image.height*4:0}return{resource:n,textures:r,size:i+(0,o.mn)(n)}}async function G(e,t){const n=t?.streamDataRequester;if(n)return U(e,n,t);const r=await(0,o.jT)((0,o.U)(e,t));if(!0===r.ok)return r.value.data;(0,o.B)(r.error),F(r.error)}async function U(e,t,n){const r=await(0,o.jT)(t.request(e,"json",n));if(!0===r.ok)return r.value;(0,o.B)(r.error),F(r.error.details.url)}function F(e){throw new o.s("",`Request for object resource failed: ${e}`)}function q(e){const t=e.params,n=t.topology;let r=!0;switch(t.vertexAttributes||(j().warn("Geometry must specify vertex attributes"),r=!1),t.topology){case"PerAttributeArray":break;case"Indexed":case null:case void 0:{const e=t.faces;if(e){if(t.vertexAttributes)for(const n in t.vertexAttributes){const t=e[n];t?.values?(null!=t.valueType&&"UInt32"!==t.valueType&&(j().warn(`Unsupported indexed geometry indices type '${t.valueType}', only UInt32 is currently supported`),r=!1),null!=t.valuesPerElement&&1!==t.valuesPerElement&&(j().warn(`Unsupported indexed geometry values per element '${t.valuesPerElement}', only 1 is currently supported`),r=!1)):(j().warn(`Indexed geometry does not specify face indices for '${n}' attribute`),r=!1)}}else j().warn("Indexed geometries must specify faces"),r=!1;break}default:j().warn(`Unsupported topology '${n}'`),r=!1}e.params.material||(j().warn("Geometry requires material"),r=!1);const o=e.params.vertexAttributes;for(const i in o)o[i].values||(j().warn("Geometries with externally defined attributes are not yet supported"),r=!1);return r}function V(e,t){const n=new Array,r=new Array,i=new Array,s=new h.t,a=e.resource,l=o.mo.parse(a.version||"1.0","wosr");Q.validate(l);const c=a.model.name,f=a.model.geometries,d=a.materialDefinitions??{},p=e.textures;let b=0;const x=new Map;for(let h=0;h<f.length;h++){const e=f[h];if(!q(e))continue;const a=H(e),l=e.params.vertexAttributes,c=[],B=t=>{if("PerAttributeArray"===e.params.topology)return null;const n=e.params.faces;for(const e in n)if(e===t)return n[e].values;return null},v=l[w.e.POSITION],T=v.values.length/v.valuesPerElement;for(const t in l){const e=l[t],n=e.values,r=B(t)??(0,m.l)(T);c.push([t,new g.t(n,r,e.valuesPerElement,!0)])}const S=a.texture,_=p&&p[S];if(_&&!x.has(S)){const{image:e,parameters:t}=_,n=new u.C(e,t);r.push(n),x.set(S,n)}const M=x.get(S),I=M?M.id:void 0,O=a.material;let A=s.get(O,S);if(null==A){const e=d[O.slice(O.lastIndexOf("/")+1)].params;1===e.transparency&&(e.transparency=0);const n=_&&_.alphaChannelUsage,r=e.transparency>0||"transparency"===n||"maskAndTransparency"===n,i=_?$(_.alphaChannelUsage):void 0,a={ambient:(0,o.fC)(e.diffuse),diffuse:(0,o.fC)(e.diffuse),opacity:1-(e.transparency||0),transparent:r,textureAlphaMode:i,textureAlphaCutoff:.33,textureId:I,initTextureTransparent:!0,doubleSided:!0,cullFace:y.e.None,colorMixMode:e.externalColorMixMode||"tint",textureAlphaPremultiplied:_?.parameters.preMultiplyAlpha??!1};t?.materialParameters&&Object.assign(a,t.materialParameters),A=new u.B(a,t),s.set(O,S,A)}i.push(A);const R=new E(A,c);b+=c.find((e=>e[0]===w.e.POSITION))?.[1]?.indices.length??0,n.push(R)}return{engineResources:[{name:c,stageResources:{textures:r,materials:i,geometries:n},pivotOffset:a.model.pivotOffset,numberOfVertices:b,lodThreshold:null}],referenceBoundingBox:z(n)}}function z(e){const t=(0,o.mp)();return e.forEach((e=>{const n=e.boundingInfo;null!=n&&((0,o.kE)(t,n.bbMin),(0,o.kE)(t,n.bbMax))})),t}async function D(e,t){const n=new Array;for(const s in e){const r=e[s],i=r.images[0].data;if(!i){j().warn("Externally referenced texture data is not yet supported");continue}const u=r.encoding+";base64,"+i,a="/textureDefinitions/"+s,l="rgba"===r.channels?r.alphaChannelUsage||"transparency":"none",c={noUnpackFlip:!0,wrap:{s:o.cx.REPEAT,t:o.cx.REPEAT},preMultiplyAlpha:$(l)!==y.i.Opaque},f=t?.disableTextures?Promise.resolve(null):(0,p.t)(u,t);n.push(f.then((e=>({refId:a,image:e,parameters:c,alphaChannelUsage:l}))))}const r=await Promise.all(n),i={};for(const o of r)i[o.refId]=o;return i}function $(e){switch(e){case"mask":return y.i.Mask;case"maskAndTransparency":return y.i.MaskBlend;case"none":return y.i.Opaque;default:return y.i.Blend}}function H(e){const t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}const Q=new o.mo(1,2,"wosr");async function W(e,t){const o=X((0,r.a)(e));if("wosr"===o.fileType){const e=await(t.cache?t.cache.loadWOSR(o.url,t):k(o.url,t)),{engineResources:n,referenceBoundingBox:r}=V(e,t);return{lods:n,referenceBoundingBox:r,isEsriSymbolResource:!1,isWosr:!0}}let i;if(t.cache)i=await t.cache.loadGLTF(o.url,t,!!t.usePBR);else{const{loadGLTF:e}=await n.e(7504).then(n.bind(n,77504));i=await e(new f.n(t.streamDataRequester),o.url,t,t.usePBR)}const s=i.model.meta?.ESRI_proxyEllipsoid,a=i.meta.isEsriSymbolResource&&null!=s&&"EsriRealisticTreesStyle"===i.meta.ESRI_webstyle;a&&!i.customMeta.esriTreeRendering&&(i.customMeta.esriTreeRendering=!0,te(i,s));const l=!!t.usePBR,c=i.meta.isEsriSymbolResource?{usePBR:l,isSchematic:!1,treeRendering:a,mrrFactors:u.s}:{usePBR:l,isSchematic:!1,treeRendering:!1,mrrFactors:u.t},d={...t.materialParameters,treeRendering:a},{engineResources:h,referenceBoundingBox:m}=J(i,c,d,t,o.specifiedLodIndex);return{lods:h,referenceBoundingBox:m,isEsriSymbolResource:i.meta.isEsriSymbolResource,isWosr:!1}}function X(e){const t=e.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return t?{fileType:"gltf",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null}:e.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:e,specifiedLodIndex:null}:{fileType:"unknown",url:e,specifiedLodIndex:null}}function J(e,t,n,r,i){const s=e.model,a=new Array,l=new Map,c=new Map,f=s.lods.length,d=(0,o.mp)();return s.lods.forEach(((e,h)=>{const m=!0===r.skipHighLods&&(f>1&&0===h||f>3&&1===h)||!1===r.skipHighLods&&null!=i&&h!==i;if(m&&0!==h)return;const p=new N(e.name,e.lodThreshold,[0,0,0]);e.parts.forEach((e=>{const i=m?new u.B({},r):K(s,e,p,t,n,l,c,r),{geometry:a,vertexCount:f}=Y(e,i??new u.B({},r)),g=a.boundingInfo;null!=g&&0===h&&((0,o.kE)(d,g.bbMin),(0,o.kE)(d,g.bbMax)),null!=i&&(p.stageResources.geometries.push(a),p.numberOfVertices+=f)})),m||a.push(p)})),{engineResources:a,referenceBoundingBox:d}}function K(e,t,n,r,i,s,a,l){const c=t.material+(t.attributes.normal?"_normal":"")+(t.attributes.color?"_color":"")+(t.attributes.texCoord0?"_texCoord0":"")+(t.attributes.tangent?"_tangent":""),h=e.materials.get(t.material),m=null!=t.attributes.texCoord0,p=null!=t.attributes.normal;if(null==h)return null;const g=ee(h.alphaMode);if(!s.has(c)){if(m){const t=(t,n=!1)=>{if(null!=t&&!a.has(t)){const r=e.textures.get(t);if(null!=r){const e=r.data;a.set(t,new u.C((0,d.r)(e)?e.data:e,{...r.parameters,preMultiplyAlpha:!(0,d.r)(e)&&n,encoding:(0,d.r)(e)&&null!=e.encoding?e.encoding:void 0}))}}};t(h.textureColor,g!==y.i.Opaque),t(h.textureNormal),t(h.textureOcclusion),t(h.textureEmissive),t(h.textureMetallicRoughness)}const n=h.color[0]**(1/f.d),b=h.color[1]**(1/f.d),x=h.color[2]**(1/f.d),w=h.emissiveFactor[0]**(1/f.d),v=h.emissiveFactor[1]**(1/f.d),T=h.emissiveFactor[2]**(1/f.d),S=null!=h.textureColor&&m?a.get(h.textureColor):null,_=(0,u.n)({normalTexture:h.textureNormal,metallicRoughnessTexture:h.textureMetallicRoughness,metallicFactor:h.metallicFactor,roughnessFactor:h.roughnessFactor,emissiveTexture:h.textureEmissive,emissiveFactor:h.emissiveFactor,occlusionTexture:h.textureOcclusion}),M=null!=h.normalTextureTransform?.scale?h.normalTextureTransform?.scale:o.mq;s.set(c,new u.B({...r,transparent:g===y.i.Blend,customDepthTest:y.n.Lequal,textureAlphaMode:g,textureAlphaCutoff:h.alphaCutoff,diffuse:[n,b,x],ambient:[n,b,x],opacity:h.opacity,doubleSided:h.doubleSided,doubleSidedType:"winding-order",cullFace:h.doubleSided?y.e.None:y.e.Back,hasVertexColors:!!t.attributes.color,hasVertexTangents:!!t.attributes.tangent,normalType:p?B.a.Attribute:B.a.ScreenDerivative,castShadows:!0,receiveShadows:h.receiveShadows,receiveAmbientOcclusion:h.receiveAmbientOcclustion,textureId:S?.id,colorMixMode:h.colorMixMode,normalTextureId:null!=h.textureNormal&&m?a.get(h.textureNormal).id:void 0,textureAlphaPremultiplied:null!=S&&!!S.parameters.preMultiplyAlpha,occlusionTextureId:null!=h.textureOcclusion&&m?a.get(h.textureOcclusion).id:void 0,emissiveTextureId:null!=h.textureEmissive&&m?a.get(h.textureEmissive).id:void 0,metallicRoughnessTextureId:null!=h.textureMetallicRoughness&&m?a.get(h.textureMetallicRoughness).id:void 0,emissiveFactor:[w,v,T],mrrFactors:_?u.b:[h.metallicFactor,h.roughnessFactor,r.mrrFactors[2]],isSchematic:_,colorTextureTransformMatrix:P(h.colorTextureTransform),normalTextureTransformMatrix:P(h.normalTextureTransform),scale:[M[0],M[1]],occlusionTextureTransformMatrix:P(h.occlusionTextureTransform),emissiveTextureTransformMatrix:P(h.emissiveTextureTransform),metallicRoughnessTextureTransformMatrix:P(h.metallicRoughnessTextureTransform),...i},l))}const b=s.get(c);if(n.stageResources.materials.push(b),m){const e=e=>{null!=e&&n.stageResources.textures.push(a.get(e))};e(h.textureColor),e(h.textureNormal),e(h.textureOcclusion),e(h.textureEmissive),e(h.textureMetallicRoughness)}return b}function Y(e,t){const n=e.attributes.position.count,r=(0,f.o)(e.indices||n,e.primitiveType),i=(0,u.c)(3*n),{typedBuffer:s,typedBufferStride:d}=e.attributes.position;(0,l.e)(i,s,e.transform,3,d);const h=[[w.e.POSITION,new g.t(i,r,3,!0)]];if(null!=e.attributes.normal){const t=(0,u.c)(3*n),{typedBuffer:i,typedBufferStride:s}=e.attributes.normal;(0,o.gc)(Z,e.transform),(0,l.f)(t,i,Z,3,s),(0,o.gd)(Z)&&(0,l.l)(t,t),h.push([w.e.NORMAL,new g.t(t,r,3,!0)])}if(null!=e.attributes.tangent){const t=(0,u.c)(4*n),{typedBuffer:i,typedBufferStride:s}=e.attributes.tangent;(0,o.ge)(Z,e.transform),(0,c.n)(t,i,Z,4,s),(0,o.gd)(Z)&&(0,l.l)(t,t,4),h.push([w.e.TANGENT,new g.t(t,r,4,!0)])}if(null!=e.attributes.texCoord0){const t=(0,u.c)(2*n),{typedBuffer:o,typedBufferStride:i}=e.attributes.texCoord0;(0,f.g)(t,o,2,i),h.push([w.e.UV0,new g.t(t,r,2,!0)])}const m=e.attributes.color;if(null!=m){const t=new Uint8Array(4*n);4===m.elementCount?m instanceof a.c?(0,c.s)(t,m,255):m instanceof a.x?(0,f.t)(t,m):m instanceof a.L&&(0,c.s)(t,m,1/256):(t.fill(255),m instanceof a.i?(0,l.o)(t,m.typedBuffer,255,4,m.typedBufferStride):e.attributes.color instanceof a.O?(0,f.h)(t,m.typedBuffer,4,e.attributes.color.typedBufferStride):e.attributes.color instanceof a.E&&(0,l.o)(t,m.typedBuffer,1/256,4,m.typedBufferStride)),h.push([w.e.COLOR,new g.t(t,r,4,!0)])}return{geometry:new E(t,h),vertexCount:n}}const Z=(0,i.e)();function ee(e){switch(e){case"BLEND":return y.i.Blend;case"MASK":return y.i.Mask;case"OPAQUE":case null:case void 0:return y.i.Opaque}}function te(e,t){for(let n=0;n<e.model.lods.length;++n){const r=e.model.lods[n];for(const i of r.parts){const r=i.attributes.normal;if(null==r)return;const u=i.attributes.position,l=u.count,c=(0,o.ap)(),f=(0,o.ap)(),d=(0,o.ap)(),h=new Uint8Array(4*l),m=new Float64Array(3*l),p=(0,o.dV)((0,s.e)(),i.transform);let g=0,y=0;for(let s=0;s<l;s++){u.getVec(s,f),r.getVec(s,c),(0,o.dX)(f,f,i.transform),(0,o.dB)(d,f,t.center),(0,o.mr)(d,d,t.radius);const a=d[2],l=(0,o.dS)(d),b=Math.min(.45+.55*l*l,1);(0,o.mr)(d,d,t.radius),null!==p&&(0,o.dX)(d,d,p),(0,o.ao)(d,d),n+1!==e.model.lods.length&&e.model.lods.length>1&&(0,o.iX)(d,d,c,a>-1?.2:Math.min(-4*a-3.8,1)),m[g]=d[0],m[g+1]=d[1],m[g+2]=d[2],g+=3,h[y]=255*b,h[y+1]=255*b,h[y+2]=255*b,h[y+3]=255,y+=4}i.attributes.normal=new a.i(m),i.attributes.color=new a.x(h)}}}},84411:function(e,t,n){n.d(t,{n:function(){return u},o:function(){return a},r:function(){return s},t:function(){return i}});var r=n(44444),o=n(36012);class i{constructor(e){this.data=e,this.type="encoded-mesh-texture",this.encoding=o.u.KTX2_ENCODING}}function s(e){return"encoded-mesh-texture"===e?.type}async function u(e){const t=new Blob([e]),n=await t.text();return JSON.parse(n)}async function a(e,t){if(t===o.u.KTX2_ENCODING)return new i(e);const n=new Blob([e],{type:t}),s=URL.createObjectURL(n),u=new Image;if((0,r.Q)("esri-iPhone"))return new Promise(((e,t)=>{const n=()=>{o(),e(u)},r=e=>{o(),t(e)},o=()=>{URL.revokeObjectURL(s),u.removeEventListener("load",n),u.removeEventListener("error",r)};u.addEventListener("load",n),u.addEventListener("error",r),u.src=s}));try{u.src=s,await u.decode()}catch{console.warn("Failed decoding HTMLImageElement")}return URL.revokeObjectURL(s),u}},62381:function(e,t,n){n.d(t,{e:function(){return o},f:function(){return s},i:function(){return l},l:function(){return f},n:function(){return u},o:function(){return a},r:function(){return i},t:function(){return r},u:function(){return c}});n(44444);function r(e,t,n){o(e.typedBuffer,t.typedBuffer,n,e.typedBufferStride,t.typedBufferStride)}function o(e,t,n,r=3,o=r){if(e.length/r!==Math.ceil(t.length/o))return e;const i=e.length/r,s=n[0],u=n[1],a=n[2],l=n[4],c=n[5],f=n[6],d=n[8],h=n[9],m=n[10],p=n[12],g=n[13],y=n[14];let b=0,x=0;for(let w=0;w<i;w++){const n=t[b],i=t[b+1],w=t[b+2];e[x]=s*n+l*i+d*w+p,e[x+1]=u*n+c*i+h*w+g,e[x+2]=a*n+f*i+m*w+y,b+=o,x+=r}return e}function i(e,t,n){s(e.typedBuffer,t.typedBuffer,n,e.typedBufferStride,t.typedBufferStride)}function s(e,t,n,r=3,o=r){if(e.length/r!==Math.ceil(t.length/o))return;const i=e.length/r,s=n[0],u=n[1],a=n[2],l=n[3],c=n[4],f=n[5],d=n[6],h=n[7],m=n[8];let p=0,g=0;for(let y=0;y<i;y++){const n=t[p],i=t[p+1],y=t[p+2];e[g]=s*n+l*i+d*y,e[g+1]=u*n+c*i+h*y,e[g+2]=a*n+f*i+m*y,p+=o,g+=r}}function u(e,t,n){a(e.typedBuffer,t.typedBuffer,n,e.typedBufferStride,t.typedBufferStride)}function a(e,t,n,r=3,o=r){const i=Math.min(e.length/r,t.length/o);let s=0,u=0;for(let a=0;a<i;a++)e[u]=n*t[s],e[u+1]=n*t[s+1],e[u+2]=n*t[s+2],s+=o,u+=r;return e}function l(e,t,n,r=3,o=r){const i=e.length/r;if(i!==Math.ceil(t.length/o))return e;let s=0,u=0;for(let a=0;a<i;a++)e[u]=t[s]+n[0],e[u+1]=t[s+1]+n[1],e[u+2]=t[s+2]+n[2],s+=o,u+=r;return e}function c(e,t){f(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function f(e,t,n=3,r=n){const o=Math.min(e.length/n,t.length/r);let i=0,s=0;for(let u=0;u<o;u++){const o=t[i],u=t[i+1],a=t[i+2],l=o*o+u*u+a*a;if(l>0){const t=1/Math.sqrt(l);e[s]=t*o,e[s+1]=t*u,e[s+2]=t*a}i+=r,s+=n}}function d(e,t,n){const r=Math.min(e.count,t.count),o=e.typedBuffer,i=e.typedBufferStride,s=t.typedBuffer,u=t.typedBufferStride;let a=0,l=0;for(let c=0;c<r;c++)o[l]=s[a]>>n,o[l+1]=s[a+1]>>n,o[l+2]=s[a+2]>>n,a+=u,l+=i}Object.freeze(Object.defineProperty({__proto__:null,normalize:f,normalizeView:c,scale:a,scaleView:u,shiftRight:d,transformMat3:s,transformMat3View:i,transformMat4:o,transformMat4View:r,translate:l},Symbol.toStringTag,{value:"Module"}))},16537:function(e,t,n){n.d(t,{f:function(){return u},n:function(){return a},o:function(){return l},s:function(){return f},u:function(){return c}});var r=n(44444);const o=()=>r.G.getLogger("esri.views.3d.support.buffer.math");function i(e,t,n){if(e.count!==t.count)return;const r=e.count,o=n[0],i=n[1],s=n[2],u=n[3],a=n[4],l=n[5],c=n[6],f=n[7],d=n[8],h=n[9],m=n[10],p=n[11],g=n[12],y=n[13],b=n[14],x=n[15],w=e.typedBuffer,B=e.typedBufferStride,v=t.typedBuffer,T=t.typedBufferStride;for(let S=0;S<r;S++){const e=S*B,t=S*T,n=v[t],r=v[t+1],_=v[t+2],M=v[t+3];w[e]=o*n+a*r+d*_+g*M,w[e+1]=i*n+l*r+h*_+y*M,w[e+2]=s*n+c*r+m*_+b*M,w[e+3]=u*n+f*r+p*_+x*M}}function s(e,t,n,r=4,i=r){if(e.length/r!=t.length/i)return void o().error("source and destination buffers need to have the same number of elements");const s=e.length/r,u=n[0],a=n[1],l=n[2],c=n[3],f=n[4],d=n[5],h=n[6],m=n[7],p=n[8],g=n[9],y=n[10],b=n[11],x=n[12],w=n[13],B=n[14],v=n[15];let T=0,S=0;for(let o=0;o<s;o++){const n=t[T],o=t[T+1],s=t[T+2],_=t[T+3];e[S]=u*n+f*o+p*s+x*_,e[S+1]=a*n+d*o+g*s+w*_,e[S+2]=l*n+h*o+y*s+B*_,e[S+3]=c*n+m*o+b*s+v*_,T+=i,S+=r}}function u(e,t,n){a(e.typedBuffer,t.typedBuffer,n,e.typedBufferStride,t.typedBufferStride)}function a(e,t,n,r=4,o=r){if(e.length/r!=t.length/o)return;const i=e.length/r,s=n[0],u=n[1],a=n[2],l=n[3],c=n[4],f=n[5],d=n[6],h=n[7],m=n[8];let p=0,g=0;for(let y=0;y<i;y++){const n=t[p],i=t[p+1],y=t[p+2],b=t[p+3];e[g]=s*n+l*i+d*y,e[g+1]=u*n+c*i+h*y,e[g+2]=a*n+f*i+m*y,e[g+3]=b,p+=o,g+=r}}function l(e,t){const n=Math.min(e.count,t.count),r=e.typedBuffer,o=e.typedBufferStride,i=t.typedBuffer,s=t.typedBufferStride;for(let u=0;u<n;u++){const e=u*o,t=u*s,n=i[t],a=i[t+1],l=i[t+2],c=n*n+a*a+l*l;if(c>0){const t=1/Math.sqrt(c);r[e]=t*n,r[e+1]=t*a,r[e+2]=t*l}}}function c(e,t,n){f(e.typedBuffer,t,n,e.typedBufferStride)}function f(e,t,n,r=4){const o=Math.min(e.length/r,t.count),i=t.typedBuffer,s=t.typedBufferStride;let u=0,a=0;for(let l=0;l<o;l++)e[a]=n*i[u],e[a+1]=n*i[u+1],e[a+2]=n*i[u+2],e[a+3]=n*i[u+3],u+=s,a+=r}Object.freeze(Object.defineProperty({__proto__:null,normalize:l,scale:f,scaleView:c,transformMat3:a,transformMat3View:u,transformMat4:s,transformMat4View:i},Symbol.toStringTag,{value:"Module"}))}}]);
//# sourceMappingURL=4067.5c2adf96.js.map