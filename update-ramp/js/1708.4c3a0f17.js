"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[1708],{71708:function(e,n,t){t.r(n),t.d(n,{registerFunctions:function(){return T}});var i=t(96628),a=t(41721),r=t(66485),s=t(92993),l=t(70356),o=t(30373),d=t(1208),f=t(72667),u=t(44444),c=t(10413);function m(e){if(1===e.length){if((0,r.E)(e[0]))return(0,a.l)("distinct",e[0],-1);if((0,r.X)(e[0]))return(0,a.l)("distinct",e[0].toArray(),-1)}return(0,a.l)("distinct",e,-1)}async function y(e,n,t){const i=e.getVariables();if(i.length>0){const a=[];for(let e=0;e<i.length;e++){const r={name:i[e]};a.push(await n.evaluateIdentifier(t,r))}const r={};for(let e=0;e<i.length;e++)r[i[e]]=a[e];return e.parameters=r,e}return e}function p(e,n,t=null){for(const i in e)if(i.toLowerCase()===n.toLowerCase())return e[i];return t}function w(e){if(null===e)return null;const n={type:p(e,"type",""),name:p(e,"name","")};if("range"===n.type)n.range=p(e,"range",[]);else{n.codedValues=[];for(const t of p(e,"codedValues",[]))n.codedValues.push({name:p(t,"name",""),code:p(t,"code",null)})}return n}function h(e){if(null===e)return null;const n={},t=p(e,"wkt");null!==t&&(n.wkt=t);const i=p(e,"wkid");return null!==i&&(n.wkid=i),n}function I(e){if(null===e)return null;const n={hasZ:p(e,"hasz",!1),hasM:p(e,"hasm",!1)},t=p(e,"spatialreference");null!=t&&(n.spatialReference=h(t));const i=p(e,"x",null);if(null!==i)return n.x=i,n.y=p(e,"y",null),n.hasZ&&(n.z=p(e,"z",null)),n.hasM&&(n.m=p(e,"m",null)),n;const a=p(e,"rings",null);if(null!==a)return n.rings=a,n;const r=p(e,"paths",null);if(null!==r)return n.paths=r,n;const s=p(e,"points",null);if(null!==s)return n.points=s,n;for(const l of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const t=p(e,l,null);null!==t&&(n[l]=t)}return n}function g(e,n){for(const t of n)if(t===e)return!0;return!1}function F(e){return!!e.layerDefinition&&!!e.featureSet&&!1!==g(e.layerDefinition.geometryType,["",null,"esriGeometryNull","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&!1!==(0,r.E)(e.layerDefinition.fields)&&!1!==(0,r.E)(e.featureSet.features)}function D(e){return"utc"===e?.toLowerCase()?"UTC":"unknown"===e?.toLowerCase()?"Unknown":e}function T(e){"async"===e.mode&&(e.functions.timezone=function(n,t){return e.standardFunctionAsync(n,t,(async(e,s,l)=>{if((0,r.i)(l,1,2,n,t),(0,r.g)(l[0])||(0,r.t)(l[0]))return"Unknown";if((0,r.K)(l[0])){if(await l[0].load(),1===l.length||null===l[1])return l[0].datesInUnknownTimezone?D("unknown"):D(l[0].dateFieldsTimeZone);if(!(l[1]instanceof a.N)||!1===l[1].hasField("type"))throw new r.a(n,r.r.InvalidParameter,t);const e=l[1].field("type");if(!1===(0,r.P)(e))throw new r.a(n,r.r.InvalidParameter,t);switch((0,r.d)(e).toLowerCase()){case"preferredtimezone":return D(l[0].preferredTimeZone);case"editfieldsinfo":return D(l[0].editFieldsInfo?.timeZone??null);case"timeinfo":return D(l[0].timeInfo?.timeZone??null);case"field":if(l[1].hasField("fieldname")&&(0,r.P)(l[1].field("fieldname")))return D(l[0].fieldTimeZone((0,r.d)(l[1].field("fieldname"))))}throw new r.a(n,r.r.InvalidParameter,t)}const o=(0,r.j)(l[0],(0,r.B)(n));if(null===o)return null;const d=o.timeZone;return"system"===d?i.m.systemTimeZoneCanonicalName:"utc"===d.toLowerCase()?"UTC":"unknown"===d.toLowerCase()?"Unknown":d}))},e.functions.sqltimestamp=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{(0,r.i)(a,1,3,n,t);const s=a[0];if((0,r.k)(s)){if(1===a.length)return s.toSQLWithKeyword();if(2===a.length)return s.changeTimeZone((0,r.d)(a[1])).toSQLWithKeyword();throw new r.a(n,r.r.InvalidParameter,t)}if((0,r.t)(s))return s.toSQLWithKeyword();if((0,r.K)(s)){if(3!==a.length)throw new r.a(n,r.r.InvalidParameter,t);await s.load();const e=(0,r.d)(a[1]);if((0,r.t)(a[2]))return a[2].toSQLWithKeyword();if(!1===(0,r.k)(a[2]))throw new r.a(n,r.r.InvalidParameter,t);const i=s.fieldTimeZone(e);return null===i?a[2].toSQLWithKeyword():a[2].changeTimeZone(i).toSQLWithKeyword()}throw new r.a(n,r.r.InvalidParameter,t)}))},e.signatures.push({name:"sqltimestamp",min:2,max:4}),e.functions.featuresetbyid=function(n,t){return e.standardFunctionAsync(n,t,((e,i,a)=>{if((0,r.i)(a,2,4,n,t),(0,r.W)(a[0])){const e=(0,r.d)(a[1]);let i=(0,r.Y)(a[2],null);const s=(0,r.S)((0,r.Y)(a[3],!0));if(null===i&&(i=["*"]),!1===(0,r.E)(i))throw new r.a(n,r.r.InvalidParameter,t);return a[0].featureSetById(e,s,i)}throw new r.a(n,r.r.InvalidParameter,t)}))},e.signatures.push({name:"featuresetbyid",min:2,max:4}),e.functions.getfeatureset=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{if((0,r.i)(a,1,2,n,t),(0,r.U)(a[0])){let e=(0,r.Y)(a[1],"datasource");return null===e&&(e="datasource"),e=(0,r.d)(e).toLowerCase(),(0,s.M)(a[0].fullSchema(),e,n.lrucache,n.interceptor,n.spatialReference??null)}throw new r.a(n,r.r.InvalidParameter,t)}))},e.signatures.push({name:"getfeatureset",min:1,max:2}),e.functions.featuresetbyportalitem=function(n,t){return e.standardFunctionAsync(n,t,((e,i,l)=>{if((0,r.i)(l,2,5,n,t),null===l[0])throw new r.a(n,r.r.PortalRequired,t);if(l[0]instanceof a.t){const e=(0,r.d)(l[1]),i=(0,r.d)(l[2]);let a=(0,r.Y)(l[3],null);const d=(0,r.S)((0,r.Y)(l[4],!0));if(null===a&&(a=["*"]),!1===(0,r.E)(a))throw new r.a(n,r.r.InvalidParameter,t);let f;return f=n.services?.portal?n.services.portal:u.e.getDefault(),f=(0,o.l)(l[0],f),(0,s.q)(e,i,n.spatialReference??null,a,d,f,n.lrucache,n.interceptor)}if(!1===(0,r.P)(l[0]))throw new r.a(n,r.r.PortalRequired,t);const d=(0,r.d)(l[0]),f=(0,r.d)(l[1]);let c=(0,r.Y)(l[2],null);const m=(0,r.S)((0,r.Y)(l[3],!0));if(null===c&&(c=["*"]),!1===(0,r.E)(c))throw new r.a(n,r.r.InvalidParameter,t);return(0,s.q)(d,f,n.spatialReference??null,c,m,n.services?.portal??u.e.getDefault(),n.lrucache,n.interceptor)}))},e.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),e.functions.featuresetbyname=function(n,t){return e.standardFunctionAsync(n,t,((e,i,a)=>{if((0,r.i)(a,2,4,n,t),(0,r.W)(a[0])){const e=(0,r.d)(a[1]);let i=(0,r.Y)(a[2],null);const s=(0,r.S)((0,r.Y)(a[3],!0));if(null===i&&(i=["*"]),!1===(0,r.E)(i))throw new r.a(n,r.r.InvalidParameter,t);return a[0].featureSetByName(e,s,i)}throw new r.a(n,r.r.InvalidParameter,t)}))},e.signatures.push({name:"featuresetbyname",min:2,max:4}),e.functions.featureset=function(n,t){return e.standardFunction(n,t,((e,i,l)=>{(0,r.i)(l,1,1,n,t);const o={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",hasM:!1,hasZ:!1,fields:[]},featureSet:{geometryType:"",features:[]}};if((0,r.P)(l[0])){const e=JSON.parse(l[0]);void 0!==e.layerDefinition?(o.layerDefinition=e.layerDefinition,o.featureSet=e.featureSet,e.layerDefinition.spatialReference&&(o.layerDefinition.spatialReference=e.layerDefinition.spatialReference)):(o.featureSet.features=e.features,o.featureSet.geometryType=e.geometryType,o.layerDefinition.geometryType=o.featureSet.geometryType,o.layerDefinition.objectIdField=e.objectIdFieldName??"",o.layerDefinition.typeIdField=e.typeIdFieldName,o.layerDefinition.globalIdField=e.globalIdFieldName,o.layerDefinition.fields=e.fields,e.spatialReference&&(o.layerDefinition.spatialReference=e.spatialReference))}else{if(!(l[0]instanceof a.N))throw new r.a(n,r.r.InvalidParameter,t);{const e=JSON.parse(l[0].castToText(!0)),i=p(e,"layerdefinition");if(null!==i){o.layerDefinition.geometryType=p(i,"geometrytype",""),o.featureSet.geometryType=o.layerDefinition.geometryType,o.layerDefinition.globalIdField=p(i,"globalidfield",""),o.layerDefinition.objectIdField=p(i,"objectidfield",""),o.layerDefinition.typeIdField=p(i,"typeidfield",""),o.layerDefinition.hasZ=!0===p(i,"hasz",!1),o.layerDefinition.hasM=!0===p(i,"hasm",!1);const n=p(i,"spatialreference");n&&(o.layerDefinition.spatialReference=h(n));const t=[];for(const e of p(i,"fields",[])){const n={name:p(e,"name",""),alias:p(e,"alias",""),type:p(e,"type",""),nullable:p(e,"nullable",!0),editable:p(e,"editable",!0),length:p(e,"length",null),domain:w(p(e,"domain"))};t.push(n)}o.layerDefinition.fields=t;const a=p(e,"featureset");if(a){const e={};for(const n of t)e[n.name.toLowerCase()]=n.name;for(const n of p(a,"features",[])){const t={},i=p(n,"attributes",{});for(const n in i)t[e[n.toLowerCase()]]=i[n];o.featureSet.features.push({attributes:t,geometry:I(p(n,"geometry"))})}}}else{o.layerDefinition.hasZ=!0===p(e,"hasz",!1),o.layerDefinition.hasM=!0===p(e,"hasm",!1),o.layerDefinition.geometryType=p(e,"geometrytype",""),o.featureSet.geometryType=o.layerDefinition.geometryType,o.layerDefinition.objectIdField=p(e,"objectidfieldname",""),o.layerDefinition.typeIdField=p(e,"typeidfieldname","");const i=p(e,"spatialreference");i&&(o.layerDefinition.spatialReference=h(i));const a=[],s=p(e,"fields",null);if(!(0,r.E)(s))throw new r.a(n,r.r.InvalidParameter,t);for(const e of s){const n={name:p(e,"name",""),alias:p(e,"alias",""),type:p(e,"type",""),nullable:p(e,"nullable",!0),editable:p(e,"editable",!0),length:p(e,"length",null),domain:w(p(e,"domain"))};a.push(n)}o.layerDefinition.fields=a;const l={};for(const e of a)l[e.name.toLowerCase()]=e.name;let d=p(e,"features",null);if((0,r.E)(d))for(const e of d){const n={},t=p(e,"attributes",{});for(const e in t)n[l[e.toLowerCase()]]=t[e];o.featureSet.features.push({attributes:n,geometry:I(p(e,"geometry",null))})}else d=null,o.featureSet.features=d}}}if(!1===F(o))throw new r.a(n,r.r.InvalidParameter,t);return o.layerDefinition.geometryType||(o.layerDefinition.geometryType="esriGeometryNull"),s.f.create(o,n.spatialReference)}))},e.signatures.push({name:"featureset",min:1,max:1}),e.functions.filter=function(n,t){return e.standardFunctionAsync(n,t,(async(i,a,o)=>{if((0,r.i)(o,2,2,n,t),(0,r.E)(o[0])||(0,r.X)(o[0])){const e=[];let i,a=o[0];if(a instanceof l.t&&(a=a.toArray()),!(0,r.v)(o[1]))throw new r.a(n,r.r.InvalidParameter,t);i=o[1].createFunction(n);for(const n of a){const t=i(n);(0,u.f3)(t)?!0===await t&&e.push(n):!0===t&&e.push(n)}return e}if((0,r.K)(o[0])){const t=await o[0].load(),i=c.Z.create(o[1],{fieldsIndex:t.getFieldsIndex(),timeZone:t.dateFieldsTimeZoneDefaultUTC}),a=i.getVariables();if(a.length>0){const t=[];for(let i=0;i<a.length;i++){const r={name:a[i]};t.push(await e.evaluateIdentifier(n,r))}const r={};for(let e=0;e<a.length;e++)r[a[e]]=t[e];return i.parameters=r,new s.c({parentfeatureset:o[0],whereclause:i})}return new s.c({parentfeatureset:o[0],whereclause:i})}throw new r.a(n,r.r.InvalidParameter,t)}))},e.signatures.push({name:"filter",min:2,max:2}),e.functions.orderby=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{if((0,r.i)(a,2,2,n,t),(0,r.K)(a[0])){const e=new s.e(a[1]);return new s.a({parentfeatureset:a[0],orderbyclause:e})}throw new r.a(n,r.r.InvalidParameter,t)}))},e.signatures.push({name:"orderby",min:2,max:2}),e.functions.top=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{if((0,r.i)(a,2,2,n,t),(0,r.K)(a[0]))return new s.b({parentfeatureset:a[0],topnum:a[1]});if((0,r.E)(a[0]))return(0,r.h)(a[1])>=a[0].length?a[0].slice():a[0].slice(0,(0,r.h)(a[1]));if((0,r.X)(a[0]))return(0,r.h)(a[1])>=a[0].length()?a[0].slice():a[0].slice(0,(0,r.h)(a[1]));throw new r.a(n,r.r.InvalidParameter,t)}))},e.signatures.push({name:"top",min:2,max:2}),e.functions.first=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,s)=>{if((0,r.i)(s,1,1,n,t),(0,r.K)(s[0])){const t=await s[0].first(e.abortSignal);if(null!==t){const e=a.D.createFromGraphicLikeObject(t.geometry,t.attributes,s[0],n.timeZone);return e._underlyingGraphic=t,e}return t}return(0,r.E)(s[0])?0===s[0].length?null:s[0][0]:(0,r.X)(s[0])?0===s[0].length()?null:s[0].get(0):null}))},e.signatures.push({name:"first",min:1,max:1}),e.functions.attachments=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,l)=>{(0,r.i)(l,1,2,n,t);const o={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(l.length>1)if(l[1]instanceof a.N){if(l[1].hasField("minsize")&&(o.minsize=(0,r.h)(l[1].field("minsize"))),l[1].hasField("metadata")&&(o.returnMetadata=(0,r.S)(l[1].field("metadata"))),l[1].hasField("maxsize")&&(o.maxsize=(0,r.h)(l[1].field("maxsize"))),l[1].hasField("types")){const e=(0,r.J)(l[1].field("types"),!1);e.length>0&&(o.types=e)}}else if(null!==l[1])throw new r.a(n,r.r.InvalidParameter,t);if((0,r.U)(l[0])){let e=l[0]._layer;return e instanceof u.eQ&&(e=(0,s.T)(e,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===e||!1===(0,r.K)(e)?[]:(await e.load(),e.queryAttachments(l[0].field(e.objectIdField),o.minsize,o.maxsize,o.types,o.returnMetadata))}if(null===l[0])return[];throw new r.a(n,r.r.InvalidParameter,t)}))},e.signatures.push({name:"attachments",min:1,max:2}),e.functions.featuresetbyrelationshipname=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{(0,r.i)(a,2,4,n,t);const l=a[0],o=(0,r.d)(a[1]);let f=(0,r.Y)(a[2],null);const m=(0,r.S)((0,r.Y)(a[3],!0));if(null===f&&(f=["*"]),!1===(0,r.E)(f))throw new r.a(n,r.r.InvalidParameter,t);if(null===a[0])return null;if(!(0,r.U)(a[0]))throw new r.a(n,r.r.InvalidParameter,t);let y=l._layer;if(y instanceof u.eQ&&(y=(0,s.T)(y,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===y||!1===(0,r.K)(y))return null;y=await y.load();const p=y.relationshipMetaData().filter((e=>e.name===o));if(0===p.length)return null;if(void 0!==p[0].relationshipTableId&&null!==p[0].relationshipTableId&&p[0].relationshipTableId>-1)return(0,s.E)(y,p[0],l.field(y.objectIdField),y.spatialReference,f,m,n.lrucache,n.interceptor);let w=y.serviceUrl();if(!w)return null;w="/"===w.charAt(w.length-1)?w+p[0].relatedTableId.toString():w+"/"+p[0].relatedTableId.toString();const h=await(0,s.N)(w,y.spatialReference,f,m,n.lrucache,n.interceptor);await h.load();let I=h.relationshipMetaData();if(I=I.filter((e=>e.id===p[0].id)),!1===l.hasField(p[0].keyField)||null===l.field(p[0].keyField)){const e=await y.getFeatureByObjectId(l.field(y.objectIdField),[p[0].keyField]);if(e){const n=c.Z.create(I[0].keyField+"= @id",{fieldsIndex:h.getFieldsIndex(),timeZone:h.dateFieldsTimeZoneDefaultUTC});return n.parameters={id:e.attributes[p[0].keyField]},h.filter(n)}return new d.u({parentfeatureset:h})}const g=c.Z.create(I[0].keyField+"= @id",{fieldsIndex:h.getFieldsIndex(),timeZone:h.dateFieldsTimeZoneDefaultUTC});return g.parameters={id:l.field(p[0].keyField)},h.filter(g)}))},e.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),e.functions.featuresetbyassociation=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{(0,r.i)(a,2,3,n,t);const l=a[0],o=(0,r.d)((0,r.Y)(a[1],"")).toLowerCase(),d=(0,r.P)(a[2])?(0,r.d)(a[2]):null;if(null===a[0])return null;if(!(0,r.U)(a[0]))throw new r.a(n,r.r.InvalidParameter,t);let m=l._layer;if(m instanceof u.eQ&&(m=(0,s.T)(m,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===m||!1===(0,r.K)(m))return null;await m.load();const y=m.serviceUrl(),p=await(0,s.O)(y,n.spatialReference);let w=null,h=null,I=!1;if(null!==d&&""!==d&&void 0!==d){for(const e of p.terminals)e.terminalName===d&&(h=e.terminalId);null===h&&(I=!0)}const g=p.associations.getFieldsIndex(),F=g.get("TOGLOBALID").name,D=g.get("FROMGLOBALID").name,T=g.get("TOTERMINALID").name,E=g.get("FROMTERMINALID").name,b=g.get("FROMNETWORKSOURCEID").name,x=g.get("TONETWORKSOURCEID").name,N=g.get("ASSOCIATIONTYPE").name,Z=g.get("ISCONTENTVISIBLE").name,L=g.get("OBJECTID").name;for(const n of m.fields)if("global-id"===n.type){w=l.field(n.name);break}let A=null,S=new s.L(new u.bl({name:"percentalong",alias:"percentalong",type:"double"}),c.Z.create("0",{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC})),C=new s.L(new u.bl({name:"side",alias:"side",type:"string"}),c.Z.create("''",{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC}));const v="globalid",P="globalId",$={};for(const n in p.lkp)$[n]=p.lkp[n].sourceId;const R=new s.B(new u.bl({name:"classname",alias:"classname",type:"string"}),null,$);let k="";switch(o){case"midspan":{k=`((${F}='${w}') OR ( ${D}='${w}')) AND (${N} IN (5))`,R.codefield=c.Z.create(`CASE WHEN (${F}='${w}') THEN ${b} ELSE ${x} END`,{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC});const e=(0,f.y)(s.R.findField(p.associations.fields,D));e.name=v,e.alias=v,A=new s.L(e,c.Z.create(`CASE WHEN (${D}='${w}') THEN ${F} ELSE ${D} END`,{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC})),S=p.unVersion>=4?new s.k(s.R.findField(p.associations.fields,g.get("PERCENTALONG").name)):new s.L(new u.bl({name:"percentalong",alias:"percentalong",type:"double"}),c.Z.create("0",{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC}));break}case"junctionedge":{k=`((${F}='${w}') OR ( ${D}='${w}')) AND (${N} IN (4,6))`,R.codefield=c.Z.create(`CASE WHEN (${F}='${w}') THEN ${b} ELSE ${x} END`,{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC});const e=(0,f.y)(s.R.findField(p.associations.fields,D));e.name=v,e.alias=v,A=new s.L(e,c.Z.create(`CASE WHEN (${D}='${w}') THEN ${F} ELSE ${D} END`,{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC})),C=new s.L(new u.bl({name:"side",alias:"side",type:"string"}),c.Z.create(`CASE WHEN (${N}=4) THEN 'from' ELSE 'to' END`,{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC}));break}case"connected":{let e=`${F}='@T'`,n=`${D}='@T'`;null!==h&&(e+=` AND ${T}=@A`,n+=` AND ${E}=@A`),k="(("+e+") OR ("+n+"))",k=(0,r.l)(k,"@T",w??""),e=(0,r.l)(e,"@T",w??""),null!==h&&(e=(0,r.l)(e,"@A",h.toString()),k=(0,r.l)(k,"@A",h.toString())),R.codefield=c.Z.create("CASE WHEN "+e+` THEN ${b} ELSE ${x} END`,{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC});const t=(0,f.y)(s.R.findField(p.associations.fields,D));t.name=v,t.alias=v,A=new s.L(t,c.Z.create("CASE WHEN "+e+` THEN ${D} ELSE ${F} END`,{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC}));break}case"container":k=`${F}='${w}' AND ${N} = 2`,null!==h&&(k+=` AND ${T} = `+h.toString()),R.codefield=b,k="( "+k+" )",A=new s.d(s.R.findField(p.associations.fields,D),v,v);break;case"content":k=`(${D}='${w}' AND ${N} = 2)`,null!==h&&(k+=` AND ${E} = `+h.toString()),R.codefield=x,k="( "+k+" )",A=new s.d(s.R.findField(p.associations.fields,F),v,v);break;case"structure":k=`(${F}='${w}' AND ${N} = 3)`,null!==h&&(k+=` AND ${T} = `+h.toString()),R.codefield=b,k="( "+k+" )",A=new s.d(s.R.findField(p.associations.fields,D),v,P);break;case"attached":k=`(${D}='${w}' AND ${N} = 3)`,null!==h&&(k+=` AND ${E} = `+h.toString()),R.codefield=x,k="( "+k+" )",A=new s.d(s.R.findField(p.associations.fields,F),v,P);break;default:throw new r.a(n,r.r.InvalidParameter,t)}return I&&(k="1 <> 1"),new s.R({parentfeatureset:p.associations,adaptedFields:[new s.k(s.R.findField(p.associations.fields,L)),new s.k(s.R.findField(p.associations.fields,Z)),A,C,R,S],extraFilter:k?c.Z.create(k,{fieldsIndex:p.associations.getFieldsIndex(),timeZone:p.associations.dateFieldsTimeZoneDefaultUTC}):null})}))},e.signatures.push({name:"featuresetbyassociation",min:2,max:6}),e.functions.groupby=function(n,t){return e.standardFunctionAsync(n,t,(async(i,s,l)=>{if((0,r.i)(l,3,3,n,t),!(0,r.K)(l[0]))throw new r.a(n,r.r.InvalidParameter,t);const o=await l[0].load(),f=[],u=[];let m=!1,p=[];if((0,r.P)(l[1]))p.push(l[1]);else if(l[1]instanceof a.N)p.push(l[1]);else if((0,r.E)(l[1]))p=l[1];else{if(!(0,r.X)(l[1]))throw new r.a(n,r.r.InvalidParameter,t);p=l[1].toArray()}for(const e of p)if((0,r.P)(e)){const n=c.Z.create((0,r.d)(e),{fieldsIndex:o.getFieldsIndex(),timeZone:o.dateFieldsTimeZoneDefaultUTC}),t=!0===(0,d.O)(n)?(0,r.d)(e):"%%%%FIELDNAME";f.push({name:t,expression:n}),"%%%%FIELDNAME"===t&&(m=!0)}else{if(!(e instanceof a.N))throw new r.a(n,r.r.InvalidParameter,t);{const i=e.hasField("name")?e.field("name"):"%%%%FIELDNAME",a=e.hasField("expression")?e.field("expression"):"";if("%%%%FIELDNAME"===i&&(m=!0),!i)throw new r.a(n,r.r.InvalidParameter,t);f.push({name:i,expression:c.Z.create(a||i,{fieldsIndex:o.getFieldsIndex(),timeZone:o.dateFieldsTimeZoneDefaultUTC})})}}if(p=[],(0,r.P)(l[2]))p.push(l[2]);else if((0,r.E)(l[2]))p=l[2];else if((0,r.X)(l[2]))p=l[2].toArray();else{if(!(l[2]instanceof a.N))throw new r.a(n,r.r.InvalidParameter,t);p.push(l[2])}for(const e of p){if(!(e instanceof a.N))throw new r.a(n,r.r.InvalidParameter,t);{const i=e.hasField("name")?e.field("name"):"",a=e.hasField("statistic")?e.field("statistic"):"",s=e.hasField("expression")?e.field("expression"):"";if(!i||!a||!s)throw new r.a(n,r.r.InvalidParameter,t);u.push({name:i,statistic:a.toLowerCase(),expression:c.Z.create(s,{fieldsIndex:o.getFieldsIndex(),timeZone:o.dateFieldsTimeZoneDefaultUTC})})}}if(m){const e={};for(const t of o.fields)e[t.name.toLowerCase()]=1;for(const t of f)"%%%%FIELDNAME"!==t.name&&(e[t.name.toLowerCase()]=1);for(const t of u)"%%%%FIELDNAME"!==t.name&&(e[t.name.toLowerCase()]=1);let n=0;for(const t of f)if("%%%%FIELDNAME"===t.name){for(;1===e["field_"+n.toString()];)n++;e["field_"+n.toString()]=1,t.name="FIELD_"+n.toString()}}for(const t of f)await y(t.expression,e,n);for(const t of u)await y(t.expression,e,n);return l[0].groupby(f,u)}))},e.signatures.push({name:"groupby",min:3,max:3}),e.functions.distinct=function(n,t){return e.standardFunctionAsync(n,t,(async(i,s,l)=>{if((0,r.K)(l[0])){(0,r.i)(l,2,2,n,t);const i=await l[0].load(),s=[];let o=[];if((0,r.P)(l[1]))o.push(l[1]);else if(l[1]instanceof a.N)o.push(l[1]);else if((0,r.E)(l[1]))o=l[1];else{if(!(0,r.X)(l[1]))throw new r.a(n,r.r.InvalidParameter,t);o=l[1].toArray()}let f=!1;for(const e of o)if((0,r.P)(e)){const n=c.Z.create((0,r.d)(e),{fieldsIndex:i.getFieldsIndex(),timeZone:i.dateFieldsTimeZoneDefaultUTC}),t=!0===(0,d.O)(n)?(0,r.d)(e):"%%%%FIELDNAME";s.push({name:t,expression:n}),"%%%%FIELDNAME"===t&&(f=!0)}else{if(!(e instanceof a.N))throw new r.a(n,r.r.InvalidParameter,t);{const a=e.hasField("name")?e.field("name"):"%%%%FIELDNAME",l=e.hasField("expression")?e.field("expression"):"";if("%%%%FIELDNAME"===a&&(f=!0),!a)throw new r.a(n,r.r.InvalidParameter,t);s.push({name:a,expression:c.Z.create(l||a,{fieldsIndex:i.getFieldsIndex(),timeZone:i.dateFieldsTimeZoneDefaultUTC})})}}if(f){const e={};for(const t of i.fields)e[t.name.toLowerCase()]=1;for(const t of s)"%%%%FIELDNAME"!==t.name&&(e[t.name.toLowerCase()]=1);let n=0;for(const t of s)if("%%%%FIELDNAME"===t.name){for(;1===e["field_"+n.toString()];)n++;e["field_"+n.toString()]=1,t.name="FIELD_"+n.toString()}}for(const t of s)await y(t.expression,e,n);return l[0].groupby(s,[])}return m(l)}))},e.functions.getfeaturesetinfo=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,s)=>{if((0,r.i)(s,1,1,n,t),!(0,r.K)(s[0]))return null;const l=await s[0].getFeatureSetInfo();return l?a.N.convertObjectToArcadeDictionary({layerId:l.layerId,layerName:l.layerName,itemId:l.itemId,serviceLayerUrl:l.serviceLayerUrl,webMapLayerId:l.webMapLayerId??null,webMapLayerTitle:l.webMapLayerTitle??null,className:null,objectClassId:null},(0,r.B)(n),!1,!1):null}))},e.signatures.push({name:"getfeaturesetinfo",min:1,max:1}),e.functions.filterbysubtypecode=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{if((0,r.i)(a,2,2,n,t),(0,r.K)(a[0])){const e=await a[0].load(),i=a[1];if(!(0,r.V)(i))throw new r.a(n,r.r.InvalidParameter,t);if(e.subtypeField){const n=c.Z.create(`${e.subtypeField}= ${a[1]}`,{fieldsIndex:e.getFieldsIndex(),timeZone:e.dateFieldsTimeZoneDefaultUTC});return new s.c({parentfeatureset:a[0],whereclause:n})}if(null===e.typeIdField||""===e.typeIdField)throw new r.a(n,r.r.FeatureSetDoesNotHaveSubtypes,t);const l=c.Z.create(`${e.typeIdField}= ${a[1]}`,{fieldsIndex:e.getFieldsIndex(),timeZone:e.dateFieldsTimeZoneDefaultUTC});return new s.c({parentfeatureset:a[0],whereclause:l})}throw new r.a(n,r.r.InvalidParameter,t)}))},e.signatures.push({name:"filterbysubtypecode",min:2,max:2}))}},30373:function(e,n,t){t.d(n,{l:function(){return a}});var i=t(44444);function a(e,n){return null===e?n:new i.e({url:e.field("url")})}}}]);
//# sourceMappingURL=1708.4c3a0f17.js.map