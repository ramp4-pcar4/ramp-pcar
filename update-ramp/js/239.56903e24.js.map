{"version":3,"file":"js/239.56903e24.js","mappings":"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","sources":["webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/featureLayerUtils-0tw9isWJ.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/jsonContext-v1mRP0aL.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/multiOriginJSONSupportUtils-DGETddQl.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/originUtils-BLsWtgV9.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/saveUtils-BQy3eBhU.js","webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/utils-2iHN6TbU.js"],"sourcesContent":["import{L as S,c as w,h as N,d as O,l as R,a as d,i as x,u as f,f as c}from\"./main-DCIX61zy.js\";import{P as D,$ as J}from\"./utils-2iHN6TbU.js\";import{t as M,a as Y,i as _}from\"./fetchService-DhIYtzwD.js\";const m=\"Feature Service\",p=\"feature-layer-utils\",$=`${p}-save`,g=`${p}-save-as`;function I(e){return{isValid:S(e)&&(!(\"dynamicDataSource\"in e)||!e.dynamicDataSource),errorMessage:\"Feature layer should be a layer or table in a map or feature service\"}}function E(e){const a=[],r=[];for(const{layer:t,layerJSON:o}of e)t.isTable?r.push(o):a.push(o);return{layers:a,tables:r}}function T(e){return E([e])}async function F(e,a){return/\\/\\d+\\/?$/.test(e.url)?T(a[0]):G(a,e)}async function G(e,a){if(e.reverse(),!a)return E(e);const r=await K(a,e);for(const t of e)v(t.layer,t.layerJSON,r);return U(r,e),r}async function K(e,a){let r=await e.fetchData(\"json\");if(j(r))return r;r||={},B(r);const{layer:{url:t,customParameters:o,apiKey:n}}=a[0];return await V(r,{url:t??\"\",customParameters:o,apiKey:n},a.map(s=>s.layer.layerId)),r}function j(e){return!!(e&&Array.isArray(e.layers)&&Array.isArray(e.tables))}function B(e){e.layers||=[],e.tables||=[]}function U(e,a){const r=[],t=[];for(const{layer:o}of a){const{isTable:n,layerId:s}=o;n?t.push(s):r.push(s)}h(e.layers,r),h(e.tables,t)}function h(e,a){if(e.length<2)return;const r=[];for(const{id:t}of e)r.push(t);w(r.sort(A),a.slice().sort(A))&&e.sort((t,o)=>{const n=a.indexOf(t.id),s=a.indexOf(o.id);return n<s?-1:n>s?1:0})}function A(e,a){return e<a?-1:e>a?1:0}async function V(e,a,r){const{url:t,customParameters:o,apiKey:n}=a,{serviceJSON:s,layersJSON:i}=await M(t,{customParameters:o,apiKey:n}),l=b(e.layers,s.layers,r),u=b(e.tables,s.tables,r);e.layers=l.itemResources,e.tables=u.itemResources;const y=[...l.added,...u.added],P=i?[...i.layers,...i.tables]:[];await k(e,y,t,P)}function b(e,a,r){const t=N(e,a,(n,s)=>n.id===s.id);e=e.filter(n=>!t.removed.some(s=>s.id===n.id));const o=t.added;return o.forEach(({id:n})=>{e.push({id:n})}),{itemResources:e,added:o.filter(({id:n})=>!r.includes(n))}}async function k(e,a,r,t){const o=await q(a),n=a.map(({id:s,type:i})=>new(o.get(i))({url:r,layerId:s,sourceJSON:t.find(({id:l})=>l===s)}));await Promise.allSettled(n.map(s=>s.load())),n.forEach(s=>{const{layerId:i,loaded:l,defaultPopupTemplate:u}=s;if(!l||u==null)return;const y={id:i,popupInfo:u.toJSON()};s.operationalLayerType!==\"ArcGISFeatureLayer\"&&(y.layerType=s.operationalLayerType),v(s,y,e)})}async function q(e){const a=[];e.forEach(({type:o})=>{const n=_(o),s=Y[n];a.push(s())});const r=await Promise.all(a),t=new Map;return e.forEach(({type:o},n)=>{t.set(o,r[n])}),t}function v(e,a,r){e.isTable?L(r.tables,a):L(r.layers,a)}function L(e,a){const r=e.findIndex(({id:t})=>t===a.id);r===-1?e.push(a):e[r]=a}function z(e,a){const r=e.layers.some(t=>t.layerType===\"OrientedImageryLayer\");f(a,c.ORIENTED_IMAGERY_LAYER,r)}function C(e,a){const r=e.some(t=>t.type===\"oriented-imagery\");f(a,c.ORIENTED_IMAGERY_LAYER,r)}async function X(e,a,r){z(r,a)}async function Z(e,a){const{url:r,layerId:t,title:o,fullExtent:n,isTable:s}=e,i=O(r);a.url=(i?.serverType===\"FeatureServer\"?r:`${r}/${t}`)??null,a.title||=o,a.extent=null,s||n==null||(a.extent=await R(n)),d(a,c.METADATA),d(a,c.MULTI_LAYER),x(a,c.SINGLE_LAYER),f(a,c.TABLE,s),C([e],a)}async function H(e,a){return D({layer:e,itemType:m,validateLayer:I,createItemData:(r,t)=>F(t,[r]),errorNamePrefix:$,setItemProperties:X},a)}async function Q(e,a,r){return J({layer:e,itemType:m,validateLayer:I,createItemData:(t,o)=>Promise.resolve(T(t)),errorNamePrefix:g,newItem:a,setItemProperties:Z},r)}export{H as save,Q as saveAs};\n","import{I as o,e as s}from\"./main-DCIX61zy.js\";function a(e,r){return{...l(e,r),readResourcePaths:[]}}function i(e,r,n){const t=o(e.itemUrl);return{...l(e,r),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:t?{rootPath:t.path,writtenUrls:[]}:null,resources:n?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function l(e,r){return{origin:r,url:o(e.itemUrl),portal:e.portal||s.getDefault(),portalItem:e}}export{a as e,i as o};\n","function n(i){return i&&\"getAtOrigin\"in i&&\"originOf\"in i}export{n as i};\n","import{i as o}from\"./multiOriginJSONSupportUtils-DGETddQl.js\";function n(t){t?.writtenProperties&&t.writtenProperties.forEach(({target:r,propName:e,newOrigin:i})=>{o(r)&&i&&r.originOf(e)!==i&&r.updateOrigin(e,i)})}export{n as i};\n","import{s as l}from\"./main-DCIX61zy.js\";async function i(t){const s=[];for(const o of t.allLayers)if(\"beforeSave\"in o&&typeof o.beforeSave==\"function\"){const e=o.beforeSave();e&&s.push(e)}await Promise.allSettled(s)}const u=new Set([\"layer:unsupported\",\"property:unsupported\",\"symbol:unsupported\",\"symbol-layer:unsupported\",\"url:unsupported\"]);function d(t,s,o){let e=(t.messages??[]).filter(({type:r})=>r===\"error\").map(({name:r,message:a,details:p})=>new l(r,a,p));if(t.blockedRelativeUrls&&(e=e.concat(t.blockedRelativeUrls.map(r=>new l(\"url:unsupported\",`Relative url '${r}' is not supported`)))),o){const{ignoreUnsupported:r,supplementalUnsupportedErrors:a=[],requiredPropertyChecksDisabled:p}=o;r&&(e=e.filter(({name:n})=>!(u.has(n)||a.includes(n)))),p&&(e=e.filter(n=>n.name!==\"web-document-write:property-required\"))}if(e.length>0)throw new l(s.errorName,\"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:e})}export{i as r,d as t};\n","import{s as c,S as P,e as h,i as x,f as N}from\"./main-DCIX61zy.js\";import{i as u}from\"./originUtils-BLsWtgV9.js\";import{o as S}from\"./jsonContext-v1mRP0aL.js\";import{t as b}from\"./saveUtils-BQy3eBhU.js\";function g(t,a,r){const e=r(t);if(!e.isValid)throw new c(`${a}:invalid-parameters`,e.errorMessage,{layer:t})}async function d(t){const{layer:a,errorNamePrefix:r,validateLayer:e}=t;await a.load(),g(a,r,e)}function y(t,a){return`Layer (title: ${t.title}, id: ${t.id}) of type '${t.declaredClass}' ${a}`}function w(t){const{item:a,errorNamePrefix:r,layer:e,validateItem:i}=t;if(O(t),i){const n=i(a);if(!n.isValid)throw new c(`${r}:invalid-parameters`,n.errorMessage,{layer:e})}}function O(t){const{item:a,itemType:r,additionalItemType:e,errorNamePrefix:i,layer:n}=t,s=[r];if(e&&s.push(e),!s.includes(a.type)){const p=s.map(o=>`'${o}'`).join(\", \");throw new c(`${i}:portal-item-wrong-type`,`Portal item type should be one of: \"${p}\"`,{item:a,layer:n})}}function J(t){const{layer:a,errorNamePrefix:r}=t,{portalItem:e}=a;if(!e)throw new c(`${r}:portal-item-not-set`,y(a,\"requires the portalItem property to be set\"));if(!e.loaded)throw new c(`${r}:portal-item-not-loaded`,y(a,\"cannot be saved to a portal item that does not exist or is inaccessible\"));w({...t,item:e})}function E(t){const{newItem:a,itemType:r}=t;let e=P.from(a);return e.id&&(e=e.clone(),e.id=null),e.type??=r,e.portal??=h.getDefault(),w({...t,item:e}),e}function I(t){return S(t,\"portal-item\")}async function $(t,a,r){\"beforeSave\"in t&&typeof t.beforeSave==\"function\"&&await t.beforeSave();const e=t.write({},a);return await Promise.all(a.resources?.pendingOperations??[]),b(a,{errorName:\"layer-write:unsupported\"},r),e}function v(t){x(t,N.JSAPI),t.typeKeywords&&(t.typeKeywords=t.typeKeywords.filter((a,r,e)=>e.indexOf(a)===r))}async function U(t,a,r){const e=t.portal;await e.signIn(),await e.user.addItem({item:t,data:a,folder:r?.folder})}async function C(t,a){const{layer:r,createItemData:e,createJSONContext:i,setItemProperties:n,saveResources:s,supplementalUnsupportedErrors:p}=t;await d(t),J(t);const o=r.portalItem,l=i?i(o):I(o),f=await $(r,l,{...a,supplementalUnsupportedErrors:p}),m=await e({layer:r,layerJSON:f},o);return await n?.(r,o,m),v(o),await o.update({data:m}),u(l),await s?.(o,l),o}async function D(t,a){const{layer:r,createItemData:e,createJSONContext:i,setItemProperties:n,saveResources:s,supplementalUnsupportedErrors:p}=t;await d(t);const o=E(t),l=i?i(o):I(o),f=await $(r,l,{...a,supplementalUnsupportedErrors:p}),m=await e({layer:r,layerJSON:f},o);return await n(r,o,m),v(o),await U(o,m,a),r.portalItem=o,u(l),await s?.(o,l),o}export{D as $,C as P};\n"],"names":["m","p","$","g","I","e","isValid","dynamicDataSource","errorMessage","E","a","r","layer","t","layerJSON","o","isTable","push","layers","tables","T","async","F","test","url","G","reverse","K","v","U","fetchData","j","B","customParameters","apiKey","n","V","map","s","layerId","Array","isArray","h","length","id","sort","A","slice","indexOf","serviceJSON","layersJSON","i","l","b","u","itemResources","y","added","P","k","filter","removed","some","forEach","includes","q","type","get","sourceJSON","find","Promise","allSettled","load","loaded","defaultPopupTemplate","popupInfo","toJSON","operationalLayerType","layerType","all","Map","set","L","findIndex","z","ORIENTED_IMAGERY_LAYER","C","X","Z","title","fullExtent","serverType","extent","METADATA","MULTI_LAYER","SINGLE_LAYER","TABLE","H","itemType","validateLayer","createItemData","errorNamePrefix","setItemProperties","Q","resolve","newItem","readResourcePaths","itemUrl","messages","writtenProperties","blockedRelativeUrls","verifyItemRelativeUrls","rootPath","path","writtenUrls","resources","toAdd","toUpdate","toKeep","pendingOperations","origin","portal","getDefault","portalItem","target","propName","newOrigin","originOf","updateOrigin","allLayers","beforeSave","Set","d","name","message","details","concat","ignoreUnsupported","supplementalUnsupportedErrors","requiredPropertyChecksDisabled","has","errorName","errors","declaredClass","w","item","validateItem","O","additionalItemType","join","J","from","clone","write","JSAPI","typeKeywords","signIn","user","addItem","data","folder","createJSONContext","saveResources","f","update","D"],"sourceRoot":""}