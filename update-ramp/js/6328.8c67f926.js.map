{"version":3,"file":"js/6328.8c67f926.js","mappings":"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","sources":["webpack://ramp-website/./node_modules/ramp-pcar/dist/esDynamic/createConnection-DV-PsVt_.js"],"sourcesContent":["import{d4 as N,s as a,bt as d,bu as y,bv as p,io as S,cC as b,G as c,ft as L,X as k,U as O,f1 as x,fv as E,aY as M,kQ as v}from\"./main-DCIX61zy.js\";let w=class extends N.EventedAccessor{destroy(){this.emit(\"destroy\")}get connectionError(){return this.errorString?new a(\"stream-connection\",this.errorString):null}onFeature(e){this.emit(\"data-received\",e)}onMessage(e){this.emit(\"message-received\",e)}};d([y({readOnly:!0})],w.prototype,\"connectionError\",null),w=d([p(\"esri.layers.support.StreamConnection\")],w);const F=w;var g;(function(e){e[e.CONNECTING=0]=\"CONNECTING\",e[e.OPEN=1]=\"OPEN\",e[e.CLOSING=2]=\"CLOSING\",e[e.CLOSED=3]=\"CLOSED\"})(g||(g={}));let f=class extends F{constructor(e){super({}),this._outstandingMessages=[],this.errorString=null;const{geometryType:t,spatialReference:r,sourceSpatialReference:s}=e;this._config=e,this._featureZScaler=S(t,s,r),this._open()}normalizeCtorArgs(){return{}}async _open(){await this._tryCreateWebSocket(),this.destroyed||await this._handshake()}destroy(){super.destroy(),this._websocket!=null&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close()),this._websocket=null}get connectionStatus(){if(this._websocket==null)return\"disconnected\";switch(this._websocket.readyState){case g.CONNECTING:case g.OPEN:return\"connected\";case g.CLOSING:case g.CLOSED:return\"disconnected\"}}sendMessageToSocket(e){this._websocket!=null?this._websocket.send(JSON.stringify(e)):this._outstandingMessages.push(e)}sendMessageToClient(e){this._onMessage(e)}updateCustomParameters(e){this._config.customParameters=e,this._websocket!=null&&this._websocket.close()}async _tryCreateWebSocket(e=this._config.source.path,t=1e3,r=0){try{if(this.destroyed)return;const s=b(e,this._config.customParameters??{});this._websocket=await this._createWebSocket(s),this.notifyChange(\"connectionStatus\")}catch(s){const o=t/1e3;return this._config.maxReconnectionAttempts&&r>=this._config.maxReconnectionAttempts?(c.getLogger(this).error(new a(\"websocket-connection\",\"Exceeded maxReconnectionAttempts attempts. No further attempts will be made\")),void this.destroy()):(c.getLogger(this).error(new a(\"websocket-connection\",`Failed to connect. Attempting to reconnect in ${o}s`,s)),await L(t),this._tryCreateWebSocket(e,Math.min(1.5*t,1e3*this._config.maxReconnectionInterval),r+1))}}_setWebSocketJSONParseHandler(e){e.onmessage=t=>{try{const r=JSON.parse(t.data);this._onMessage(r)}catch(r){return void c.getLogger(this).error(new a(\"websocket-connection\",\"Failed to parse message, invalid JSON\",{error:r}))}}}_createWebSocket(e){return new Promise((t,r)=>{const s=new WebSocket(e);s.onopen=()=>{if(s.onopen=null,this.destroyed)return s.onclose=null,void s.close();s.onclose=o=>this._onClose(o),s.onerror=o=>this._onError(o),this._setWebSocketJSONParseHandler(s),t(s)},s.onclose=o=>{s.onopen=s.onclose=null,r(o)}})}async _handshake(e=1e4){const t=this._websocket;if(t==null)return;const r=k(),s=t.onmessage,{filter:o,outFields:n,spatialReference:u}=this._config;return r.timeout(e),t.onmessage=h=>{let l=null;try{l=JSON.parse(h.data)}catch{}l&&typeof l==\"object\"||(c.getLogger(this).error(new a(\"websocket-connection\",\"Protocol violation. Handshake failed - malformed message\",h.data)),r.reject(),this.destroy()),l.spatialReference?.wkid!==u?.wkid&&(c.getLogger(this).error(new a(\"websocket-connection\",`Protocol violation. Handshake failed - expected wkid of ${u.wkid}`,h.data)),r.reject(),this.destroy()),l.format!==\"json\"&&(c.getLogger(this).error(new a(\"websocket-connection\",\"Protocol violation. Handshake failed - format is not set\",h.data)),r.reject(),this.destroy()),o&&l.filter!==o&&c.getLogger(this).error(new a(\"websocket-connection\",\"Tried to set filter, but server doesn't support it\")),n&&l.outFields!==n&&c.getLogger(this).error(new a(\"websocket-connection\",\"Tried to set outFields, but server doesn't support it\")),t.onmessage=s;for(const i of this._outstandingMessages)t.send(JSON.stringify(i));this._outstandingMessages=[],r.resolve()},t.send(JSON.stringify({filter:o,outFields:n,format:\"json\",spatialReference:{wkid:u.wkid}})),r.promise}_onMessage(e){if(this.onMessage(e),\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const t of e.features)this._featureZScaler!=null&&this._featureZScaler(t.geometry),this.onFeature(t)}}_onError(e){const t=\"Encountered an error over WebSocket connection\";this._set(\"errorString\",t),c.getLogger(this).error(\"websocket-connection\",t)}_onClose(e){this._websocket=null,this.notifyChange(\"connectionStatus\"),e.code!==1e3&&c.getLogger(this).error(\"websocket-connection\",`WebSocket closed unexpectedly with error code ${e.code}`),this.destroyed||this._open()}};d([y()],f.prototype,\"connectionStatus\",null),d([y()],f.prototype,\"errorString\",void 0),f=d([p(\"esri.layers.graphics.sources.connections.WebSocketConnection\")],f);const P=1e4,W={maxQueryDepth:5,maxRecordCountFactor:3};let m=class extends f{constructor(e){super({...W,...e}),this._buddyServicesQuery=null,this._relatedFeatures=null}async _open(){const e=await this._fetchServiceDefinition(this._config.source);e.timeInfo.trackIdField||c.getLogger(this).warn(\"GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.\");const t=this._fetchWebSocketUrl(e.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),await this._buddyServicesQuery,await this._tryCreateWebSocket(t);const{filter:r,outFields:s}=this._config;this.destroyed||this._setFilter(r,s)}_onMessage(e){if(\"attributes\"in e){let t;try{t=this._enrich(e),this._featureZScaler!=null&&this._featureZScaler(t.geometry)}catch(r){return void c.getLogger(this).error(new a(\"geoevent-connection\",\"Failed to parse message\",r))}this.onFeature(t)}else this.onMessage(e)}async _fetchServiceDefinition(e){const t={f:\"json\",...this._config.customParameters},r=O(e.path,{query:t,responseType:\"json\"}),s=(await r).data;return this._serviceDefinition=s,s}_fetchWebSocketUrl(e,t){const r=e[0],{urls:s,token:o}=r,n=this._inferWebSocketBaseUrl(s);return b(`${n}/subscribe`,{outSR:\"\"+t.wkid,token:o})}_inferWebSocketBaseUrl(e){if(e.length===1)return e[0];for(const t of e)if(t.includes(\"wss\"))return t;return c.getLogger(this).error(new a(\"geoevent-connection\",\"Unable to infer WebSocket url\",e)),null}async _setFilter(e,t){const r=this._websocket;if(r==null||e==null&&t==null)return;const s=JSON.stringify({filter:this._serializeFilter(e,t)});let o=!1;const n=k(),u=()=>{o||(this.destroyed||this._websocket!==r||c.getLogger(this).error(new a(\"geoevent-connection\",\"Server timed out when setting filter\")),n.reject())},h=l=>{const i=JSON.parse(l.data);i.filter&&(i.error&&(c.getLogger(this).error(new a(\"geoevent-connection\",\"Failed to set service filter\",i.error)),this._set(\"errorString\",`Could not set service filter - ${i.error}`),n.reject(i.error)),this._setWebSocketJSONParseHandler(r),o=!0,n.resolve())};return r.onmessage=h,r.send(s),setTimeout(u,P),n.promise}_serializeFilter(e,t){const r={};if(e==null&&t==null)return r;if(e?.geometry)try{const s=x(e.geometry);if(s.type!==\"extent\")throw new a(`Expected extent but found type ${s.type}`);r.geometry=JSON.stringify(s.shiftCentralMeridian())}catch(s){c.getLogger(this).error(new a(\"geoevent-connection\",\"Encountered an error when setting connection geometryDefinition\",s))}return e?.where&&e.where!==\"1 = 1\"&&e.where!==\"1=1\"&&(r.where=e.where),t!=null&&(r.outFields=t.join(\",\")),r}_enrich(e){if(!this._relatedFeatures)return e;const t=this._serviceDefinition.relatedFeatures.joinField,r=e.attributes[t],s=this._relatedFeatures.get(r);if(!s)return c.getLogger(this).warn(\"geoevent-connection\",\"Feature join failed. Is the join field configured correctly?\",e),e;const{attributes:o,geometry:n}=s;for(const u in o)e.attributes[u]=o[u];return n&&(e.geometry=n),e.geometry||e.centroid||c.getLogger(this).error(new a(\"geoevent-connection\",\"Found malformed feature - no geometry found\",e)),e}async _queryBuddyServices(){try{const{relatedFeatures:e,keepLatestArchive:t}=this._serviceDefinition,r=this._queryRelatedFeatures(e),s=this._queryArchive(t);await r;const o=await s;if(!o)return;for(const n of o.features)this.onFeature(this._enrich(n))}catch(e){c.getLogger(this).error(new a(\"geoevent-connection\",\"Encountered an error when querying buddy services\",{error:e}))}}async _queryRelatedFeatures(e){if(!e)return;const t=await this._queryBuddy(e.featuresUrl);this._addRelatedFeatures(t)}async _queryArchive(e){if(e)return this._queryBuddy(e.featuresUrl)}async _queryBuddy(e){const t=new(await import(\"./main-DCIX61zy.js\").then(R=>R.vF)).default({url:e}),{capabilities:r}=await t.load(),s=r.query.supportsMaxRecordCountFactor,o=r.query.supportsPagination,n=r.query.supportsCentroid,u=this._config.maxRecordCountFactor,h=t.capabilities.query.maxRecordCount,l=s?h*u:h,i=new E;if(i.outFields=this._config.outFields??[\"*\"],i.where=this._config.filter?.where??\"1=1\",i.returnGeometry=!0,i.returnExceededLimitFeatures=!0,i.outSpatialReference=M.fromJSON(this._config.spatialReference),n&&(i.returnCentroid=!0),s&&(i.maxRecordCountFactor=u),o)return i.num=l,t.destroy(),this._queryPages(e,i);const C=await v(e,i,this._config.sourceSpatialReference);return t.destroy(),C.data}async _queryPages(e,t,r=[],s=0){t.start=t.num!=null?s*t.num:null;const{data:o}=await v(e,t,this._config.sourceSpatialReference);return o.exceededTransferLimit&&s<(this._config.maxQueryDepth??0)?(o.features.forEach(n=>r.push(n)),this._queryPages(e,t,r,s+1)):(r.forEach(n=>o.features.push(n)),o)}_addRelatedFeatures(e){const t=new Map,r=e.features,s=this._serviceDefinition.relatedFeatures.joinField;for(const o of r){const n=o.attributes[s];t.set(n,o)}this._relatedFeatures=t}};m=d([p(\"esri.layers.graphics.sources.connections.GeoEventConnection\")],m);const q=m;let _=class extends F{constructor(e){super({}),this.connectionStatus=\"connected\",this.errorString=null;const{geometryType:t,spatialReference:r,sourceSpatialReference:s}=e;this._featureZScaler=S(t,s,r)}normalizeCtorArgs(){return{}}updateCustomParameters(e){}sendMessageToSocket(e){}sendMessageToClient(e){if(\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const t of e.features)this._featureZScaler!=null&&this._featureZScaler(t.geometry),this.onFeature(t)}this.onMessage(e)}};d([y()],_.prototype,\"connectionStatus\",void 0),d([y()],_.prototype,\"errorString\",void 0),_=d([p(\"esri.layers.support.ClientSideConnection\")],_);function T(e,t){if(e==null&&t==null)return null;const r={};return t!=null&&(r.geometry=t),e!=null&&(r.where=e),r}function j(e,t,r,s,o,n,u,h,l){const i={source:e,sourceSpatialReference:t,spatialReference:r,geometryType:s,filter:T(o,n),maxReconnectionAttempts:u,maxReconnectionInterval:h,customParameters:l};return e?e.path.startsWith(\"wss://\")||e.path.startsWith(\"ws://\")?new f(i):new q(i):new _(i)}export{j as createConnection};\n"],"names":["w","EventedAccessor","destroy","this","emit","connectionError","errorString","onFeature","e","onMessage","readOnly","prototype","F","g","CONNECTING","OPEN","CLOSING","CLOSED","f","constructor","super","_outstandingMessages","geometryType","t","spatialReference","r","sourceSpatialReference","s","_config","_featureZScaler","_open","normalizeCtorArgs","_tryCreateWebSocket","destroyed","_handshake","_websocket","onopen","onclose","onerror","onmessage","close","connectionStatus","readyState","sendMessageToSocket","send","JSON","stringify","push","sendMessageToClient","_onMessage","updateCustomParameters","customParameters","source","path","_createWebSocket","notifyChange","o","maxReconnectionAttempts","getLogger","error","Math","min","maxReconnectionInterval","_setWebSocketJSONParseHandler","parse","data","Promise","WebSocket","_onClose","_onError","filter","outFields","n","u","timeout","h","l","reject","wkid","format","i","resolve","promise","type","features","geometry","_set","code","P","W","maxQueryDepth","maxRecordCountFactor","m","_buddyServicesQuery","_relatedFeatures","_fetchServiceDefinition","timeInfo","trackIdField","warn","_fetchWebSocketUrl","streamUrls","_queryBuddyServices","_setFilter","_enrich","query","responseType","_serviceDefinition","urls","token","_inferWebSocketBaseUrl","outSR","length","includes","_serializeFilter","setTimeout","shiftCentralMeridian","where","join","relatedFeatures","joinField","attributes","get","centroid","keepLatestArchive","_queryRelatedFeatures","_queryArchive","_queryBuddy","featuresUrl","_addRelatedFeatures","then","R","vF","default","url","capabilities","load","supportsMaxRecordCountFactor","supportsPagination","supportsCentroid","maxRecordCount","returnGeometry","returnExceededLimitFeatures","outSpatialReference","fromJSON","returnCentroid","num","_queryPages","C","start","exceededTransferLimit","forEach","Map","set","q","_","T","j","startsWith"],"sourceRoot":""}