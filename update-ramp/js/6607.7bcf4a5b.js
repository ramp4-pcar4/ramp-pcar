"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[6607],{89555:function(t,e,n){n.d(e,{S:function(){return c},f:function(){return o},g:function(){return a},l:function(){return r}});var i=n(44444),s=n(36649);class r{constructor(t,e,n){this.pixelBlock=t,this.extent=e,this.originalPixelBlock=n}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(t){const e=this.pixelBlock;if(null==e)return;const n=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??e});if(null==n.pixelBlock)return;n.pixelBlock.maskIsAlpha&&(n.pixelBlock.premultiplyAlpha=!0);const i=n.pixelBlock.getAsRGBA(),s=t.createImageData(n.pixelBlock.width,n.pixelBlock.height);s.data.set(i),t.putImageData(s,0,0)}getRenderedRasterPixels(){const t=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==t.pixelBlock?null:(t.pixelBlock.maskIsAlpha&&(t.pixelBlock.premultiplyAlpha=!0),{width:t.pixelBlock.width,height:t.pixelBlock.height,renderedRasterPixels:new Uint8Array(t.pixelBlock.getAsRGBA().buffer)})}}function a(t){return t&&"render"in t}function o(t){const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,t.render(e.getContext("2d")),e}function l(t){return a(t)?t instanceof r?t.getRenderedRasterPixels()?.renderedRasterPixels:o(t):t}class c extends s.e{constructor(t=null,e=!1){super(),this.blendFunction="standard",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this._texture=null,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.immutable=e,this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){null==t&&null==this._source||(this._source=t,this.invalidateTexture(),this.requestRender())}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t)}async setSourceAsync(t,e){null!=this._uploadStatus&&this._uploadStatus.controller.abort();const n=new AbortController,s=(0,i.X)();return(0,i.gz)(e,(()=>n.abort())),(0,i.gz)(n,(t=>s.reject(t))),this._uploadStatus={controller:n,resolver:s},this.source=t,s.promise}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}transitionStep(t,e){t>=64&&(this.fadeTransitionEnabled=!1),super.transitionStep(t,e)}setTransform(t){const e=(0,i.gA)(this.transforms.displayViewScreenMat3),[n,s]=t.toScreenNoRotation([0,0],[this.x,this.y]),r=this.resolution/this.pixelRatio/t.resolution,a=r*this.width,o=r*this.height,l=Math.PI*this.rotation/180;(0,i.gB)(e,e,(0,i.gC)(n,s)),(0,i.gB)(e,e,(0,i.gC)(a/2,o/2)),(0,i.gD)(e,e,-l),(0,i.gB)(e,e,(0,i.gC)(-a/2,-o/2)),(0,i.gE)(e,e,(0,i.gC)(a,o)),(0,i.gF)(this.transforms.displayViewScreenMat3,t.displayViewMat3,e)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind(t,e){this._texture&&t.bindTexture(this._texture,e)}async updateTexture({context:t,painter:e}){if(!this._textureInvalidated)return;if(this._textureInvalidated=!1,this._texture||(this._texture=this._createTexture(t)),!this.source)return void this._texture.setData(null);this._texture.resize(this._sourceWidth,this._sourceHeight);const n=l(this.source);try{if(null!=this._uploadStatus){const{controller:t,resolver:i}=this._uploadStatus,s={signal:t.signal},{width:r,height:a}=this,o=this._texture;await e.textureUploadManager.enqueueTextureUpdate({data:n,texture:o,width:r,height:a},s),i.resolve(),this._uploadStatus=null}else this._texture.setData(n);this.ready()}catch(s){(0,i.gG)(s)}}onDetach(){this.destroy()}_createTransforms(){return{displayViewScreenMat3:(0,i.gH)()}}_createTexture(t){const e=this.immutable,n=new i.ct;return n.internalFormat=e?i.cu.RGBA8:i.cA.RGBA,n.wrapMode=i.cx.CLAMP_TO_EDGE,n.isImmutable=e,n.width=this._sourceWidth,n.height=this._sourceHeight,new i.cy(t,n)}}},70222:function(t,e,n){n.d(e,{a:function(){return r}});var i=n(38006),s=n(44444);class r extends i.n{constructor(){super(...arguments),this._hasCrossfade=!1}get requiresDedicatedFBO(){return super.requiresDedicatedFBO||this._hasCrossfade}beforeRender(t){super.beforeRender(t),this._manageFade()}prepareRenderPasses(t){const e=t.registerRenderPass({name:"bitmap",brushes:[i.t.bitmap],target:()=>this.children,drawPhase:s.aK.MAP});return[...super.prepareRenderPasses(t),e]}_manageFade(){this.children.reduce(((t,e)=>t+(e.inFadeTransition?1:0)),0)>=2?(this.children.forEach((t=>t.blendFunction="additive")),this._hasCrossfade=!0):(this.children.forEach((t=>t.blendFunction="standard")),this._hasCrossfade=!1)}}},73978:function(t,e,n){n.r(e),n.d(e,{default:function(){return x}});var i=n(44444),s=n(78890),r=n(89555),a=n(70222),o=n(31609),l=n(54299),c=n(1771),u=n(6255),h=n(38006),f=n(69974),p=n(57177),d=n(34209);class m{constructor(t){if(this._ownsRctx=!1,t)this._ownsRctx=!1,this._rctx=t;else{if(m._instance)return m._instanceRefCount++,m._instance;m._instanceRefCount=1,m._instance=this,this._ownsRctx=!0;const t=document.createElement("canvas").getContext("webgl2");t.getExtension("OES_texture_float"),this._rctx=new f.y(t,{})}const e={applyProjection:!0,bilinear:!1,bicubic:!1},n=(0,f.o)("raster/reproject","raster/reproject",new Map([["a_position",0]]),e);this._program=this._rctx.programCache.acquire(n.shaders.vertexShader,n.shaders.fragmentShader,n.attributes),this._rctx.useProgram(this._program),this._program.setUniform1f("u_opacity",1),this._program.setUniform1i("u_image",0),this._program.setUniform1i("u_flipY",0),this._program.setUniform1i("u_transformGrid",1),this._quad=new h.a(this._rctx,[0,0,1,0,0,1,1,1])}reprojectTexture(t,e,n=!1){const s=(0,i.cl)(t.extent,e),r=new i.D({x:(t.extent.xmax-t.extent.xmin)/t.texture.descriptor.width,y:(t.extent.ymax-t.extent.ymin)/t.texture.descriptor.height,spatialReference:t.extent.spatialReference}),{x:a,y:o}=(0,u.C)(r,e,t.extent);let l=(a+o)/2;const c=Math.round((s.xmax-s.xmin)/l),h=Math.round((s.ymax-s.ymin)/l);l=(s.width/c+s.height/h)/2;const f=new i.D({x:l,y:l,spatialReference:s.spatialReference}),m=(0,u.i)({projectedExtent:s,srcBufferExtent:t.extent,pixelSize:f,hasWrapAround:!0,spacing:[16,16]}),g=(0,d.c)(this._rctx,m),_=new i.ct(c,h);_.wrapMode=i.cx.CLAMP_TO_EDGE;const x=new p.x(this._rctx,_);this._rctx.bindFramebuffer(x),this._rctx.setViewport(0,0,c,h),this._rctx.useProgram(this._program),this._rctx.bindTexture(t.texture,0),this._rctx.bindTexture(g,1),this._quad.bind();const{width:y=0,height:w=0}=t.texture.descriptor;if(this._program.setUniform2f("u_srcImageSize",y,w),this._program.setUniform2fv("u_transformSpacing",m.spacing),this._program.setUniform2fv("u_transformGridSize",m.size),this._program.setUniform2f("u_targetImageSize",c,h),this._quad.draw(),this._quad.unbind(),this._rctx.useProgram(null),this._rctx.bindFramebuffer(null),g.dispose(),n){const{width:t,height:e}=x,n=new ImageData(t??0,e??0);x.readPixels(0,0,t??0,e??0,i.cA.RGBA,i.cv.UNSIGNED_BYTE,n.data);const r=x.detachColorTexture(i.gN.COLOR_ATTACHMENT0);return x.dispose(),{texture:r,extent:s,imageData:n}}const b=x.detachColorTexture(i.gN.COLOR_ATTACHMENT0);return x.dispose(),{texture:b,extent:s}}reprojectBitmapData(t,e){const n=(0,r.g)(t.bitmapData)?(0,r.f)(t.bitmapData):t.bitmapData,s=new i.ct;s.wrapMode=i.cx.CLAMP_TO_EDGE,s.width=t.bitmapData.width,s.height=t.bitmapData.height;const a=new i.cy(this._rctx,s,n),o=this.reprojectTexture({texture:a,extent:t.extent},e,!0);o.texture.dispose();const l=document.createElement("canvas"),c=o.imageData;return l.width=c.width,l.height=c.height,l.getContext("2d").putImageData(c,0,0),{bitmapData:l,extent:o.extent}}async loadAndReprojectBitmapData(t,e,n){const s=(await(0,i.U)(t,{responseType:"image"})).data,r=document.createElement("canvas");r.width=s.width,r.height=s.height;const a=r.getContext("2d");a.drawImage(s,0,0);const o=a.getImageData(0,0,r.width,r.height);if(e.spatialReference.equals(n))return{bitmapData:o,extent:e};const l=this.reprojectBitmapData({bitmapData:o,extent:e},n);return{bitmapData:l.bitmapData,extent:l.extent}}destroy(){this._ownsRctx?(m._instanceRefCount--,0===m._instanceRefCount&&(this._quad.dispose(),this._program.dispose(),this._rctx.dispose(),m._instance=null)):(this._quad.dispose(),this._program.dispose())}}m._instanceRefCount=0;class g{constructor(){this.allSublayers=new Map,this.allPoints=[],this.allPolylines=[],this.allPolygons=[],this.allMapImages=[]}}let _=class extends((0,o.j)(o.y)){constructor(){super(...arguments),this._bitmapIndex=new Map,this._mapImageContainer=new a.a,this._kmlVisualData=new g,this._fetchController=null,this.allVisiblePoints=new i.c2,this.allVisiblePolylines=new i.c2,this.allVisiblePolygons=new i.c2,this.allVisibleMapImages=new i.a8}async hitTest(t,e){const n=this.layer;return[this._pointsView?.hitTest(t),this._polylinesView?.hitTest(t),this._polygonsView?.hitTest(t)].flat().filter(Boolean).map((e=>(e.layer=n,e.sourceLayer=n,{type:"graphic",graphic:e,layer:n,mapPoint:t})))}update(t){this._polygonsView&&this._polygonsView.processUpdate(t),this._polylinesView&&this._polylinesView.processUpdate(t),this._pointsView&&this._pointsView.processUpdate(t)}attach(){this._fetchController=new AbortController,this.container.addChild(this._mapImageContainer),this._polygonsView=new c.F({view:this.view,graphics:this.allVisiblePolygons,requestUpdateCallback:()=>this.requestUpdate(),container:new l.t(this.view.featuresTilingScheme)}),this.container.addChild(this._polygonsView.container),this._polylinesView=new c.F({view:this.view,graphics:this.allVisiblePolylines,requestUpdateCallback:()=>this.requestUpdate(),container:new l.t(this.view.featuresTilingScheme)}),this.container.addChild(this._polylinesView.container),this._pointsView=new c.F({view:this.view,graphics:this.allVisiblePoints,requestUpdateCallback:()=>this.requestUpdate(),container:new l.t(this.view.featuresTilingScheme)}),this.container.addChild(this._pointsView.container),this.addAttachHandles([this.allVisibleMapImages.on("change",(t=>{t.added.forEach((t=>this._addMapImage(t))),t.removed.forEach((t=>this._removeMapImage(t)))})),(0,i.cc)((()=>this.layer.visibleSublayers),(t=>{for(const e of this._kmlVisualData.allSublayers.values())e.visibility=0;for(const e of t){const t=this._kmlVisualData.allSublayers.get(e.id);t&&(t.visibility=1)}this._refreshCollections()}))]),this._updatingHandles.addPromise(this._fetchService(this._fetchController.signal)),this._imageReprojector=new m}detach(){this._fetchController=(0,i.gO)(this._fetchController),this._mapImageContainer.removeAllChildren(),this.container.removeAllChildren(),this._bitmapIndex.clear(),this._polygonsView=(0,i.ch)(this._polygonsView),this._polylinesView=(0,i.ch)(this._polylinesView),this._pointsView=(0,i.ch)(this._pointsView),this._imageReprojector=(0,i.ch)(this._imageReprojector)}viewChange(){this._polygonsView.viewChange(),this._polylinesView.viewChange(),this._pointsView.viewChange()}moveEnd(){}isUpdating(){return this._pointsView.updating||this._polygonsView.updating||this._polylinesView.updating}_addMapImage(t){(this.view.spatialReference?.isWGS84||this.view.spatialReference?.isWebMercator)&&this._imageReprojector.loadAndReprojectBitmapData(t.href,i.bn.fromJSON(t.extent),this.view.spatialReference).then((e=>{const n=new r.S(e.bitmapData);n.x=e.extent.xmin,n.y=e.extent.ymax,n.resolution=e.extent.width/e.bitmapData.width,n.rotation=t.rotation,this._mapImageContainer.addChild(n),this._bitmapIndex.set(t,n)}))}async _getViewDependentUrl(t,e){const{viewFormat:n,viewBoundScale:s,httpQuery:r}=t;if(null!=n){if(null==e)throw new Error("Loading this network link requires a view state.");let a;if(await(0,i.ck)(),null!=s&&1!==s){const t=new i.bn(e.extent);t.expand(s),a=t}else a=e.extent;a=(0,i.cl)(a,i.aY.WGS84);const o=(0,i.cl)(a,i.aY.WebMercator),l=a.xmin,c=a.xmax,u=a.ymin,h=a.ymax,f=e.size[0]*e.pixelRatio,p=e.size[1]*e.pixelRatio,d=Math.max(o.width,o.height),m={"[bboxWest]":l.toString(),"[bboxEast]":c.toString(),"[bboxSouth]":u.toString(),"[bboxNorth]":h.toString(),"[lookatLon]":a.center.x.toString(),"[lookatLat]":a.center.y.toString(),"[lookatRange]":d.toString(),"[lookatTilt]":"0","[lookatHeading]":e.rotation.toString(),"[lookatTerrainLon]":a.center.x.toString(),"[lookatTerrainLat]":a.center.y.toString(),"[lookatTerrainAlt]":"0","[cameraLon]":a.center.x.toString(),"[cameraLat]":a.center.y.toString(),"[cameraAlt]":d.toString(),"[horizFov]":"60","[vertFov]":"60","[horizPixels]":f.toString(),"[vertPixels]":p.toString(),"[terrainEnabled]":"0","[clientVersion]":i.gP,"[kmlVersion]":"2.2","[clientName]":"ArcGIS API for JavaScript","[language]":"en-US"},g=t=>{for(const e in t){let n;for(n in m)t[e]=t[e].replace(n,m[n])}},_=(0,i.gQ)(n);g(_);let x={};null!=r&&(x=(0,i.gQ)(r),g(x));const y=(0,i.bq)(t.href);return y.query={...y.query,..._,...x},`${y.path}?${(0,i.gR)(_)}`}return t.href}async _fetchService(t){const e=new g;await this._loadVisualData(this.layer.url,e,t),this._kmlVisualData=e,this._refreshCollections()}_refreshCollections(){this.allVisiblePoints.removeAll(),this.allVisiblePolylines.removeAll(),this.allVisiblePolygons.removeAll(),this.allVisibleMapImages.removeAll(),this.allVisiblePoints.addMany(this._kmlVisualData.allPoints.filter((t=>this._isSublayerVisible(t.sublayerId))).map((({item:t})=>t))),this.allVisiblePolylines.addMany(this._kmlVisualData.allPolylines.filter((t=>this._isSublayerVisible(t.sublayerId))).map((({item:t})=>t))),this.allVisiblePolygons.addMany(this._kmlVisualData.allPolygons.filter((t=>this._isSublayerVisible(t.sublayerId))).map((({item:t})=>t))),this.allVisibleMapImages.addMany(this._kmlVisualData.allMapImages.filter((t=>this._isSublayerVisible(t.sublayerId))).map((({item:t})=>t)))}_isSublayerVisible(t){const e=this._kmlVisualData.allSublayers.get(t);return!!e?.visibility&&(-1===e.parentFolderId||this._isSublayerVisible(e.parentFolderId))}_loadVisualData(t,e,n){return this._fetchParsedKML(t,n).then((async t=>{for(const i of t.sublayers){e.allSublayers.set(i.id,i);const t=i.points?await(0,s.b)(i.points):[],r=i.polylines?await(0,s.b)(i.polylines):[],a=i.polygons?await(0,s.b)(i.polygons):[],o=i.mapImages||[];if(e.allPoints.push(...t.map((t=>({item:t,sublayerId:i.id})))),e.allPolylines.push(...r.map((t=>({item:t,sublayerId:i.id})))),e.allPolygons.push(...a.map((t=>({item:t,sublayerId:i.id})))),e.allMapImages.push(...o.map((t=>({item:t,sublayerId:i.id})))),i.networkLink){const t=await this._getViewDependentUrl(i.networkLink,this.view.state);await this._loadVisualData(t,e,n)}}}))}_fetchParsedKML(t,e){return(0,s.g)(t,this.layer.spatialReference,this.layer.refreshInterval,e).then((t=>(0,s.d)(t.data)))}_removeMapImage(t){const e=this._bitmapIndex.get(t);e&&(this._mapImageContainer.removeChild(e),this._bitmapIndex.delete(t))}};(0,i.bt)([(0,i.bu)()],_.prototype,"_pointsView",void 0),(0,i.bt)([(0,i.bu)()],_.prototype,"_polylinesView",void 0),(0,i.bt)([(0,i.bu)()],_.prototype,"_polygonsView",void 0),(0,i.bt)([(0,i.bu)()],_.prototype,"updating",void 0),_=(0,i.bt)([(0,i.bv)("esri.views.2d.layers.KMLLayerView2D")],_);const x=_},36012:function(t,e,n){var i,s,r,a,o,l,c,u;n.d(e,{O:function(){return a},a:function(){return r},e:function(){return i},i:function(){return c},n:function(){return s},s:function(){return o},t:function(){return l},u:function(){return u}}),function(t){t[t.None=0]="None",t[t.Front=1]="Front",t[t.Back=2]="Back",t[t.COUNT=3]="COUNT"}(i||(i={})),function(t){t[t.Less=0]="Less",t[t.Lequal=1]="Lequal",t[t.COUNT=2]="COUNT"}(s||(s={})),function(t){t[t.BACKGROUND=0]="BACKGROUND",t[t.UPDATE=1]="UPDATE"}(r||(r={})),function(t){t[t.NOT_LOADED=0]="NOT_LOADED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED"}(a||(a={})),function(t){t[t.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",t[t.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(o||(o={})),function(t){t[t.Highlight=0]="Highlight",t[t.MaskOccludee=1]="MaskOccludee"}(l||(l={})),function(t){t[t.Blend=0]="Blend",t[t.Opaque=1]="Opaque",t[t.Mask=2]="Mask",t[t.MaskBlend=3]="MaskBlend",t[t.COUNT=4]="COUNT"}(c||(c={})),function(t){t.DDS_ENCODING="image/vnd-ms.dds",t.KTX2_ENCODING="image/ktx2",t.BASIS_ENCODING="image/x.basis"}(u||(u={}))},51800:function(t,e,n){n.d(e,{o:function(){return s},r:function(){return r}});var i=n(44444);function s(t,e,n=0){const s=(0,i.b0)(t,0,l);for(let i=0;i<4;i++)e[n+i]=Math.floor(256*c(s*a[i]))}function r(t,e=0){let n=0;for(let i=0;i<4;i++)n+=t[e+i]*o[i];return n}const a=[1,256,65536,16777216],o=[1/256,1/65536,1/16777216,1/4294967296],l=r(new Uint8ClampedArray([255,255,255,255]));function c(t){return t-Math.floor(t)}},76328:function(t,e,n){n.d(e,{o:function(){return r},r:function(){return a},t:function(){return s}});class i{}const s=i;function r(t,...e){let n="";for(let i=0;i<e.length;i++)n+=t[i]+e[i];return n+=t[t.length-1],n}function a(t,e,n=""){return t?e:n}(function(t){function e(t){return Math.round(t).toString()}function n(t){return t.toPrecision(8)}t.int=e,t.float=n})(r||(r={}))},78890:function(t,e,n){n.d(e,{S:function(){return o},b:function(){return h},d:function(){return r},g:function(){return a},j:function(){return f}});var i=n(44444);const s={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};function r(t){const e=t.folders||[],n=e.slice(),r=new Map,a=new Map,o=new Map,c=new Map,h=new Map,p={esriGeometryPoint:a,esriGeometryPolyline:o,esriGeometryPolygon:c};(t.featureCollection?.layers||[]).forEach((t=>{const e=(0,i.T)(t);e.featureSet.features=[];const n=t.featureSet.geometryType;r.set(n,e);const s=t.layerDefinition.objectIdField;"esriGeometryPoint"===n?l(a,s,t.featureSet.features):"esriGeometryPolyline"===n?l(o,s,t.featureSet.features):"esriGeometryPolygon"===n&&l(c,s,t.featureSet.features)})),t.groundOverlays&&t.groundOverlays.forEach((t=>{h.set(t.id,t)})),e.forEach((e=>{e.networkLinkIds.forEach((i=>{const s=u(i,e.id,t.networkLinks);s&&n.push(s)}))})),n.forEach((t=>{if(t.featureInfos){t.points=(0,i.T)(r.get("esriGeometryPoint")),t.polylines=(0,i.T)(r.get("esriGeometryPolyline")),t.polygons=(0,i.T)(r.get("esriGeometryPolygon")),t.mapImages=[];for(const e of t.featureInfos)switch(e.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":{const n=p[e.type].get(e.id);n&&t[s[e.type]]?.featureSet.features.push(n);break}case"GroundOverlay":{const n=h.get(e.id);n&&t.mapImages.push(n);break}}t.fullExtent=f([t])}}));const d=f(n);return{folders:e,sublayers:n,extent:d}}function a(t,e,n,s){const r=i.C?.findCredential(t);t=(0,i.cC)(t,{token:r?.token});const a=i.cD.kmlServiceUrl;return(0,i.U)(a,{query:{url:t,model:"simple",folders:"",refresh:0!==n||void 0,outSR:JSON.stringify(e)},responseType:"json",signal:s})}function o(t,e,n=null,i=[]){const s=[],r={},a=e.sublayers,o=new Set(e.folders.map((t=>t.id)));return a.forEach((e=>{const a=new t;if(n?a.read(e,n):a.read(e),i.length&&o.has(a.id)&&(a.visible=i.includes(a.id)),r[e.id]=a,null!=e.parentFolderId&&-1!==e.parentFolderId){const t=r[e.parentFolderId];t.sublayers||(t.sublayers=[]),t.sublayers?.unshift(a)}else s.unshift(a)})),s}function l(t,e,n){n.forEach((n=>{t.set(n.attributes[e],n)}))}function c(t,e){let n;return e.some((e=>e.id===t&&(n=e,!0))),n}function u(t,e,n){const i=c(t,n);return i&&(i.parentFolderId=e,i.networkLink=i),i}async function h(t){const e=i.bx.fromJSON(t.featureSet).features,n=t.layerDefinition,s=(0,i.cf)(n.drawingInfo.renderer),r=i.ce.fromJSON(t.popupInfo),a=[];for(const i of e){const t=await s.getSymbolAsync(i);i.symbol=t,i.popupTemplate=r,i.visible=!0,a.push(i)}return a}function f(t){const e=(0,i.cE)(i.cF),n=(0,i.cE)(i.cF);for(const s of t){if(s.polygons?.featureSet?.features)for(const t of s.polygons.featureSet.features)(0,i.cG)(e,t.geometry),(0,i.cH)(n,e);if(s.polylines?.featureSet?.features)for(const t of s.polylines.featureSet.features)(0,i.cG)(e,t.geometry),(0,i.cH)(n,e);if(s.points?.featureSet?.features)for(const t of s.points.featureSet.features)(0,i.cG)(e,t.geometry),(0,i.cH)(n,e);if(s.mapImages)for(const t of s.mapImages)(0,i.cG)(e,t.extent),(0,i.cH)(n,e)}return(0,i.cI)(n,i.cF)?void 0:{xmin:n[0],ymin:n[1],zmin:n[2],xmax:n[3],ymax:n[4],zmax:n[5],spatialReference:i.aY.WGS84}}},6255:function(t,e,n){n.d(e,{C:function(){return x},D:function(){return D},I:function(){return S},K:function(){return O},V:function(){return B},a:function(){return X},c:function(){return Y},e:function(){return U},f:function(){return K},i:function(){return z},j:function(){return _},l:function(){return H},t:function(){return W},v:function(){return g},w:function(){return r}});var i,s=n(44444);function r(t,e,n){return!(0,s.bD)(t,e,n)}function a(t,e,n){const i=r(t,e,n);if(i&&!(0,s.cj)())throw new s.s("rasterprojectionhelper-project","projection engine is not loaded");return i}(function(t){t[t.None=0]="None",t[t.North=1]="North",t[t.South=2]="South",t[t.Both=3]="Both"})(i||(i={}));const o=(t,e,n,i=0)=>{if(1===n[0])return[0,0];let s=1,r=-1,a=1,o=-1;for(let g=0;g<t.length;g+=2)isNaN(t[g])||(s=s>t[g]?t[g]:s,r=r>t[g]?r:t[g],a=a>t[g+1]?t[g+1]:a,o=o>t[g+1]?o:t[g+1]);const{cols:l,rows:c}=e,u=(r-s)/l/n[0],h=(o-a)/c/n[1],f=2*i;let p=0,d=!1,m=[0,0];for(let g=0;g<l-3;g++){for(let e=0;e<c-3;e++){const n=g*c*2+2*e,i=(t[n]+t[n+4]+t[n+4*c]+t[n+4*c+4])/4,s=(t[n+1]+t[n+5]+t[n+4*c+1]+t[n+4*c+5])/4,r=Math.abs((i-t[n+2*c+2])/u),a=Math.abs((s-t[n+2*c+3])/h);if(r+a>p&&(p=r+a,m=[r,a]),f&&p>f){d=!0;break}}if(d)break}return m},l={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},c=32,u=4,h=u,f=new Map,p=new Map,d=500;let m=null;async function g(){m&&(0,s.cj)()||((0,s.cj)()||await(0,s.ck)(),m=await Promise.all([n.e(6239),n.e(2518)]).then(n.bind(n,2518)))}function _(t,e,n){return a(t.spatialReference,e),n?(0,s.cs)(e,t.spatialReference,t):(0,s.cs)(t.spatialReference,e,t)}function x(t,e,n,i=null){const r=t.spatialReference;if(!r||!e||r.equals(e))return t;a(r,e,i);const o=n.center,l=new s.bn({xmin:o.x-t.x/2,xmax:o.x+t.x/2,ymin:o.y-t.y/2,ymax:o.y+t.y/2,spatialReference:r}),c=(0,s.cl)(l,e,i),u=B(e);return null==c||null!=u&&c.width>=u?y(t,r,e):{x:c.width,y:c.height}}function y(t,e,n){const i=(0,s.cm)(e)/(0,s.cm)(n);return{x:t.x*i,y:t.y*i}}function w(t,e,n){const{spatialReference:i}=n;if(!i||!e||i.equals(e))return t;if(i.isGeographic&&e.isGeographic)return y(t,i,e);if(a(i,e),!m)throw new s.s("raster-projection-helper:project-dataset-resolution","geometry engine is not loaded");let{x:r,y:o}=t;const l=(r+o)/2*(0,s.cm)(i);let c=1;l>30&&(c=30/l,r*=c,o*=c);const u=256,h=r*u/2,f=o*u/2,{x:p,y:d}=n.center,g=[];for(let s=0;s<=u;s++)g.push([p-h,d-f+s*o]);for(let s=1;s<=u;s++)g.push([p-h+s*r,d+f]);for(let s=1;s<=u;s++)g.push([p+h,d+f-s*o]);for(let s=1;s<u;s++)g.push([p+h-s*r,d-f]);g.push(g[0]);const _=new s.a$({rings:[g],spatialReference:i}),x=(0,s.cl)(_,e);if(!x)return y(t,i,e);const w=x.extent,b=B(e);if(null==w||null!=b&&w.width>=b)return y(t,i,e);const S=m.planarArea(x),v=r*o*u*u,T=Math.sqrt(S/v)/c,E={x:w.width/c/u,y:w.height/c/u},M={x:r*T,y:o*T},I=E.x*E.y;return Math.abs(I-M.x*M.y)/I<.1?E:M}function b(t,e=.01){return(0,s.cm)(t)?e/(0,s.cm)(t):0}function S(t,e,n=null,i=!0){const r=t.spatialReference;if(r.equals(e))return t;a(r,e,n);const o=(0,s.cl)(t,e,n);return i&&o&&v([t],[o],r,e),o}function v(t,e,n,i){const s=V(n,!0),r=V(i,!0),a=b(n,d),o=b(i,d);if(a&&null!=s&&null!=r)for(let l=0;l<t.length;l++){const n=e[l];if(!n)continue;const{x:i}=t[l],{x:c}=n;c>=r[1]-o&&Math.abs(i-s[0])<a?n.x-=r[1]-r[0]:c<=r[0]+o&&Math.abs(i-s[1])<a&&(n.x+=r[1]-r[0])}}function T(t){const{inSR:e,outSR:n,datumTransformation:i,preferPE:s}=t;if(e.equals(n)){const{points:e}=P(t,null);return e}return e.isWebMercator&&n.isWGS84||e.isWGS84&&n.isWebMercator?I(t):a(e,n,i)&&s&&(e.isGeographic||null!=R(e))?M(t):E(t)}function E(t){const{points:e}=P(t,null),{inSR:n,outSR:i,datumTransformation:r}=t,a=e.map((t=>new s.D(t[0],t[1],n))),o=(0,s.cl)(a,i,r);return r&&v(a,o,n,i),o.map((t=>t?[t.x,t.y]:[NaN,NaN]))}function M(t){const{inSR:e,outSR:n,datumTransformation:i}=t,r=R(e),{points:a,mask:o}=P(t,r);if(!e.isGeographic){const t=e.wkid?s.cn.coordsys(e.wkid):s.cn.fromString(e.isGeographic?s.co.PE_TYPE_GEOGCS:s.co.PE_TYPE_PROJCS,e.wkt2||e.wkt);s.cp.projToGeog(t,a.length,a)}if(null!=i&&i.steps.length){let t;if(n.isGeographic&&(t=a.map((([t])=>t>179.9955?1:t<-179.9955?-1:0))),i.steps.forEach((t=>{const e=t.wkid?s.cn.geogtran(t.wkid):s.cn.fromString(s.co.PE_TYPE_GEOGTRAN,t.wkt);s.cq.geogToGeog(e,a.length,a,null,t.isInverse?s.co.PE_TRANSFORM_2_TO_1:s.co.PE_TRANSFORM_1_TO_2)})),t)for(let e=0;e<a.length;e++){const n=t[e],i=a[e][0],s=i>179.9955?1:i<-179.9955?-1:0;n&&s&&n!==s&&(a[e][0]=n>0?i+360:i-360)}}if(!n.isGeographic){const t=R(n,!0),e=null!=t&&t.isEnvelope?[t.bbox[1],t.bbox[3]]:[-90,90];A(a,e);const i=n.wkid?s.cn.coordsys(n.wkid):s.cn.fromString(n.isGeographic?s.co.PE_TYPE_GEOGCS:s.co.PE_TYPE_PROJCS,n.wkt2||n.wkt);s.cp.geogToProj(i,a.length,a)}let l=a;if(o&&a.length!==o.length){l=[];for(let t=0,e=0;t<o.length;t++)o[t]?l.push(a[e++]):l.push([NaN,NaN])}return l}function I(t){const{cols:e,rows:n,xres:i,yres:r,usePixelCenter:a,inSR:o,outSR:l}=t;let{xmin:c,ymax:u}=t;a&&(c+=i/2,u-=r/2);const h=[],f=[],p=Math.max(e,n);for(let m=0;m<p;m++){const t=c+i*Math.min(e,m),a=u-r*Math.min(n,m),p=(0,s.cl)(new s.D({x:t,y:a,spatialReference:o}),l);m<=e&&h.push(p.x),m<=n&&f.push(p.y)}const d=[];for(let s=0;s<e;s++)for(let t=0;t<n;t++)d.push([h[s],f[t]]);return d}function R(t,e=!1){let n=t.wkid||t.wkt2||t.wkt;if(!n||t.isGeographic)return null;if(n=String(n),f.has(n)){const t=f.get(n);return e?t?.gcs:t?.pcs}const i=t.wkid?s.cn.coordsys(t.wkid):s.cn.fromString(t.isGeographic?s.co.PE_TYPE_GEOGCS:s.co.PE_TYPE_PROJCS,t.wkt2||t.wkt),r=C(i,b(t,1e-4)),a=C(i,0,!0);return f.set(n,{pcs:r,gcs:a}),e?a:r}function C(t,e=0,n=!1){const i=s.cr.generate(t),r=n?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!i||!r?.length)return null;let a=!1,o=r.find((t=>1===t.getInclusive()&&1===t.getKind()));if(!o){if(o=r.find((t=>1===t.getInclusive()&&0===t.getKind())),!o)return null;a=!0}const l=n?0:(2===i.getNorthPoleLocation()?1:0)|(2===i.getSouthPoleLocation()?2:0),c=i.isPannableRectangle(),u=o.getCoord();if(a)return{isEnvelope:a,isPannable:c,vertices:u,coef:null,bbox:[u[0][0]-e,u[0][1]-e,u[1][0]+e,u[1][1]+e],poleLocation:l};let h=0;const f=[];let[p,d]=u[0],[m,g]=u[0];for(let s=0,_=u.length;s<_;s++){h++,h===_&&(h=0);const[t,e]=u[s],[n,i]=u[h];if(i===e)f.push([t,n,e,i,2]);else{const s=(n-t)/(i-e||1e-4),r=t-s*e;e<i?f.push([s,r,e,i,0]):f.push([s,r,i,e,1])}p=p<t?p:t,d=d<e?d:e,m=m>t?m:t,g=g>e?g:e}return{isEnvelope:!1,isPannable:c,vertices:u,coef:f,bbox:[p,d,m,g],poleLocation:l}}function P(t,e){const n=[],{cols:i,rows:s,xres:r,yres:a,usePixelCenter:o}=t;let{xmin:l,ymax:c}=t;if(o&&(l+=r/2,c-=a/2),null==e){for(let t=0;t<i;t++)for(let e=0;e<s;e++)n.push([l+r*t,c-a*e]);return{points:n}}const u=new Uint8Array(i*s);if(e.isEnvelope){const{bbox:[t,o,h,f]}=e;for(let p=0,d=0;p<i;p++){const i=l+r*p,m=e.isPannable||i>=t&&i<=h;for(let t=0;t<s;t++,d++){const e=c-a*t;m&&e>=o&&e<=f&&(n.push([i,e]),u[d]=1)}}return{points:n,mask:u}}const h=e.coef,f=[];for(let p=0;p<s;p++){const t=c-a*p,e=[],n=[];for(let s=0;s<h.length;s++){const[i,r,a,o,l]=h[s];if(t===a&&a===o)e.push(i),e.push(r),n.push(2),n.push(2);else if(t>=a&&t<=o){const s=i*t+r;e.push(s),n.push(l)}}let i=e;if(e.length>2){let t=2===n[0]?0:n[0],s=e[0];i=[];for(let r=1;r<n.length;r++)2===n[r]&&r!==n.length-1||(n[r]!==t&&(i.push(0===t?Math.min(s,e[r-1]):Math.max(s,e[r-1])),t=n[r],s=e[r]),r===n.length-1&&i.push(0===n[r]?Math.min(s,e[r]):Math.max(s,e[r])));i.sort(((t,e)=>t-e))}else e[0]>e[1]&&(i=[e[1],e[0]]);f.push(i)}for(let p=0,d=0;p<i;p++){const t=l+r*p;for(let e=0;e<s;e++,d++){const i=c-a*e,s=f[e];if(2===s.length)t>=s[0]&&t<=s[1]&&(n.push([t,i]),u[d]=1);else if(s.length>2){let e=!1;for(let n=0;n<s.length;n+=2)if(t>=s[n]&&t<=s[n+1]){e=!0;break}e&&(n.push([t,i]),u[d]=1)}}}return{points:n,mask:u}}function A(t,e){const[n,i]=e;for(let s=0;s<t.length;s++){const e=t[s][1];(e<n||e>i)&&(t[s]=[NaN,NaN])}}function k(t,e){const n=B(t[0].spatialReference);if(t.length<2||null==n||(e=e??b(t[0].spatialReference),1===(t=t.filter((t=>t.width>e))).length))return t[0];let{xmin:i,xmax:r,ymin:a,ymax:o}=t[0];for(let s=1;s<t.length;s++){const e=t[s];r=e.xmax+n*s,a=Math.min(a,e.ymin),o=Math.max(o,e.ymax)}return new s.bn({xmin:i,xmax:r,ymin:a,ymax:o,spatialReference:t[0].spatialReference})}function O(t,e,n=null,r=!0){const a=t.spatialReference;if(a.equals(e))return t;const o=U(t),l=B(a,!0),c=B(e);if(0===o||null==l||null==c){const o=G(t,e,n,r);if(null==l&&null!=c&&Math.abs(o.width-c)<b(e)&&(0,s.cj)()){const n=R(a);if(null!=n&&n.poleLocation===i.None&&t.width<(n.bbox[2]-n.bbox[0])/2)return N(t,e)||o}return o}const u=t.clone().normalize();if(1===u.length&&t.xmax<l&&t.xmax-l/2>b(a)){const{xmin:e,xmax:n}=t;for(let i=0;i<=o;i++){const r=0===i?e:-l/2,c=i===o?n-l*i:l/2;u[i]=new s.bn({xmin:r,xmax:c,ymin:t.ymin,ymax:t.ymax,spatialReference:a})}}return k(u.map((t=>G(t,e,n,r))).filter(s.ci))}function D(t,e,n){if("extent"===t.type){const{xmin:e,ymin:n,xmax:i,ymax:r,spatialReference:a}=t;t=new s.a$({rings:[[[e,r],[i,r],[i,n],[e,n],[e,r]]],spatialReference:a})}return t.spatialReference.equals(e)?t:(a(t.spatialReference,e,n),(0,s.cl)(t,e,n))}function N(t,e){const n=B(e);if(null==n)return null;let{xmin:i,ymin:r,xmax:a,ymax:o}=t;const l=t.spatialReference,c=new s.a$({spatialReference:l,rings:[[[i,r],[a,r],[a,o],[i,o],[i,r]]]}),u=(0,s.cl)(c,e);if(2!==u.rings.length||!u.rings[0].length||!u.rings[1].length)return null;const{rings:h}=u,f=b(l),p=new s.bn({spatialReference:e});for(let s=0;s<2;s++){i=a=h[s][0][0],r=o=h[s][0][1];for(let t=0;t<h[s].length;t++)i=i>h[s][t][0]?h[s][t][0]:i,a=a<h[s][t][0]?h[s][t][0]:a,r=r>h[s][t][1]?h[s][t][1]:r,o=o<h[s][t][1]?h[s][t][1]:o;if(0===s)p.ymin=r,p.ymax=o,p.xmin=i,p.xmax=a;else if(p.ymin=Math.min(p.ymin,r),p.ymax=Math.max(p.ymax,o),Math.abs(a-n/2)<f)p.xmin=i,p.xmax=p.xmax+n;else{if(!(Math.abs(i+n/2)<f))return null;p.xmax=a+n}}return p}function G(t,e,n=null,i=!0,r=!0){const o=t.spatialReference;if(o.equals(e)||!e)return t;a(o,e,n);const l=(0,s.cl)(t,e,n);if(r&&e.isWebMercator&&l&&(l.ymax=Math.min(20037508.342787,l.ymax),l.ymin=Math.max(-20037508.342787,l.ymin),l.ymin>=l.ymax))return null;if(!i||!l)return l;const c=V(o,!0),u=V(e,!0);if(null==c||null==u)return l;const h=b(o,.001),f=b(o,d),p=b(e,.001);if(Math.abs(l.xmin-u[0])<p&&Math.abs(l.xmax-u[1])<p){const i=Math.abs(t.xmin-c[0]),r=Math.abs(c[1]-t.xmax);if(i<h&&r>f){l.xmin=u[0];const i=[];i.push(new s.D(t.xmax,t.ymin,o)),i.push(new s.D(t.xmax,(t.ymin+t.ymax)/2,o)),i.push(new s.D(t.xmax,t.ymax,o));const r=i.map((t=>S(t,e,n))).filter((t=>!isNaN(t?.x))).map((t=>t.x));l.xmax=Math.max.apply(null,r)}if(r<h&&i>f){l.xmax=u[1];const i=[];i.push(new s.D(t.xmin,t.ymin,o)),i.push(new s.D(t.xmin,(t.ymin+t.ymax)/2,o)),i.push(new s.D(t.xmin,t.ymax,o));const r=i.map((t=>S(t,e,n))).filter((t=>!isNaN(t?.x))).map((t=>t.x));l.xmin=Math.min.apply(null,r)}}else{const t=b(e,.001);Math.abs(l.xmin-u[0])<t&&(l.xmin=u[0]),Math.abs(l.xmax-u[1])<t&&(l.xmax=u[1])}return l}function B(t,e=!1){if(!t)return null;const n=e?20037508.342787:20037508.342788905;return t.isWebMercator?2*n:t.wkid&&t.isGeographic?360:2*l[t.wkid]||null}function V(t,e=!1){if(t.isGeographic)return[-180,180];const n=B(t,e);return null!=n?[-n/2,n/2]:null}function L(t,e,n,i){let s=(t-e)/n;return s-Math.floor(s)!=0?s=Math.floor(s):i&&(s-=1),s}function U(t,e=!1){const n=B(t.spatialReference);if(null==n)return 0;const i=e?0:-n/2,s=b(t.spatialReference),r=!e&&Math.abs(t.xmax-n/2)<s?n/2:t.xmax,a=!e&&Math.abs(t.xmin+n/2)<s?-n/2:t.xmin;return L(r,i,n,!0)-L(a,i,n,!1)}function W(t){const e=t.storageInfo.origin.x,n=B(t.spatialReference,!0);if(null==n)return{originX:e,halfWorldWidth:null,pyramidsInfo:null};const i=n/2,{nativePixelSize:s,storageInfo:r,extent:a}=t,{maximumPyramidLevel:o,blockWidth:l,pyramidScalingFactor:c}=r;let u=s.x;const h=[],f=null!=t.transform&&"gcs-shift"===t.transform.type,p=e+(f?0:i),d=f?n-e:i-e;for(let m=0;m<=o;m++){const t=(a.xmax-e)/u/l,n=t-Math.floor(t)==0?t:Math.ceil(t),i=d/u/l,s=i-Math.floor(i)==0?i:Math.ceil(i),r=Math.floor(p/u/l),o=Math.round(p/u)%l,f=(l-Math.round(d/u)%l)%l;h.push({resolutionX:u,blockWidth:l,datasetColumnCount:n,worldColumnCountFromOrigin:s,leftMargin:o,rightPadding:f,originColumnOffset:r}),u*=c}return{originX:e,halfWorldWidth:i,pyramidsInfo:h,hasGCSSShiftTransform:f}}function F(t){if(!t||t.isGeographic)return t;const e=String(t.wkid||t.wkt2||t.wkt);let n;return p.has(e)?n=p.get(e):(n=(t.wkid?s.cn.coordsys(t.wkid):s.cn.fromString(s.co.PE_TYPE_PROJCS,t.wkt2||t.wkt)).getGeogcs().getCode(),p.set(e,n)),new s.aY({wkid:n})}function z(t){const e=t.isAdaptive&&null==t.spacing;let n=t.spacing||[c,c],i=j(t),s={cols:i.size[0]+1,rows:i.size[1]+1};const a=i.outofBoundPointCount>0&&i.outofBoundPointCount<i.offsets.length/2;let l=i.outofBoundPointCount===i.offsets.length/2||e&&a?[0,0]:o(i.offsets,s,n,h);const f=(l[0]+l[1])/2,p=t.projectedExtent.spatialReference,d=t.srcBufferExtent.spatialReference;if(e&&(a||f>h)&&(r(p,d,t.datumTransformation)&&(p.isGeographic||R(p)),n=[u,u],i=j({...t,spacing:n}),s={cols:i.size[0]+1,rows:i.size[1]+1},l=o(i.offsets,s,n,h)),i.error=l,n[0]>1&&(i.coefficients=q(i.offsets,s,a)),t.includeGCSGrid&&!p.isGeographic&&!p.isWebMercator)if(d.isGeographic)i.gcsGrid={offsets:i.offsets,coefficients:i.coefficients,spacing:n};else{const e=R(p);if(null!=e&&!e.isEnvelope){const e=F(p),r=O(t.projectedExtent,e),{offsets:o}=j({...t,srcBufferExtent:r,spacing:n}),l=q(o,s,a);i.gcsGrid={offsets:o,coefficients:l,spacing:n}}}return i}function j(t){const{projectedExtent:e,srcBufferExtent:n,pixelSize:i,datumTransformation:r,rasterTransform:o}=t,l=e.spatialReference,h=n.spatialReference,f=a(l,h),{xmin:p,ymin:m,xmax:g,ymax:_}=e,x=B(h),y=null!=x&&(t.hasWrapAround||"gcs-shift"===o?.type),w=t.spacing||[c,c],S=w[0]*i.x,v=w[1]*i.y,E=1===w[0],M=Math.ceil((g-p)/S-.1/w[0])+(E?0:1),I=Math.ceil((_-m)/v-.1/w[1])+(E?0:1),C=T({cols:M,rows:I,xmin:p,ymax:_,xres:S,yres:v,inSR:l,outSR:h,datumTransformation:r,preferPE:w[0]<=u,usePixelCenter:E}),P=[];let A,k=0;const O=E?-1:NaN,{xmin:D,xmax:N,ymax:G,width:V,height:L}=n,U=b(h,d),W=null!=x&&D>0&&N>x/2;let F=!1;if(f){const t=R(l);F=null!=t&&t.poleLocation>0}for(let a=0;a<M;a++){const t=[];for(let e=0;e<I;e++){let n=C[a*I+e];if(y&&n[0]>N&&n[0]>x/2-U?n[0]-=x:y&&0===a&&n[0]<0&&W&&!o&&(n[0]+=x),!n||isNaN(n[0])||isNaN(n[1]))P.push(O),P.push(O),t.push(null),k++;else{if(o){const t=o.inverseTransform(new s.D({x:n[0],y:n[1],spatialReference:h}));n=[t.x,t.y]}t.push(n),a>0&&y&&A[e]&&n[0]<A[e][0]&&(n[0]+=x,F&&n[0]>N&&n[0]>x&&(n[0]-=x)),P.push((n[0]-D)/V),P.push((G-n[1])/L)}}A=t}return{offsets:P,error:null,coefficients:null,outofBoundPointCount:k,spacing:w,size:E?[M,I]:[M-1,I-1]}}function q(t,e,n){const{cols:i,rows:s}=e,r=new Float32Array((i-1)*(s-1)*2*6),a=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),o=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let l=0;l<i-1;l++){for(let e=0;e<s-1;e++){let n=l*s*2+2*e;const c=t[n],u=t[n+1],h=t[n+2],f=t[n+3];n+=2*s;const p=t[n],d=t[n+1],m=t[n+2],g=t[n+3];let _=0,x=12*(e*(i-1)+l);for(let t=0;t<3;t++)r[x++]=a[_++]*c+a[_++]*h+a[_++]*m;_=0;for(let t=0;t<3;t++)r[x++]=a[_++]*u+a[_++]*f+a[_++]*g;_=0;for(let t=0;t<3;t++)r[x++]=o[_++]*c+o[_++]*p+o[_++]*m;_=0;for(let t=0;t<3;t++)r[x++]=o[_++]*u+o[_++]*d+o[_++]*g}if(n)for(let t=0;t<r.length;t++)isNaN(r[t])&&(r[t]=-1)}return r}function Q(t,e){const n=t.clone().normalize();return 1===n.length?n[0]:k(n,e)}function X(t){const{spatialReference:e}=t,n=(0,s.b3)(e);if(!n)return t;const[i,r]=n.valid,a=r-i;let o=0;if(t.xmin<i){const e=i-t.xmin;o=Math.ceil(e/a)}else if(t.xmin>r){const e=t.xmin-r;o=-Math.ceil(e/a)}return new s.bn({spatialReference:t.spatialReference,xmin:t.xmin+o*a,ymin:t.ymin,xmax:t.xmax+o*a,ymax:t.ymax})}function H(t,e,n){const{storageInfo:i,pixelSize:r}=e;let a=0,o=!1;const{pyramidResolutions:l}=i,c="mixed"===i.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,i.tileInfo.dpi/96)):1,u=(t.x+t.y)/2/c;if(null!=l&&l.length){const t=l[l.length-1],i=(t.x+t.y)/2,c=(r.x+r.y)/2;if(u<=c)a=0;else if(u>=i)a=l.length,o=u/i>8;else{let t,e=c;for(let i=1;i<=l.length;i++){if(t=(l[i-1].x+l[i-1].y)/2,u<=t){u===t?a=i:"down"===n?(a=i-1,o=u/e>8):a="up"===n||u-e>t-u||u/e>2?i:i-1;break}e=t}}const h=0===a?r:l[a-1];return o&&Math.min(h.x,h.y)*(0,s.cm)(e.spatialReference)>19567&&(o=!1),{pyramidLevel:a,pyramidResolution:new s.D({x:h.x,y:h.y,spatialReference:e.spatialReference}),excessiveReading:o}}const h=Math.log(t.x/r.x)/Math.LN2,f=Math.log(t.y/r.y)/Math.LN2,p=e.storageInfo.maximumPyramidLevel||0;a="down"===n?Math.floor(Math.min(h,f)):"up"===n?Math.ceil(Math.max(h,f)):Math.round((h+f)/2),a<0?a=0:a>p&&(o=a>p+3,a=p);const d=2**a;return{pyramidLevel:a,pyramidResolution:new s.D({x:d*e.nativePixelSize.x,y:d*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:o}}function Y(t,e){const{pixelSize:n,extent:i}=t,s=_(i,e,!1);return O(Q(i,(n.x+n.y)/16),e,s)}function K(t,e,n){const i=n?.tileSize,r=n?.alignGlobalDatasetWithAGOL,{extent:a,spatialReference:o,pixelSize:l}=t,c=w(l,e,a);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const u=(c.x+c.y)/2,h=(0,s.cm)(e),f=u*h*96*39.37,p=e.isGeographic?256/i*295828763.7958547:256/i*591657527.591555;let d="vector-magdir"===t.dataType||"vector-uv"===t.dataType;const m=Y(t,e),g=Math.min(Math.ceil(Math.log(Math.min(t.width,t.height)/32)/Math.LN2),Math.ceil(Math.log(p/2/f)/Math.LN2));if(!d&&r&&(e.isGeographic||e.isWebMercator)){const n=B(e);if(d=U(m)>0||null!=n&&m.width>n/4,!d&&null!=n){let e=-1;if(g<3)e=2**g*u*i;else if(t.storageInfo){const{maximumPyramidLevel:n=0,pyramidScalingFactor:s=2}=t.storageInfo;e=s**n*u*i}const s=Math.ceil(n/e);d=1===s||2===s&&n/2-m.xmax<e}}let _,x=f;const y=1.001,b=Math.min(2,Math.max(1.414,t.storageInfo?.pyramidScalingFactor||2));if(d){x=p;const n=e.isGeographic?1341104507446289e-21:.29858214164761665,i=n*(96*h*39.37),r=e.isGeographic?4326:3857;_=w({x:n,y:n},o,Y(t,new s.aY({wkid:r}))),_.x*=x/i,_.y*=x/i}else{_={x:l.x,y:l.y};let t=0;for(;x<p*(y/2)&&t<g;)t++,x*=b,_.x*=b,_.y*=b;Math.max(x,p)/Math.min(x,p)<=y&&(x=p)}const S=[x],v=[{x:_.x,y:_.y}],T=70.5310735,E=Math.min(T,f)/y;for(;x>=E;)x/=b,_.x/=b,_.y/=b,S.push(x),v.push({x:_.x,y:_.y});return{projectedPixelSize:c,scales:S,srcResolutions:v,isCustomTilingScheme:!d}}},34209:function(t,e,n){n.d(e,{A:function(){return h},O:function(){return d},T:function(){return f},_:function(){return l},c:function(){return r},f:function(){return s},g:function(){return c},h:function(){return p},l:function(){return o},m:function(){return a},p:function(){return u}});var i=n(44444);function s(t,e,n="nearest",s=!1){const r=!(s&&"u8"===e.pixelType),a=r?i.cv.FLOAT:i.cv.UNSIGNED_BYTE,o=null==e.pixels||0===e.pixels.length?null:r?e.getAsRGBAFloat():e.getAsRGBA(),l=t.capabilities.textureFloatLinear,c=new i.ct;return c.width=e.width,c.height=e.height,c.internalFormat=r?i.cu.RGBA32F:i.cA.RGBA,c.samplingMode=!l||"bilinear"!==n&&"cubic"!==n?i.cw.NEAREST:i.cw.LINEAR,c.dataType=a,c.wrapMode=i.cx.CLAMP_TO_EDGE,new i.cy(t,c,o)}function r(t,e){const{spacing:n,offsets:s,coefficients:r,size:[a,o]}=e,l=n[0]>1,c=new i.ct;c.width=l?4*a:a,c.height=o,c.internalFormat=i.cu.RGBA32F,c.dataType=i.cv.FLOAT,c.samplingMode=i.cw.NEAREST,c.wrapMode=i.cx.CLAMP_TO_EDGE;const u=new Float32Array(l?a*o*16:2*s.length);if(l&&null!=r)for(let i=0,h=0;i<r.length;i++)u[h++]=r[i],i%3==2&&(u[h++]=1);else for(let i=0;i<o;i++)for(let t=0;t<a;t++){const e=4*(i*a+t),n=2*(t*o+i);u[e]=s[n],u[e+1]=s[n+1],u[e+3]=-1===s[n]?0:1}return new i.cy(t,c,u)}function a(t,e){const n=new i.ct;return n.internalFormat=i.cA.RGBA,n.width=e.length/4,n.height=1,n.samplingMode=i.cw.NEAREST,n.wrapMode=i.cx.CLAMP_TO_EDGE,new i.cy(t,n,e)}function o(t,e,n,s=1,r=!0){return{u_flipY:r,u_applyTransform:!!t,u_opacity:s,u_transformSpacing:t?t.spacing:i.cB,u_transformGridSize:t?t.size:i.cB,u_targetImageSize:e,u_srcImageSize:n}}function l(t,e){return{u_colormapOffset:e||0,u_colormapMaxIndex:t?t.length/4-1:0}}function c(t,e){return{u_scale:t,u_offset:e}}function u(t){return{u_bandCount:t.bandCount,u_minOutput:t.outMin,u_maxOutput:t.outMax,u_minCutOff:t.minCutOff,u_maxCutOff:t.maxCutOff,u_factor:t.factor,u_useGamma:t.useGamma,u_gamma:t.gamma,u_gammaCorrection:t.gammaCorrection}}function h(t){return{u_hillshadeType:t.hillshadeType,u_sinZcosAs:t.sinZcosAs,u_sinZsinAs:t.sinZsinAs,u_cosZs:t.cosZs,u_weights:t.weights,u_factor:t.factor,u_minValue:t.minValue,u_maxValue:t.maxValue}}function f(t,e){const n=t.gl,i=e.glName,s=new Map;if(null==i)return s;const r=n.getProgramParameter(i,n.ACTIVE_UNIFORMS);let a;for(let o=0;o<r;o++)a=n.getActiveUniform(i,o),a&&s.set(a.name,{location:n.getUniformLocation(i,a.name),info:a});return s}function p(t,e,n){Object.keys(n).forEach((i=>{const s=e.get(i)||e.get(i+"[0]");s&&m(t,i,n[i],s)}))}function d(t,e,n,i){n.length===i.length&&(i.some((t=>null==t))||n.some((t=>null==t))||n.forEach(((n,s)=>{e.setUniform1i(n,s),t.bindTexture(i[s],s)})))}function m(t,e,n,s){if(null===s||null==n)return!1;const{info:r}=s;switch(r.type){case i.cz.FLOAT:r.size>1?t.setUniform1fv(e,n):t.setUniform1f(e,n);break;case i.cz.FLOAT_VEC2:t.setUniform2fv(e,n);break;case i.cz.FLOAT_VEC3:t.setUniform3fv(e,n);break;case i.cz.FLOAT_VEC4:t.setUniform4fv(e,n);break;case i.cz.FLOAT_MAT3:t.setUniformMatrix3fv(e,n);break;case i.cz.FLOAT_MAT4:t.setUniformMatrix4fv(e,n);break;case i.cz.INT:r.size>1?t.setUniform1iv(e,n):t.setUniform1i(e,n);break;case i.cz.BOOL:t.setUniform1i(e,n?1:0);break;case i.cz.INT_VEC2:case i.cz.BOOL_VEC2:t.setUniform2iv(e,n);break;case i.cz.INT_VEC3:case i.cz.BOOL_VEC3:t.setUniform3iv(e,n);break;case i.cz.INT_VEC4:case i.cz.BOOL_VEC4:t.setUniform4iv(e,n);break;default:return!1}return!0}},64235:function(t,e,n){n.d(e,{B:function(){return T},Q:function(){return X},a:function(){return o},c:function(){return c},f:function(){return f},g:function(){return d},o:function(){return l},p:function(){return p},r:function(){return a}});var i=n(36012),s=n(44444);function r(t,e,n=s.aT.ADD,i=[0,0,0,0]){return{srcRgb:t,srcAlpha:t,dstRgb:e,dstAlpha:e,opRgb:n,opAlpha:n,color:{r:i[0],g:i[1],b:i[2],a:i[3]}}}function a(t,e,n,i,r=s.aT.ADD,a=s.aT.ADD,o=[0,0,0,0]){return{srcRgb:t,srcAlpha:e,dstRgb:n,dstAlpha:i,opRgb:r,opAlpha:a,color:{r:o[0],g:o[1],b:o[2],a:o[3]}}}const o=r(s.aQ.ZERO,s.aQ.ONE_MINUS_SRC_ALPHA);r(s.aQ.ONE,s.aQ.ZERO),r(s.aQ.ONE,s.aQ.ONE);const l=r(s.aQ.ONE,s.aQ.ONE_MINUS_SRC_ALPHA),c=a(s.aQ.SRC_ALPHA,s.aQ.ONE,s.aQ.ONE_MINUS_SRC_ALPHA,s.aQ.ONE_MINUS_SRC_ALPHA),u={face:s.aR.BACK,mode:s.aS.CCW},h={face:s.aR.FRONT,mode:s.aS.CCW},f=t=>t===i.e.Back?u:t===i.e.Front?h:null,p={zNear:0,zFar:1},d={r:!0,g:!0,b:!0,a:!0};function m(t){return I.intern(t)}function g(t){return C.intern(t)}function _(t){return A.intern(t)}function x(t){return O.intern(t)}function y(t){return N.intern(t)}function w(t){return B.intern(t)}function b(t){return L.intern(t)}function S(t){return W.intern(t)}function v(t){return z.intern(t)}function T(t){return q.intern(t)}class E{constructor(t,e){this._makeKey=t,this._makeRef=e,this._interns=new Map}intern(t){if(!t)return null;const e=this._makeKey(t),n=this._interns;return n.has(e)||n.set(e,this._makeRef(t)),n.get(e)??null}}function M(t){return"["+t.join(",")+"]"}const I=new E(R,(t=>({__tag:"Blending",...t})));function R(t){return t?M([t.srcRgb,t.srcAlpha,t.dstRgb,t.dstAlpha,t.opRgb,t.opAlpha,t.color.r,t.color.g,t.color.b,t.color.a]):null}const C=new E(P,(t=>({__tag:"Culling",...t})));function P(t){return t?M([t.face,t.mode]):null}const A=new E(k,(t=>({__tag:"PolygonOffset",...t})));function k(t){return t?M([t.factor,t.units]):null}const O=new E(D,(t=>({__tag:"DepthTest",...t})));function D(t){return t?M([t.func]):null}const N=new E(G,(t=>({__tag:"StencilTest",...t})));function G(t){return t?M([t.function.func,t.function.ref,t.function.mask,t.operation.fail,t.operation.zFail,t.operation.zPass]):null}const B=new E(V,(t=>({__tag:"DepthWrite",...t})));function V(t){return t?M([t.zNear,t.zFar]):null}const L=new E(U,(t=>({__tag:"ColorWrite",...t})));function U(t){return t?M([t.r,t.g,t.b,t.a]):null}const W=new E(F,(t=>({__tag:"StencilWrite",...t})));function F(t){return t?M([t.mask]):null}const z=new E(j,(t=>({__tag:"DrawBuffers",...t})));function j(t){return t?M(t.buffers):null}const q=new E(Q,(t=>({blending:m(t.blending),culling:g(t.culling),polygonOffset:_(t.polygonOffset),depthTest:x(t.depthTest),stencilTest:y(t.stencilTest),depthWrite:w(t.depthWrite),colorWrite:b(t.colorWrite),stencilWrite:S(t.stencilWrite),drawBuffers:v(t.drawBuffers)})));function Q(t){return t?M([R(t.blending),P(t.culling),k(t.polygonOffset),D(t.depthTest),G(t.stencilTest),V(t.depthWrite),U(t.colorWrite),F(t.stencilWrite),j(t.drawBuffers)]):null}class X{constructor(t){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._drawBuffersInvalid=!0,this._stateSetters=t}setPipeline(t){(this._pipelineInvalid||t!==this._pipeline)&&(this._setBlending(t.blending),this._setCulling(t.culling),this._setPolygonOffset(t.polygonOffset),this._setDepthTest(t.depthTest),this._setStencilTest(t.stencilTest),this._setDepthWrite(t.depthWrite),this._setColorWrite(t.colorWrite),this._setStencilWrite(t.stencilWrite),this._setDrawBuffers(t.drawBuffers),this._pipeline=t),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDrawBuffers(){this._drawBuffersInvalid=!0,this._pipelineInvalid=!0}_setBlending(t){this._blending=this._setSubState(t,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}_setCulling(t){this._culling=this._setSubState(t,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}_setPolygonOffset(t){this._polygonOffset=this._setSubState(t,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}_setDepthTest(t){this._depthTest=this._setSubState(t,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}_setStencilTest(t){this._stencilTest=this._setSubState(t,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}_setDepthWrite(t){this._depthWrite=this._setSubState(t,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}_setColorWrite(t){this._colorWrite=this._setSubState(t,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}_setStencilWrite(t){this._stencilWrite=this._setSubState(t,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}_setDrawBuffers(t){this._drawBuffers=this._setSubState(t,this._drawBuffers,this._drawBuffersInvalid,this._stateSetters.setDrawBuffers),this._drawBuffersInvalid=!1}_setSubState(t,e,n,i){return(n||t!==e)&&(i(t),this._pipelineInvalid=!0),t}}},23648:function(t,e,n){n.d(e,{a:function(){return u},f:function(){return f},t:function(){return h}});var i=n(38006),s=n(66080),r=n(44444),a=n(57177),o=n(56499);class l{constructor(t,e,n,i,s,r,a,o,l){this.createQuery=t,this.deleteQuery=e,this.resultAvailable=n,this.getResult=i,this.disjoint=s,this.beginTimeElapsed=r,this.endTimeElapsed=a,this.createTimestamp=o,this.timestampBits=l}}let c=!1;function u(t,e){if(e.disjointTimerQuery)return null;let n=t.getExtension("EXT_disjoint_timer_query_webgl2");return n?new l((()=>t.createQuery()),(e=>{t.deleteQuery(e),c=!1}),(e=>t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE)),(e=>t.getQueryParameter(e,t.QUERY_RESULT)),(()=>t.getParameter(n.GPU_DISJOINT_EXT)),(e=>{c||(c=!0,t.beginQuery(n.TIME_ELAPSED_EXT,e))}),(()=>{t.endQuery(n.TIME_ELAPSED_EXT),c=!1}),(t=>n.queryCounterEXT(t,n.TIMESTAMP_EXT)),(()=>t.getQuery(n.TIMESTAMP_EXT,n.QUERY_COUNTER_BITS_EXT))):(n=t.getExtension("EXT_disjoint_timer_query"),n?new l((()=>n.createQueryEXT()),(t=>{n.deleteQueryEXT(t),c=!1}),(t=>n.getQueryObjectEXT(t,n.QUERY_RESULT_AVAILABLE_EXT)),(t=>n.getQueryObjectEXT(t,n.QUERY_RESULT_EXT)),(()=>t.getParameter(n.GPU_DISJOINT_EXT)),(t=>{c||(c=!0,n.beginQueryEXT(n.TIME_ELAPSED_EXT,t))}),(()=>{n.endQueryEXT(n.TIME_ELAPSED_EXT),c=!1}),(t=>n.queryCounterEXT(t,n.TIMESTAMP_EXT)),(()=>n.getQueryEXT(n.TIMESTAMP_EXT,n.QUERY_COUNTER_BITS_EXT))):null)}class h{constructor(){this._result=!1}dispose(){this._program=(0,r.aI)(this._program)}get result(){return null!=this._program&&(this._result=this._test(this._program),this.dispose()),this._result}}class f extends h{constructor(t){super(),this._rctx=t;const e="\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv = a_pos;\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",n="\n    precision highp float;\n\n    varying vec2 v_uv;\n\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor = texture2D(u_texture, v_uv);\n    }\n    ";this._program=t.programCache.acquire(e,n,new Map([["a_pos",0]]))}dispose(){super.dispose()}_test(t){const e=this._rctx;if(!e.gl)return t.dispose(),!0;const n=new r.ct(1);n.wrapMode=r.cx.CLAMP_TO_EDGE,n.samplingMode=r.cw.NEAREST;const l=new a.x(e,n),c=s.E.createVertex(e,r.az.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),u=new o.o(e,new Map([["a_pos",0]]),i.b,new Map([["geometry",c]])),h=new r.ct;h.samplingMode=r.cw.LINEAR,h.wrapMode=r.cx.CLAMP_TO_EDGE;const f=new r.cy(e,h,p);e.useProgram(t),e.bindTexture(f,0),t.setUniform1i("u_texture",0);const d=e.getBoundFramebufferObject(),{x:m,y:g,width:_,height:x}=e.getViewport();e.bindFramebuffer(l),e.setViewport(0,0,1,1),e.setClearColor(0,0,0,0),e.setBlendingEnabled(!1),e.clear(r.h_.COLOR),e.bindVAO(u),e.drawArrays(r.hW.TRIANGLE_STRIP,0,4);const y=new Uint8Array(4);return l.readPixels(0,0,1,1,r.cA.RGBA,r.cv.UNSIGNED_BYTE,y),u.dispose(),l.dispose(),f.dispose(),e.setViewport(m,g,_,x),e.bindFramebuffer(d),255!==y[0]}}const p=new Image;p.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",p.width=5,p.height=5,p.decode()}}]);
//# sourceMappingURL=6607.7bcf4a5b.js.map