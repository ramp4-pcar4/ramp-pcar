"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[2347],{17930:function(t,e,i){i.d(e,{t:function(){return r}});class r{constructor(t){this.size=0,this._start=0,this.maxSize=t,this._buffer=new Array(t)}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const e=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,e}return this._buffer[(this._start+this.size++)%this.maxSize]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}peekLast(){return 0===this.size?null:this._buffer[(this._start+(this.size-1))%this.maxSize]}find(t){if(0===this.size)return null;for(const e of this._buffer)if(null!=e&&t(e))return e;return null}clear(t){let e=this.dequeue();for(;null!=e;)t&&t(e),e=this.dequeue()}}},52576:function(t,e,i){i.d(e,{N:function(){return xe},P:function(){return ie},T:function(){return Yt},_:function(){return Te},a:function(){return qt},b:function(){return jt},c:function(){return N},d:function(){return zt},e:function(){return vt},f:function(){return p},g:function(){return x},h:function(){return Gt},i:function(){return $t},j:function(){return Pt},k:function(){return w},l:function(){return _e},m:function(){return f},o:function(){return Ct},s:function(){return Ee}});var r=i(44444),s=i(81298),n=i(55011),o=i(66435),a=i(63643),c=(i(94381),i(31061));const u=()=>r.G.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils"),l=0,h=100;function f(t,e){return[!!t?.minScale&&e.scaleToZoom(t.minScale)||l,!!t?.maxScale&&e.scaleToZoom(t.maxScale)||h]}function p(t){return 1<<t}function d(t){let e=0;for(const[i,r]of t)r&&(e|=1<<i);return e}function x(t){let e;if(!t)return[0,0,0,0];if("string"==typeof t){const i=r.h2.fromString(t);if(!i)return u().errorOnce(new r.s("mapview:mesh-processing","Unable to parse string into color",{color:t})),[0,0,0,0];e=i.toArray()}else e=t;const[i,s,n,o]=e;return[i*(o/255),s*(o/255),n*(o/255),o]}function y(t){switch(t){case"butt":case r.qw.Butt:return r.be.BUTT;case"round":case r.qw.Round:return r.be.ROUND;case"square":case r.qw.Square:return r.be.SQUARE}}function m(t){switch(t){case"bevel":case r.qx.Bevel:return r.bf.BEVEL;case"miter":case r.qx.Miter:return r.bf.MITER;case"round":case r.qx.Round:return r.bf.ROUND}}function _(t,e){return Math.round(Math.min(Math.sqrt(t*e),255))}function g(t,e){return Math.round(t*e)/e}const b=96/72;let w=class{static executeEffects(t,e,i,r){const n=b,o=(0,s.ac)(t);let a=new s.ae(e);for(const c of t){const t=(0,s.ad)(c);t&&(a=t.execute(a,c,n,i,r,o))}return a}static applyEffects(t,e,i){if(!t)return e;const n=(0,s.ac)(t);let o,a=new s.ae(s.a7.fromJSONCIM(e));for(const r of t){const t=(0,s.ad)(r);t&&(a=t.execute(a,r,1,null,i,n))}const c=[];let u=null;for(;o=a.next();)c.push(...(0,r.qy)(o)),u=o.geometryType;return 0===c.length||null===u?null:"esriGeometryPolygon"===u?{rings:c}:{paths:c}}},k=null;function v(){return k}async function S(){k=await Promise.all([i.e(6239),i.e(3270)]).then(i.bind(i,43270)).then((t=>t.g))}function P(t){switch(t){case r.aC.BYTE:case r.aC.UNSIGNED_BYTE:return 1;case r.aC.SHORT:case r.aC.UNSIGNED_SHORT:case r.aC.HALF_FLOAT:return 2;case r.aC.FLOAT:case r.aC.INT:case r.aC.UNSIGNED_INT:return 4}}function T(t){const e=[],i=[],r=[];for(const s of t){const t=P(s.type)*s.count;switch(t%2||t%4||4){case 4:e.push(s);continue;case 2:i.push(s);continue;case 1:r.push(s);continue;default:throw new Error("Found unexpected dataType byte count")}}return e.push(...i),e.push(...r),e}let C=class t{static fromVertexSpec(e,i){const{attributes:r,optionalAttributes:s}=e;let n,o,a;const c=[];for(const t in r){const e=r[t];"position"===e.pack?n={...e,name:t,offset:0}:"id"===e.pack?o={...e,name:t,offset:4}:"bitset"===t?a={...e,name:t,offset:7}:c.push({...e,name:t})}for(const t in s)if(!0===i[t]){const e=s[t];c.push({...e,name:t})}const u=T(c),l=[];let h=8,f=1;for(const t of u)l.push({...t,offset:h}),h+=P(t.type)*t.count,t.packAlternating&&(f=Math.max(t.packAlternating.count,f));const p=Uint32Array.BYTES_PER_ELEMENT,d=h%p;return new t(n,o,a,l,h+(d?p-d:0),f)}constructor(t,e,i,r,s,n){this.position=t,this.id=e,this.bitset=i,this.standardAttributes=r,this.stride=s,this.packVertexCount=n,r.push(i),this._attributes=[t,e,i,...r]}get attributeLayout(){if(!this._attributeLayout){const t=(0,a.e)(this._attributes),e=this._attributes.map((t=>({name:t.name,count:t.count,offset:t.offset,type:t.type,packPrecisionFactor:t.packPrecisionFactor,normalized:t.normalized??!1})));this._attributeLayout={attributes:e,hash:t,stride:this.stride}}return this._attributeLayout}},E=class t{static fromVertexSpec(e,i){const r=C.fromVertexSpec(e,i);return new t(r)}constructor(t){this._spec=t,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(t,e,i,r,s,n){for(let o=0;o<this._spec.packVertexCount;o++){const t=o*this._spec.stride;this._packPosition(i,r,t),this._packId(e,t);const a=this._spec.bitset;if(n){if(a.packTessellation){const e=a.packTessellation(n,s);this._pack(e,a,t)}for(const e of this._spec.standardAttributes)if(null!=e.packTessellation){const i=e.packTessellation(n,s);this._pack(i,e,t)}else if(e.packAlternating?.packTessellation){const t=e.packAlternating.packTessellation(n,s);for(let i=0;i<this._spec.packVertexCount;i++){const r=t[i];this._pack(r,e,i*this._spec.stride)}}}}t.vertexWriteRegion(this._packedU32View)}pack(t,e){for(const i of this._spec.standardAttributes)if(i.pack&&"string"!=typeof i.pack){const r=i.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++)this._pack(r,i,t*this._spec.stride)}else if(i.packAlternating?.pack){const r=i.packAlternating.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++){const e=r[t];this._pack(e,i,t*this._spec.stride)}}}_packPosition(t,e,i){const{offset:r}=this._spec.position,s=this._spec.position.packPrecisionFactor??1,n=(0,a.f)(t*s,e*s);this._dataView.setUint32(i+r,n,!0)}_packId(t,e){const i=t*(this._spec.id.packPrecisionFactor??1),r=4278190080&this._dataView.getUint32(e+this._spec.id.offset,!0);this._dataView.setUint32(e+this._spec.id.offset,i|r,!0)}_pack(t,e,i){(0,a.o)(this._dataView,t,e,i)}};function M(t){if(!t)return!1;for(const e of t)switch(e.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1}let N=class{constructor(t,e,i,r){this._instanceId=t,this._evaluator=e,this._enabledOptionalAttributes=i,this._viewParams=r,this._evaluator.evaluator=t=>this.vertexSpec.createComputedParams(t)}get _vertexPack(){if(!this._cachedVertexPack){const t=E.fromVertexSpec(this.vertexSpec,this._enabledOptionalAttributes);this._evaluator.hasDynamicProperties||t.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=t}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return!!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}setReferences(t){this._references=t}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}async loadDependencies(){M(this._evaluator.inputMeshParams.effects?.effectInfos)&&await S()}enqueueRequest(t,e,i){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(t,e,i)}write(t,e,i,r,n){this.ensurePacked(e,i,r);const o=this.evaluatedMeshParams.effects;if(!o||0===o.length)return void this._write(t,i,void 0,n);const a=i.readGeometryForDisplay()?.clone();if(!a)return;const c=s.a7.fromOptimizedCIM(a,i.geometryType),u=v();c.invertY();const l=t.id||"",h=w.executeEffects(o,c,l,u);let f;for(;f=h.next();)f.invertY(),this._write(t,i,f,n)}ensurePacked(t,e,i){if(!this._evaluator.hasDynamicProperties)return;const r=this._evaluator.evaluateMeshParams(t,e,i);this._vertexPack.pack(r,this._viewParams)}_writeVertex(t,e,i,r,s){const n=this.evaluatedMeshParams;this._vertexPack.writeVertex(t,e,i,r,n,s)}};function z(t,e,i,r,s,n,o){ct=0;const a=(r-i)*n,c=s&&s.length,u=c?(s[0]-i)*n:a;let l,h,f,p,d,x=D(e,i,r,0,u,n,!0);if(x&&x.next!==x.prev){if(c&&(x=G(e,i,r,s,x,n)),a>80*n){l=f=e[0+i*n],h=p=e[1+i*n];for(let t=n;t<u;t+=n){const r=e[t+i*n],s=e[t+1+i*n];l=Math.min(l,r),h=Math.min(h,s),f=Math.max(f,r),p=Math.max(p,s)}d=Math.max(f-l,p-h),d=0!==d?1/d:0}A(x,t,n,l,h,d,o,0)}}function D(t,e,i,r,s,n,o){let a;if(o===Z(t,e,i,r,s,n)>0)for(let c=r;c<s;c+=n)a=L(c+e*n,t[c+e*n],t[c+1+e*n],a);else for(let c=s-n;c>=r;c-=n)a=L(c+e*n,t[c+e*n],t[c+1+e*n],a);return a&&$(a,a.next)&&(R(a),a=a.next),a}function I(t,e=t){if(!t)return t;let i,r=t;do{if(i=!1,r.steiner||!$(r,r.next)&&0!==H(r.prev,r,r.next))r=r.next;else{if(R(r),r=e=r.prev,r===r.next)break;i=!0}}while(i||r!==e);return e}function A(t,e,i,r,s,n,o,a){if(!t)return;!a&&n&&(t=W(t,r,s,n));let c=t;for(;t.prev!==t.next;){const u=t.prev,l=t.next;if(n?Y(t,r,s,n):B(t))e.push(u.index/i+o),e.push(t.index/i+o),e.push(l.index/i+o),R(t),t=l.next,c=l.next;else if((t=l)===c){a?1===a?A(t=tt(t,e,i,o),e,i,r,s,n,o,2):2===a&&et(t,e,i,r,s,n,o):A(I(t),e,i,r,s,n,o,1);break}}}function B(t){const e=t.prev,i=t,r=t.next;if(H(e,i,r)>=0)return!1;let s=t.next.next;const n=s;let o=0;for(;s!==t.prev&&(0===o||s!==n);){if(o++,Q(e.x,e.y,i.x,i.y,r.x,r.y,s.x,s.y)&&H(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function Y(t,e,i,r){const s=t.prev,n=t,o=t.next;if(H(s,n,o)>=0)return!1;const a=s.x<n.x?s.x<o.x?s.x:o.x:n.x<o.x?n.x:o.x,c=s.y<n.y?s.y<o.y?s.y:o.y:n.y<o.y?n.y:o.y,u=s.x>n.x?s.x>o.x?s.x:o.x:n.x>o.x?n.x:o.x,l=s.y>n.y?s.y>o.y?s.y:o.y:n.y>o.y?n.y:o.y,h=J(a,c,e,i,r),f=J(u,l,e,i,r);let p=t.prevZ,d=t.nextZ;for(;p&&p.z>=h&&d&&d.z<=f;){if(p!==t.prev&&p!==t.next&&Q(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&H(p.prev,p,p.next)>=0||(p=p.prevZ,d!==t.prev&&d!==t.next&&Q(s.x,s.y,n.x,n.y,o.x,o.y,d.x,d.y)&&H(d.prev,d,d.next)>=0))return!1;d=d.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&Q(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&H(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&Q(s.x,s.y,n.x,n.y,o.x,o.y,d.x,d.y)&&H(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function L(t,e,i,r){const s=nt.create(t,e,i);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function R(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function G(t,e,i,r,s,n){const o=new Array;for(let a=0,c=r.length;a<c;a++){const s=D(t,e,i,r[a]*n,a<c-1?r[a+1]*n:i*n,n,!1);s===s.next&&(s.steiner=!0),o.push(F(s))}o.sort(K);for(const a of o)s=O(a,s);return s}function O(t,e){const i=U(t,e);if(!i)return e;const r=st(i,t);return I(r,r.next),I(i,i.next)}function U(t,e){let i=e;const r=t.x,s=t.y;let n,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){const t=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=r&&t>o){if(o=t,t===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n.prev;const a=n,c=n.x,u=n.y;let l,h=1/0;for(i=n.next;i!==a;)r>=i.x&&i.x>=c&&r!==i.x&&Q(s<u?r:o,s,c,u,s<u?o:r,s,i.x,i.y)&&(l=Math.abs(s-i.y)/(r-i.x),(l<h||l===h&&i.x>n.x)&&j(i,t)&&(n=i,h=l)),i=i.next;return n}function W(t,e,i,r){let s;for(;s!==t;s=s.next){if(s=s||t,null===s.z&&(s.z=J(s.x,s.y,e,i,r)),s.prev.next!==s||s.next.prev!==s)return s.prev.next=s,s.next.prev=s,W(t,e,i,r);s.prevZ=s.prev,s.nextZ=s.next}return t.prevZ.nextZ=null,t.prevZ=null,V(t)}function V(t){let e,i=1;for(;;){let r,s=t;t=null,e=null;let n=0;for(;s;){n++,r=s;let o=0;for(;o<i&&r;o++)r=r.nextZ;let a=i;for(;o>0||a>0&&r;){let i;0===o?(i=r,r=r.nextZ,a--):0!==a&&r?s.z<=r.z?(i=s,s=s.nextZ,o--):(i=r,r=r.nextZ,a--):(i=s,s=s.nextZ,o--),e?e.nextZ=i:t=i,i.prevZ=e,e=i}s=r}if(e.nextZ=null,i*=2,n<2)return t}}function H(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function q(t,e,i,r){return!!($(t,e)&&$(i,r)||$(t,r)&&$(i,e))||H(t,e,i)>0!=H(t,e,r)>0&&H(i,r,t)>0!=H(i,r,e)>0}function X(t,e){let i=t;do{if(i.index!==t.index&&i.next.index!==t.index&&i.index!==e.index&&i.next.index!==e.index&&q(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function Z(t,e,i,r,s,n){let o=0;for(let a=r,c=s-n;a<s;a+=n)o+=(t[c+e*n]-t[a+e*n])*(t[a+1+e*n]+t[c+1+e*n]),c=a;return o}function Q(t,e,i,r,s,n,o,a){return(s-o)*(e-a)-(t-o)*(n-a)>=0&&(t-o)*(r-a)-(i-o)*(e-a)>=0&&(i-o)*(n-a)-(s-o)*(r-a)>=0}function j(t,e){return H(t.prev,t,t.next)<0?H(t,e,t.next)>=0&&H(t,t.prev,e)>=0:H(t,e,t.prev)<0||H(t,t.next,e)<0}function J(t,e,i,r,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*s)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function $(t,e){return t.x===e.x&&t.y===e.y}function K(t,e){return t.x-e.x}function tt(t,e,i,r){let s=t;do{const n=s.prev,o=s.next.next;!$(n,o)&&q(n,s,s.next,o)&&j(n,o)&&j(o,n)&&(e.push(n.index/i+r),e.push(s.index/i+r),e.push(o.index/i+r),R(s),R(s.next),s=t=o),s=s.next}while(s!==t);return s}function et(t,e,i,r,s,n,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.index!==t.index&&it(a,t)){let c=st(a,t);return a=I(a,a.next),c=I(c,c.next),A(a,e,i,r,s,n,o,0),void A(c,e,i,r,s,n,o,0)}t=t.next}a=a.next}while(a!==t)}function it(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!X(t,e)&&j(t,e)&&j(e,t)&&rt(t,e)}function rt(t,e){let i=t,r=!1;const s=(t.x+e.x)/2,n=(t.y+e.y)/2;do{i.y>n!=i.next.y>n&&i.next.y!==i.y&&s<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}function st(t,e){const i=nt.create(t.index,t.x,t.y),r=nt.create(e.index,e.x,e.y),s=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,r.next=i,i.prev=r,n.next=r,r.prev=n,r}class nt{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(t,e,i){const r=ct<ot.length?ot[ct++]:new nt;return r.index=t,r.x=e,r.y=i,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r}}const ot=[],at=8096;let ct=0;for(let Me=0;Me<at;Me++)ot.push(new nt);const ut=1e-5,lt=new n.g(0,0,0,1,0),ht=new n.g(0,0,0,1,0);function ft(t,e,i){let r=0;for(let s=1;s<i;s++){const i=t[2*(e+s-1)],n=t[2*(e+s-1)+1];r+=(t[2*(e+s)]-i)*(t[2*(e+s)+1]+n)}return r}function pt(t,e,i,r,s){let n=0;const o=2;for(let a=i;a<r;a+=3){const i=(t[a]-s)*o,r=(t[a+1]-s)*o,c=(t[a+2]-s)*o;n+=Math.abs((e[i]-e[c])*(e[r+1]-e[i+1])-(e[i]-e[r])*(e[c+1]-e[i+1]))}return n}function dt(t,e){const{coords:i,lengths:r}=e,s=0,n=t;let o=0;for(let a=0;a<r.length;){let t=a,e=r[a],c=ft(i,o,e);const u=[];for(;++t<r.length;){const s=r[t],n=ft(i,o+e,s);if(!(n>0))break;c+=n,u.push(o+e),e+=s}const l=n.length;z(n,i,o,o+e,u,2,s);const h=pt(n,i,l,n.length,s),f=Math.abs(c);if(Math.abs((h-f)/Math.max(1e-7,f))>ut)return n.length=0,!1;a=t,o+=e}return!0}function xt(t){const{coords:e,lengths:i}=t,{buffer:r}=(0,o.a)(e,i);return r}function yt(t,e,i){let r=0;for(let s=0;s<t.lengths.length;s++){const n=t.lengths[s];for(let s=0;s<n;s++){const n=t.coords[2*(s+r)],o=t.coords[2*(s+r)+1];if(n<e||n>i||o<e||o>i)return!0}r+=n}return!1}function mt(t,e){if(null==t)return null;if(!yt(t,-128,r.ls+128))return t;lt.setPixelMargin(e),lt.reset(n.i.Polygon);let i=0;for(let r=0;r<t.lengths.length;r++){const e=t.lengths[r];let s=t.coords[2*(0+i)],n=t.coords[2*(0+i)+1];lt.moveTo(s,n);for(let r=1;r<e;r++)s=t.coords[2*(r+i)],n=t.coords[2*(r+i)+1],lt.lineTo(s,n);lt.close(),i+=e}const s=lt.result(!1);if(!s)return null;const o=[],a=[];for(const r of s){let t=0;for(const e of r)a.push(e.x),a.push(e.y),t++;o.push(t)}return new r.d9(o,a)}function _t(t,e){ht.setPixelMargin(e);const i=ht,s=-e,o=r.ls+e;let a=[],c=!1;if(!t.nextPath())return null;let u=!0;for(;u;){t.seekPathStart();const e=[];if(!t.pathSize)return null;i.reset(n.i.LineString),t.nextPoint();let r=t.x,l=t.y;if(c)i.moveTo(r,l);else{if(r<s||r>o||l<s||l>o){c=!0;continue}e.push({x:r,y:l})}let h=!1;for(;t.nextPoint();)if(r=t.x,l=t.y,c)i.lineTo(r,l);else{if(r<s||r>o||l<s||l>o){h=!0;break}e.push({x:r,y:l})}if(h)c=!0;else{if(c){const t=i.resultWithStarts();if(t)for(const e of t)a.push(e)}else a.push({line:e,start:0});u=t.nextPath(),c=!1}}return a=a.filter((t=>t.line.length>1)),0===a.length?null:a}lt.setExtent(r.ls),ht.setExtent(r.ls);const gt=100,bt=(0,r.Q)("featurelayer-fast-triangulation-enabled");class wt extends N{async loadDependencies(){await Promise.all([super.loadDependencies(),(0,o.i)()])}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),s=this._clip(r);s&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,s),t.recordEnd())}_clip(t){if(!t)return null;const e=this.hasEffects;return mt(t,e?256:8)}_writeGeometry(t,e,i){const r=i.maxLength>gt,s=[],n=this.createTesselationParams(e);if(!r&&bt&&dt(s,i))return void(s.length&&this._writeVertices(t,e,i.coords,n,s));const o=xt(i);this._writeVertices(t,e,o,n)}_writeVertices(t,e,i,r,s){const n=e.getDisplayId(),o=t.vertexCount(),a=this.hasEffects;let c=0;if(s)for(const u of s){const e=i[2*u],s=i[2*u+1];a&&t.recordBounds(e,s,0,0),this._writeVertex(t,n,e,s,r),c++}else for(let u=0;u<i.length;u+=2){const e=Math.round(i[u]),s=Math.round(i[u+1]);a&&t.recordBounds(e,s,0,0),this._writeVertex(t,n,e,s,r),c++}t.indexEnsureSize(c);for(let u=0;u<c;u++)t.indexWrite(u+o)}}const kt={createComputedParams:t=>t,optionalAttributes:{},attributes:{id:{type:r.aC.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:r.aC.UNSIGNED_BYTE,count:1},pos:{type:r.aC.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:r.aC.FLOAT,count:1,packTessellation:({inverseArea:t})=>t}}};let vt=class extends wt{constructor(){super(...arguments),this.vertexSpec=kt}createTesselationParams(t){return{inverseArea:1/t.readGeometryArea()}}};const St={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:r.aC.SHORT,count:2,packPrecisionFactor:r.na,pack:({scaleInfo:t},{tileInfo:e})=>f(t,e)}},attributes:{id:{type:r.aC.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:r.aC.UNSIGNED_BYTE,count:1},pos:{type:r.aC.SHORT,count:2,pack:"position",packPrecisionFactor:10},color:{type:r.aC.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>x(t)}}};let Pt=class extends wt{constructor(){super(...arguments),this.vertexSpec=St}createTesselationParams(t){return null}};const Tt={createComputedParams:t=>t,optionalAttributes:St.optionalAttributes,attributes:{...St.attributes,tlbr:{count:4,type:r.aC.UNSIGNED_SHORT,pack:({sprite:t})=>{const{rect:e,width:i,height:s}=t,n=e.x+r.aP,o=e.y+r.aP;return[n,o,n+i,o+s]}},inverseRasterizationScale:{count:1,type:r.aC.BYTE,packPrecisionFactor:16,pack:({sprite:t})=>1/t.rasterizationScale}}};let Ct=class extends Pt{constructor(){super(...arguments),this.vertexSpec=Tt}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),s=this._clip(r);if(!s)return;const n=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,n),this._writeGeometry(t,e,s),t.recordEnd()}};function Et(t){const{sprite:e,aspectRatio:i,scaleProportionally:s}=t,n=(0,r.d2)(t.height),o=n>0?n:e.height;let a=n*i;return a<=0?a=e.width:s&&(a*=e.width/e.height),{width:a,height:o}}function Mt(t){const{applyRandomOffset:e,sampleAlphaOnly:i}=t;return d([[s.af,e],[s.ag,i]])}const Nt={createComputedParams:t=>t,optionalAttributes:Tt.optionalAttributes,attributes:{...Tt.attributes,bitset:{count:1,type:r.aC.UNSIGNED_BYTE,pack:Mt},width:{count:1,type:r.aC.HALF_FLOAT,pack:t=>Et(t).width},height:{count:1,type:r.aC.HALF_FLOAT,pack:t=>Et(t).height},offset:{count:2,type:r.aC.HALF_FLOAT,pack:({offsetX:t,offsetY:e})=>[(0,r.d2)(t),-(0,r.d2)(e)]},scale:{count:2,type:r.aC.UNSIGNED_BYTE,packPrecisionFactor:16,pack:({scaleX:t,scaleY:e})=>[t,e]},angle:{count:1,type:r.aC.UNSIGNED_BYTE,pack:({angle:t})=>(0,n.l)(t)}}};let zt=class extends Ct{constructor(){super(...arguments),this.vertexSpec=Nt}},Dt=class{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0}};const It={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:r.aC.SHORT,count:2,packPrecisionFactor:r.na,pack:({scaleInfo:t},{tileInfo:e})=>f(t,e)}},attributes:{id:{type:r.aC.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:r.aC.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:r.aC.UNSIGNED_BYTE,count:1},color:{type:r.aC.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>x(t)},offset:{type:r.aC.BYTE,count:2,packPrecisionFactor:16,packTessellation:({extrusionOffsetX:t,extrusionOffsetY:e})=>[g(t,16),g(e,16)]},normal:{type:r.aC.BYTE,count:2,packPrecisionFactor:16,packTessellation:({normalX:t,normalY:e})=>[g(t,16),g(e,16)]},halfWidth:{type:r.aC.HALF_FLOAT,count:1,pack:({width:t})=>(0,r.d2)(.5*t)},referenceHalfWidth:{type:r.aC.HALF_FLOAT,count:1,pack:({referenceWidth:t})=>(0,r.d2)(.5*t)}}};let At=class{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0}};const Bt=65535;let Yt=class extends N{constructor(t,e,i,r){super(t,e,i,r),this.vertexSpec=It,this._currentWrite=new At,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:Bt,textured:!1},this._tessParams=new Dt,this._initializeTessellator()}writeLineVertices(t,e,i){const r=this._getLines(e);null!=r&&this._writeVertices(t,i,r)}_initializeTessellator(){this._lineTessellator=new o.c(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0)}_write(t,e,i){const r=i??s.a7.fromFeatureSetReaderCIM(e);r&&this._writeGeometry(t,e,r)}_writeGeometry(t,e,i,r){t.recordStart(this.instanceId,this.attributeLayout,r),this.writeLineVertices(t,i,e),t.recordEnd()}_getLines(t){return _t(t,(0,a.g)(this.evaluatedMeshParams))}_writeVertices(t,e,i){const{_currentWrite:s,_tessellationOptions:n,evaluatedMeshParams:o}=this,{width:a,capType:c,joinType:u,miterLimit:l,hasSizeVV:h}=o,f=(0,r.d2)(.5*a);n.halfWidth=f,n.capType=y(c),n.joinType=m(u),n.miterLimit=l;const p=!h;s.out=t,s.id=e.getDisplayId(),s.vertexCount=0,s.indexCount=0,s.vertexFrom=t.vertexCount(),s.vertexBounds=p&&f<r.fH?0:1;for(const{line:r,start:d}of i)n.initialDistance=d%Bt,this._lineTessellator.tessellate(r,n,p)}_writeTesselatedVertex(t,e,i,r,s,n,o,a,c,u,l){const{out:h,id:f,vertexBounds:p}=this._currentWrite;return this.hasEffects&&h.recordBounds(t,e,p,p),this._tessParams.extrusionOffsetX=o,this._tessParams.extrusionOffsetY=a,this._tessParams.normalX=c,this._tessParams.normalY=u,this._tessParams.directionX=s,this._tessParams.directionY=n,this._tessParams.distance=l,this._writeVertex(h,f,t,e,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(t,e,i){const{out:r}=this._currentWrite;r.indexEnsureSize(3),r.indexWrite(t),r.indexWrite(e),r.indexWrite(i),this._currentWrite.indexCount+=3}};const Lt={createComputedParams:t=>t,optionalAttributes:It.optionalAttributes,attributes:{...It.attributes,bitset:{type:r.aC.UNSIGNED_BYTE,count:1,pack:t=>0},color:{type:r.aC.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>x(t)}}},Rt={createComputedParams:t=>t,optionalAttributes:It.optionalAttributes,attributes:{...It.attributes,bitset:{type:r.aC.UNSIGNED_BYTE,count:1,pack:t=>d([[s.ah,!0]])},color:{type:r.aC.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:t})=>x(t)}}};let Ft=class extends Yt{constructor(){super(...arguments),this.vertexSpec=Rt}},Gt=class extends Pt{constructor(t,e,i,r){super(t,e,i,r),this.vertexSpec=Lt,this._lineMeshWriter=this._createOutlineWriter(t,e,i,r)}_createOutlineWriter(t,e,i,r){return new Ft(t,e,i,r)}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(r);n&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,n),this._lineMeshWriter.writeLineVertices(t,s.a7.fromOptimizedCIM(n,"esriGeometryPolyline"),e),t.recordEnd())}_clip(t){return t?mt(t,(0,a.g)(this.evaluatedMeshParams)):null}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}};const Ot=Nt,Ut=Rt,Wt={createComputedParams:t=>t,optionalAttributes:Ot.optionalAttributes,attributes:{...Ot.attributes,bitset:{type:r.aC.UNSIGNED_BYTE,count:1,pack:t=>Mt(t)},aux1:{count:1,type:r.aC.HALF_FLOAT,pack:t=>Et(t).width},aux2:{count:1,type:r.aC.HALF_FLOAT,pack:t=>Et(t).height},aux3:{count:2,type:r.aC.HALF_FLOAT,pack:({offsetX:t,offsetY:e})=>[(0,r.d2)(t),(0,r.d2)(e)]},aux4:{count:2,type:r.aC.UNSIGNED_BYTE,pack:({scaleX:t,scaleY:e})=>[t*s.ai,e*s.ai]}}},Vt={createComputedParams:t=>t,optionalAttributes:Ot.optionalAttributes,attributes:{...Ot.attributes,color:Ut.attributes.color,bitset:{type:r.aC.UNSIGNED_BYTE,count:1,pack:t=>d([[s.ah,!0]])},aux1:{count:1,type:r.aC.HALF_FLOAT,pack:t=>(0,r.d2)(.5*t.width)},aux2:{count:1,type:r.aC.HALF_FLOAT,pack:t=>(0,r.d2)(.5*t.referenceWidth)},aux3:{count:2,type:r.aC.HALF_FLOAT,packTessellation:({extrusionOffsetX:t,extrusionOffsetY:e})=>[t,e]},aux4:{count:2,type:r.aC.UNSIGNED_BYTE,packTessellation:({normalX:t,normalY:e})=>[t*s.ai+s.aj,e*s.ai+s.aj]}}};class Ht extends Ft{constructor(){super(...arguments),this.vertexSpec=Vt}}let qt=class extends Gt{constructor(){super(...arguments),this.vertexSpec=Wt}_createOutlineWriter(t,e,i,r){return new Ht(t,e,i,r)}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(r);if(!n)return;const o=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,o),this._writeGeometry(t,e,n),this._lineMeshWriter.writeLineVertices(t,s.a7.fromOptimizedCIM(n,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}};const Xt={optionalAttributes:Tt.optionalAttributes,createComputedParams:t=>t,attributes:{...Tt.attributes,...Lt.attributes}},Zt={optionalAttributes:Tt.optionalAttributes,createComputedParams:t=>t,attributes:{...Tt.attributes,...Rt.attributes}};class Qt extends Ft{constructor(){super(...arguments),this.vertexSpec=Zt}}class jt extends Gt{constructor(){super(...arguments),this.vertexSpec=Xt}_createOutlineWriter(t,e,i,r){return new Qt(t,e,i,r)}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(r);if(!n)return;const o=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,o),this._writeGeometry(t,e,n),this._lineMeshWriter.writeLineVertices(t,s.a7.fromOptimizedCIM(n,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}const Jt={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:r.aC.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:r.aC.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:r.aC.UNSIGNED_BYTE,count:1},offset:{type:r.aC.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};let $t=class extends N{constructor(){super(...arguments),this.vertexSpec=Jt}_write(t,e){t.recordStart(this.instanceId,this.attributeLayout);const i=e.getDisplayId();if("esriGeometryPoint"===e.geometryType){const r=e.readXForDisplay(),s=e.readYForDisplay();this._writeQuad(t,i,r,s)}else"esriGeometryMultipoint"===e.geometryType&&e.readGeometryForDisplay()?.forEachVertex(((e,r)=>{e>=0&&e<=512&&r>=0&&r<=512&&this._writeQuad(t,i,e,r)}));t.recordEnd()}_writeQuad(t,e,i,r){const s=t.vertexCount();this._writeVertex(t,e,i,r),t.indexWrite(s+0),t.indexWrite(s+1),t.indexWrite(s+2),t.indexWrite(s+1),t.indexWrite(s+3),t.indexWrite(s+2)}};class Kt{static getPlacement(t,e,i,r,n,o){const a=(0,s.ak)(i);return a?(-1===e&&t.invertY(),a.execute(t,i,r,n,o)):null}}const te=96;class ee{constructor(t){const{offsetX:e,offsetY:i,postAngle:s,fontSize:n,haloSize:o,outlineSize:a,scaleFactor:c,transforms:u}=t;if(this.offsetX=e,this.offsetY=i,this.postAngle=s,this.fontSize=Math.min(n,te),this.haloSize=o??0,this.outlineSize=a??0,this.transforms=u,u&&u.infos.length>1){const t=(0,r.qz)(n,s,!1,e,i,u,!1);this.fontSize=Math.min(t.size,te);const o=t.size/n;this.haloSize*=o,this.outlineSize*=o,this.postAngle=t.rotation,this.offsetX=t.offsetX,this.offsetY=t.offsetY}c&&(this.fontSize*=c,this.offsetX*=c,this.offsetY*=c)}}const ie=28,re=[4,4],se=[16,4],ne={topLeft:se,topRight:se,bottomLeft:se,bottomRight:se},oe=[4,2],ae=[4,6],ce={topLeft:oe,topRight:oe,bottomLeft:ae,bottomRight:ae},ue={topLeft:oe,topRight:ae,bottomLeft:oe,bottomRight:ae},le={topLeft:ae,topRight:ae,bottomLeft:re,bottomRight:re},he={topLeft:re,topRight:re,bottomLeft:ae,bottomRight:ae},fe={topLeft:ae,topRight:re,bottomLeft:ae,bottomRight:re},pe={topLeft:re,topRight:ae,bottomLeft:re,bottomRight:ae},de={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:r.aC.UNSIGNED_SHORT,count:2,packPrecisionFactor:r.na,packTessellation:({minZoom:t,maxZoom:e})=>[t||0,e||ie]},clipAngle:{type:r.aC.UNSIGNED_BYTE,count:1,packTessellation:({clipAngle:t})=>ye(t||0)},referenceSymbol:{type:r.aC.BYTE,count:4,packPrecisionFactor:1,packTessellation:(t,e)=>{const i=t.isLineLabel||!t.referenceBounds,n=(0,s.al)(i?"center":e.horizontalAlignment),o=(0,s.am)(i?"middle":e.verticalAlignment),{offsetX:a,offsetY:c,size:u}=i?{offsetX:0,offsetY:0,size:0}:t.referenceBounds;return[(0,r.d2)(a),-(0,r.d2)(c),Math.round((0,r.d2)(u)),n+1<<2|o+1]}}},attributes:{pos:{type:r.aC.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:r.aC.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:r.aC.UNSIGNED_BYTE,count:1,packTessellation:({isBackground:t,mapAligned:e})=>d([[s.an,t],[s.ao,!!e]])},offset:{type:r.aC.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:({offsets:t})=>{const{bottomLeft:e,bottomRight:i,topLeft:r,topRight:s}=t;return[r,s,e,i]}}},textureUV:{type:r.aC.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:({texcoords:t})=>{const{bottomLeft:e,bottomRight:i,topLeft:r,topRight:s}=t;return[r,s,e,i]}}},color:{type:r.aC.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:({color:t})=>t},fontSize:{type:r.aC.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:({fontSize:t})=>Math.round((0,r.d2)(t))},referenceSize:{type:r.aC.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:({fontSize:t},{referenceSize:e})=>Math.round((0,r.d2)(e??t))},outlineColor:{type:r.aC.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:t})=>x(t)},haloColor:{type:r.aC.UNSIGNED_BYTE,count:4,normalized:!0,pack:({haloColor:t})=>x(t)},outlineAndHaloSize:{type:r.aC.UNSIGNED_SHORT,count:2,packPrecisionFactor:4,packTessellation:({outlineSize:t,haloSize:e})=>[Math.round((0,r.d2)(t)),Math.round((0,r.d2)(e))]}}};class xe extends N{constructor(){super(...arguments),this.vertexSpec=de,this._textMeshParamsPropsInitialized=!1}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new ee(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0)}_write(t,e,i){const r=this._getShaping();if(!r)return;const s=e.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(t,e,r,i);if(i?.nextPath())return i.nextPoint(),this._writeGlyphs(t,s,i.x,i.y,r,0);if("esriGeometryPolygon"===e.geometryType){const i=e.readCentroidForDisplay();if(!i)return;const[n,o]=i.coords;return this._writeGlyphs(t,s,n,o,r,0)}if("esriGeometryMultipoint"===e.geometryType)return void e.readGeometryForDisplay()?.forEachVertex(((e,i)=>this._writeGlyphs(t,s,e,i,r,0)));const n=e.readXForDisplay(),o=e.readYForDisplay();return this._writeGlyphs(t,s,n,o,r,0)}_writePlacedTextMarkers(t,e,i,n){const o=n??s.a7.fromFeatureSetReaderCIM(e);if(!o)return;const a=-1,c=Kt.getPlacement(o,a,this.evaluatedMeshParams.placement,(0,r.d2)(1),t.id,v());if(!c)return;const u=e.getDisplayId();let l=c.next();for(;null!=l;){const e=l.tx,r=-l.ty,s=-l.getAngle();this._writeGlyphs(t,u,e,r,i,s),l=c.next()}}_getShaping(t){const e=this._textMeshTransformProps,i=this.evaluatedMeshParams;if(!i.glyphs?.glyphs.length)return null;const n=(0,r.d2)(e.fontSize),o=(0,r.d2)(e.offsetX),a=(0,r.d2)(e.offsetY),c=(0,r.b0)((0,r.d2)(i.lineWidth),r.qB,r.qA),u=r.qC*(0,r.b0)(i.lineHeightRatio,.25,4);return(0,s.ap)(i.glyphs,{scale:n/r.qD,angle:e.postAngle,xOffset:o,yOffset:a,horizontalAlignment:i.horizontalAlignment,verticalAlignment:t||i.verticalAlignment,maxLineWidth:c,lineHeight:u,decoration:i.decoration,borderLineSizePx:(0,r.d2)(i.boxBorderLineSize),hasBackground:!!i.boxBackgroundColor,useCIMAngleBehavior:i.useCIMAngleBehavior})}_writeGlyphs(t,e,i,s,n,o,a,c){const u=this.evaluatedMeshParams,l=this._textMeshTransformProps,h=(0,r.d2)(l.fontSize),p=l.haloSize,d=l.outlineSize,y=(0,r.d2)(l.offsetX),m=(0,r.d2)(l.offsetY),[_,g]=f(u.scaleInfo,this.getTileInfo());0!==o&&n.setRotation(o);const b=n.bounds,w=i+b.x+y,k=s+b.y-m,v=2*(u.minPixelBuffer?u.minPixelBuffer/h:1),S=Math.max(b.width,b.height)*v;n.textBox&&(t.recordStart(this.instanceId,this.attributeLayout,n.glyphs[0].textureBinding),t.recordBounds(w,k,S,S),this._writeTextBox(t,e,i,s,n.textBox,a,c),t.recordEnd());for(const r of n.glyphs){t.recordStart(this.instanceId,this.attributeLayout,r.textureBinding),t.recordBounds(w,k,S,S);const{texcoords:n,offsets:o}=r;this._writeQuad(t,e,i,s,{texcoords:n,offsets:o,fontSize:h,haloSize:p,outlineSize:d,color:x(u.color),isBackground:!1,referenceBounds:a,minZoom:_,maxZoom:g,...c}),t.recordEnd()}0!==o&&n.setRotation(-o)}_writeTextBox(t,e,i,r,s,n,o){const a=this.evaluatedMeshParams,{fontSize:c,haloSize:u,outlineSize:l}=this._textMeshTransformProps,{boxBackgroundColor:h,boxBorderLineColor:f}=a,p={isBackground:!0,fontSize:c,haloSize:u,outlineSize:l,referenceBounds:n,...o};h&&(this._writeQuad(t,e,i,r,{texcoords:ne,offsets:s.main,color:x(h),...p}),f||(this._writeQuad(t,e,i,r,{texcoords:le,offsets:s.top,color:x(h),...p}),this._writeQuad(t,e,i,r,{texcoords:he,offsets:s.bot,color:x(h),...p}),this._writeQuad(t,e,i,r,{texcoords:fe,offsets:s.left,color:x(h),...p}),this._writeQuad(t,e,i,r,{texcoords:pe,offsets:s.right,color:x(h),...p}))),f&&(this._writeQuad(t,e,i,r,{texcoords:ce,offsets:s.top,color:x(f),...p}),this._writeQuad(t,e,i,r,{texcoords:ce,offsets:s.bot,color:x(f),...p}),this._writeQuad(t,e,i,r,{texcoords:ue,offsets:s.left,color:x(f),...p}),this._writeQuad(t,e,i,r,{texcoords:ue,offsets:s.right,color:x(f),...p}))}_writeQuad(t,e,i,r,s){const n=t.vertexCount();this._writeVertex(t,e,i,r,s),t.indexWrite(n+0),t.indexWrite(n+1),t.indexWrite(n+2),t.indexWrite(n+1),t.indexWrite(n+3),t.indexWrite(n+2)}}const ye=t=>Math.round(t*(254/360)),me={createComputedParams:t=>t,optionalAttributes:It.optionalAttributes,attributes:{...It.attributes,bitset:{type:r.aC.UNSIGNED_BYTE,count:1,pack:({shouldSampleAlphaOnly:t,shouldScaleDash:e,isSDF:i})=>d([[s.ag,t],[s.aq,e],[s.ar,i]])},tlbr:{type:r.aC.UNSIGNED_SHORT,count:4,pack:({sprite:t})=>{const{rect:e,width:i,height:s}=t,n=e.x+r.aP,o=e.y+r.aP;return[n,o,n+i,o+s]}},accumulatedDistance:{type:r.aC.UNSIGNED_SHORT,count:1,packTessellation:({distance:t})=>t},segmentDirection:{type:r.aC.BYTE,count:2,packPrecisionFactor:16,packTessellation:({directionX:t,directionY:e})=>[t,e]},offsetAlongLine:{type:r.aC.HALF_FLOAT,count:1,pack:({offsetAlongLine:t})=>(0,r.d2)(t)},capType:{type:r.aC.UNSIGNED_BYTE,count:1,pack:({capType:t})=>{switch(t){case r.qw.Butt:case"butt":return 0;case r.qw.Square:case"square":return 1;case r.qw.Round:case"round":return 2;default:return 0}}}}};class _e extends Yt{constructor(t,e,i,r){super(t,e,i,r),this.vertexSpec=me,this._tessellationOptions.textured=!0}_write(t,e,i){const r=i??s.a7.fromFeatureSetReaderCIM(e);if(!r)return;const{sprite:n}=this.evaluatedMeshParams;this._writeGeometry(t,e,r,n?.textureBinding)}}let ge=class t{static from(t){return"width"in t?this.fromSimpleMeshParams(t):this.fromComplexMeshParams(t)}static fromSimpleMeshParams(e){const i=new t(e.sprite,e.color,e.outlineColor,e.minPixelBuffer,e.placement,e.scaleInfo,e.effects),{type:s,width:n,height:o,angle:a,alignment:c,outlineSize:u,referenceSize:l,sprite:h,overrideOutlineColor:f}=e;return i.rawWidth=(0,r.d2)(n),i.rawHeight=(0,r.d2)(o),i.angle=a,i.alignment=c,i.outlineSize=(0,r.d2)(u),i.referenceSize=(0,r.d2)(l),i.overrideOutlineColor=f,i.offsetX=(0,r.d2)(e.offsetX),i.offsetY=(0,r.d2)(e.offsetY),"simple"!==s||h.sdf||(i.rawWidth=h.width,i.rawHeight=h.height),i._computeSize(e,!1),i}static fromComplexMeshParams(e){const i=new t(e.sprite,e.color,e.outlineColor,e.minPixelBuffer,e.placement,e.scaleInfo,e.effects);let{alignment:s,transforms:n,size:o,scaleX:a,anchorX:c,anchorY:u,angle:l,colorLocked:h,frameHeight:f,widthRatio:p,offsetX:d,offsetY:x,outlineSize:y,referenceSize:m,scaleFactor:_,sizeRatio:g,isAbsoluteAnchorPoint:b,rotateClockwise:w,scaleSymbolsProportionally:k,sprite:v}=e;if(n&&n.infos.length>0){const t=(0,r.qz)(o,l,w,d,x,n);o=t.size,l=t.rotation,d=t.offsetX,x=t.offsetY,w=!1}_&&(o*=_,d*=_,x*=_);const S=a*(v.width/v.height);i.alignment=s,i.rawHeight=(0,r.d2)(o),i.rawWidth=i.rawHeight*S,i.referenceSize=(0,r.d2)(m),i.sizeRatio=g,i.sdfDecodeCoeff=(v.sdfDecodeCoeff??1)*g,i.angle=l,i.rotateClockwise=w,i.anchorX=c,i.anchorY=u,i.offsetX=(0,r.d2)(d),i.offsetY=(0,r.d2)(x),b&&o&&(v.sdf?i.anchorX=c/(o*p):i.anchorX=c/(o*S),i.anchorY=u/o);const P=k&&f?o/f:1;return i.outlineSize=0===y||isNaN(y)?0:(0,r.d2)(y)*P,i.scaleSymbolsProportionally=k,i.colorLocked=h,i._computeSize(e,!0),i}constructor(t,e,i,s,n,o,a){this.sprite=t,this.color=e,this.outlineColor=i,this.minPixelBuffer=s,this.placement=n,this.scaleInfo=o,this.effects=a,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.sdfDecodeCoeff=1,this.alignment=r.qE.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0}get boundsInfo(){return{size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(t,e){const{sprite:i,hasSizeVV:s}=t,n=!!i.sdf,o=i.sdfPaddingRatio??.5,{rawWidth:a,rawHeight:c,sizeRatio:u,outlineSize:l}=this,h=u*(n?1/(1-o):1),f=a*h,p=c*h;if(n&&!s){const t=e&&a>c?f:a,i=c,r=l+2;this.computedWidth=Math.min(t+r,f),this.computedHeight=Math.min(i+r,p)}else this.computedWidth=f,this.computedHeight=p;const d=n?Math.max(i.width,i.height)/Math.max(f,p):1,x=.5*(f-this.computedWidth)*d,y=.5*(p-this.computedHeight)*d,m=i.rect.x+r.aP+x,_=i.rect.y+r.aP+y,g=m+i.width-2*x,b=_+i.height-2*y;this.texXmin=Math.floor(m),this.texYmin=Math.floor(_),this.texXmax=Math.ceil(g),this.texYmax=Math.ceil(b),this.computedWidth*=(this.texXmax-this.texXmin)/(g-m),this.computedHeight*=(this.texYmax-this.texYmin)/(b-_),this.anchorX*=f/this.computedWidth,this.anchorY*=p/this.computedHeight}};const be=3.14159265359/180,we=128/Math.PI;function ke(t,e){return t%=e,Math.abs(t>=0?t:t+e)}function ve(t){return ke(t*we,256)}function Se(t,e,i,s,n=!1){const o=(0,r.nc)(),a=n?1:-1;return(0,r.qG)(o),(e||i)&&(0,r.nd)(o,o,[e,-i]),s&&(0,r.qH)(o,o,a*be*-s),o}const Pe={createComputedParams:t=>ge.from(t),optionalAttributes:{zoomRange:{type:r.aC.SHORT,count:2,packPrecisionFactor:r.na,pack:({scaleInfo:t},{tileInfo:e})=>f(t,e)}},attributes:{pos:{type:r.aC.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:r.aC.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:r.aC.UNSIGNED_BYTE,count:1,pack:({sprite:t,alignment:e,scaleSymbolsProportionally:i,overrideOutlineColor:n,colorLocked:o})=>{let a=0;return t.sdf&&(a|=p(s.o.bitset.isSDF)),e===r.qE.MAP&&(a|=p(s.o.bitset.isMapAligned)),i&&(a|=p(s.o.bitset.scaleSymbolsProportionally)),n&&(a|=p(s.o.bitset.overrideOutlineColor)),o&&(a|=p(s.o.bitset.colorLocked)),a}},offset:{type:r.aC.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({angle:t,computedWidth:e,computedHeight:i,anchorX:s,anchorY:n,offsetX:o,offsetY:a,rotateClockwise:c})=>{const u=Se(0,o,a,-t,c),l=-(.5+s)*e,h=-(.5-n)*i,f=[l,h],p=[l+e,h],d=[l,h+i],x=[l+e,h+i];return(0,r.qF)(f,f,u),(0,r.qF)(p,p,u),(0,r.qF)(d,d,u),(0,r.qF)(x,x,u),[f,p,d,x]}}},textureUV:{type:r.aC.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({texXmax:t,texXmin:e,texYmax:i,texYmin:r})=>[[e,r],[t,r],[e,i],[t,i]]}},color:{type:r.aC.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>x(t)},outlineColor:{type:r.aC.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:t})=>x(t)},sizing:{type:r.aC.UNSIGNED_BYTE,count:4,pack:({rawWidth:t,rawHeight:e,outlineSize:i,referenceSize:r})=>{const s=Math.max(t,e);return[_(s,128),_(i,128),_(r,128),0]}},placementAngle:{type:r.aC.UNSIGNED_BYTE,count:1,packTessellation:({placementAngle:t})=>ve(t)},sdfDecodeCoeff:{type:r.aC.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:({sdfDecodeCoeff:t})=>t}}};class Te extends N{constructor(){super(...arguments),this.vertexSpec=Pe}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(t,e,i){const r=this.evaluatedMeshParams.sprite?.textureBinding,s=e.getDisplayId();t.recordStart(this.instanceId,this.attributeLayout,r);const n=this.evaluatedMeshParams.minPixelBuffer,o=Math.max(this.evaluatedMeshParams.computedWidth,n),a=Math.max(this.evaluatedMeshParams.computedHeight,n),u=-this.evaluatedMeshParams.anchorX*this.evaluatedMeshParams.computedWidth,l=this.evaluatedMeshParams.anchorY*this.evaluatedMeshParams.computedHeight,h=this.evaluatedMeshParams.offsetX+u,f=-this.evaluatedMeshParams.offsetY+l;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(t,e,i,o,a);else if(i?.nextPath()){i.nextPoint();const e=i.x,r=i.y;t.recordBounds(e+h,r+f,o,a),this._writeQuad(t,s,e,r)}else if("esriGeometryPolygon"===e.geometryType){const i=e.readCentroidForDisplay();if(!i)return;const[r,n]=i.coords;t.recordBounds(r+h,n+f,o,a),this._writeQuad(t,s,r,n)}else if("esriGeometryPoint"===e.geometryType){const i=e.readXForDisplay(),r=e.readYForDisplay();t.recordBounds(i+h,r+f,o,a),this._writeQuad(t,s,i,r)}else e.readGeometryForDisplay()?.forEachVertex(((e,i)=>{t.recordBounds(e+h,i+f,o,a),Math.abs(e)>c.e||Math.abs(i)>c.e||this._writeQuad(t,s,e,i)}));t.recordEnd()}_writePlacedMarkers(t,e,i,n,o){const a=i??s.a7.fromFeatureSetReaderCIM(e)?.clone();if(!a)return;const u=-1,l=Kt.getPlacement(a,u,this.evaluatedMeshParams.placement,(0,r.d2)(1),t.id,v());if(!l)return;const h=e.getDisplayId();let f=l.next();const p=this.evaluatedMeshParams.offsetX,d=-this.evaluatedMeshParams.offsetY;for(;null!=f;){const e=f.tx,i=-f.ty;if(Math.abs(e)>c.e||Math.abs(i)>c.e){f=l.next();continue}const r=-f.getAngle();t.recordBounds(e+p,i+d,n,o),this._writeQuad(t,h,e,i,r),f=l.next()}}_writeQuad(t,e,i,r,s){const n=t.vertexCount(),o=null==s?null:{placementAngle:s};this._writeVertex(t,e,i,r,o),t.indexWrite(n+0),t.indexWrite(n+1),t.indexWrite(n+2),t.indexWrite(n+1),t.indexWrite(n+3),t.indexWrite(n+2)}}const Ce={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:r.aC.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:r.aC.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:r.aC.UNSIGNED_BYTE,count:1,pack:t=>0},offset:{type:r.aC.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:({size:t})=>{const e=(0,r.d2)(t),i=-e/2,s=-e/2;return[[i,s],[i+e,s],[i,s+e],[i+e,s+e]]}}},texCoords:{type:r.aC.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:r.aC.UNSIGNED_BYTE,count:2,pack:({size:t})=>[t,t]},referenceSize:{type:r.aC.UNSIGNED_BYTE,count:1,pack:({size:t})=>(0,r.d2)(t)},zoomRange:{type:r.aC.UNSIGNED_BYTE,count:2,pack:({scaleInfo:t},{tileInfo:e})=>f(t,e)}}};class Ee extends N{constructor(){super(...arguments),this.vertexSpec=Ce}_write(t,e){const i=e.getDisplayId(),s=this.evaluatedMeshParams.minPixelBuffer,n=Math.max((0,r.d2)(this.evaluatedMeshParams.size),s);let o,a;if("esriGeometryPoint"===e.geometryType)o=e.readXForDisplay(),a=e.readYForDisplay();else{const t=e.readCentroidForDisplay();if(!t)return;o=t?.coords[0],a=t?.coords[1]}t.recordStart(this.instanceId,this.attributeLayout),t.recordBounds(o,a,n,n);const c=t.vertexCount();this._writeVertex(t,i,o,a),t.indexWrite(c+0),t.indexWrite(c+1),t.indexWrite(c+2),t.indexWrite(c+1),t.indexWrite(c+3),t.indexWrite(c+2),t.recordEnd()}}},66435:function(t,e,i){i.d(e,{a:function(){return u},c:function(){return b},i:function(){return a}});var r=i(44444);const s=128e3;let n=null,o=null;async function a(){return n||(n=c()),n}async function c(){o=await((0,r.Q)("esri-csp-restrictions")?await i.e(5584).then(i.bind(i,85584)).then((t=>t.l)):await i.e(3423).then(i.bind(i,3423)).then((t=>t.l))).default({locateFile:t=>(0,r.fG)(`esri/core/libs/libtess/${t}`)})}function u(t,e){const i=Math.max(t.length,s);return o.triangulate(t,e,i)}function l(t,e){return t.x===e.x&&t.y===e.y}function h(t){if(!t)return;const e=t.length;if(e<=1)return;let i=0;for(let r=1;r<e;r++)l(t[r],t[i])||++i===r||(t[i]=t[r]);t.length=i+1}function f(t,e){return t.x=e.y,t.y=-e.x,t}function p(t,e){return t.x=-e.y,t.y=e.x,t}function d(t,e){return t.x=e.x,t.y=e.y,t}function x(t,e){return t.x=-e.x,t.y=-e.y,t}function y(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function m(t,e){return t.x*e.y-t.y*e.x}function _(t,e){return t.x*e.x+t.y*e.y}function g(t,e,i,r){return t.x=e.x*i+e.y*r,t.y=e.x*r-e.y*i,t}class b{constructor(t,e,i){this._writeVertex=t,this._writeTriangle=e,this._canUseThinTessellation=i,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(t,e,i=this._canUseThinTessellation){h(t),i&&e.halfWidth<r.fH&&!e.offset?this._tessellateThin(t,e):this._tessellate(t,e)}_tessellateThin(t,e){if(t.length<2)return;const i=e.wrapDistance||65535;let r=e.initialDistance||0,s=!1,n=t[0].x,o=t[0].y;const a=t.length;for(let c=1;c<a;++c){s&&(s=!1,r=0);let e=t[c].x,a=t[c].y,u=e-n,l=a-o,h=Math.sqrt(u*u+l*l);if(u/=h,l/=h,r+h>i){s=!0;const t=(i-r)/h;h=i-r,e=(1-t)*n+t*e,a=(1-t)*o+t*a,--c}const f=this._writeVertex(n,o,0,0,u,l,l,-u,0,-1,r),p=this._writeVertex(n,o,0,0,u,l,-l,u,0,1,r);r+=h;const d=this._writeVertex(e,a,0,0,u,l,l,-u,0,-1,r),x=this._writeVertex(e,a,0,0,u,l,-l,u,0,1,r);this._writeTriangle(f,p,d),this._writeTriangle(p,d,x),n=e,o=a}}_tessellate(t,e){const i=t[0],s=t[t.length-1],n=l(i,s),o=n?3:2;if(t.length<o)return;const a=e.pixelCoordRatio,c=null!=e.capType?e.capType:r.be.BUTT,u=null!=e.joinType?e.joinType:r.bf.MITER,h=null!=e.miterLimit?Math.min(e.miterLimit,4):2,b=null!=e.roundLimit?Math.min(e.roundLimit,1.05):1.05,w=null!=e.halfWidth?e.halfWidth:2,k=!!e.textured;let v,S,P,T=null;const C=this._prevNormal,E=this._nextNormal;let M=-1,N=-1;const z=this._joinNormal;let D,I;const A=this._textureNormalLeft,B=this._textureNormalRight,Y=this._textureNormal;let L=-1,R=-1;const F=e.wrapDistance||65535;let G=e.initialDistance||0;const O=this._writeVertex,U=this._writeTriangle,W=(t,e,i,r,s,n)=>{const o=O(S,P,D,I,i,r,t,e,s,n,G);return L>=0&&R>=0&&o>=0&&U(L,R,o),L=R,R=o,o};n&&(v=t[t.length-2],E.x=s.x-v.x,E.y=s.y-v.y,N=y(E),E.x/=N,E.y/=N);let V=!1;for(let l=0;l<t.length;++l){if(V&&(V=!1,G=0),v&&(C.x=-E.x,C.y=-E.y,M=N,G+M>F&&(V=!0)),V){const e=(F-G)/M;M=F-G,v={x:(1-e)*v.x+e*t[l].x,y:(1-e)*v.y+e*t[l].y},--l}else v=t[l];S=v.x,P=v.y;const e=l<=0&&!V,i=l===t.length-1;if(e||(G+=M),T=i?n?t[1]:null:t[l+1],T?(E.x=T.x-S,E.y=T.y-P,N=y(E),E.x/=N,E.y/=N):(E.x=void 0,E.y=void 0),!n){if(e){p(z,E),D=z.x,I=z.y,c===r.be.SQUARE&&(W(-E.y-E.x,E.x-E.y,E.x,E.y,0,-1),W(E.y-E.x,-E.x-E.y,E.x,E.y,0,1)),c===r.be.ROUND&&(W(-E.y-E.x,E.x-E.y,E.x,E.y,-1,-1),W(E.y-E.x,-E.x-E.y,E.x,E.y,-1,1)),c!==r.be.ROUND&&c!==r.be.BUTT||(W(-E.y,E.x,E.x,E.y,0,-1),W(E.y,-E.x,E.x,E.y,0,1));continue}if(i){f(z,C),D=z.x,I=z.y,c!==r.be.ROUND&&c!==r.be.BUTT||(W(C.y,-C.x,-C.x,-C.y,0,-1),W(-C.y,C.x,-C.x,-C.y,0,1)),c===r.be.SQUARE&&(W(C.y-C.x,-C.x-C.y,-C.x,-C.y,0,-1),W(-C.y-C.x,C.x-C.y,-C.x,-C.y,0,1)),c===r.be.ROUND&&(W(C.y-C.x,-C.x-C.y,-C.x,-C.y,1,-1),W(-C.y-C.x,C.x-C.y,-C.x,-C.y,1,1));continue}}let s,o,O=-m(C,E);if(Math.abs(O)<.01)_(C,E)>0?(z.x=C.x,z.y=C.y,O=1,s=Number.MAX_VALUE,o=!0):(p(z,E),O=1,s=1,o=!1);else{z.x=(C.x+E.x)/O,z.y=(C.y+E.y)/O,s=y(z);const t=(s-1)*w*a;o=s>4||t>M&&t>N}D=z.x,I=z.y;let U=u;switch(u){case r.bf.BEVEL:s<1.05&&(U=r.bf.MITER);break;case r.bf.ROUND:s<b&&(U=r.bf.MITER);break;case r.bf.MITER:s>h&&(U=r.bf.BEVEL)}switch(U){case r.bf.MITER:if(W(z.x,z.y,-C.x,-C.y,0,-1),W(-z.x,-z.y,-C.x,-C.y,0,1),i)break;if(k){const t=V?0:G;L=this._writeVertex(S,P,D,I,E.x,E.y,z.x,z.y,0,-1,t),R=this._writeVertex(S,P,D,I,E.x,E.y,-z.x,-z.y,0,1,t)}break;case r.bf.BEVEL:{const t=O<0;let e,r,s,n;if(t){const t=L;L=R,R=t,e=A,r=B}else e=B,r=A;if(o)s=t?p(this._innerPrev,C):f(this._innerPrev,C),n=t?f(this._innerNext,E):p(this._innerNext,E);else{const e=t?x(this._inner,z):d(this._inner,z);s=e,n=e}const a=t?f(this._bevelStart,C):p(this._bevelStart,C);W(s.x,s.y,-C.x,-C.y,e.x,e.y);const c=W(a.x,a.y,-C.x,-C.y,r.x,r.y);if(i)break;const u=t?p(this._bevelEnd,E):f(this._bevelEnd,E);if(o){const t=this._writeVertex(S,P,D,I,-C.x,-C.y,0,0,0,0,G);L=this._writeVertex(S,P,D,I,E.x,E.y,n.x,n.y,e.x,e.y,G),R=this._writeVertex(S,P,D,I,E.x,E.y,u.x,u.y,r.x,r.y,G),this._writeTriangle(c,t,R)}else{if(k){const t=this._bevelMiddle;t.x=(a.x+u.x)/2,t.y=(a.y+u.y)/2,g(Y,t,-C.x,-C.y),W(t.x,t.y,-C.x,-C.y,Y.x,Y.y),g(Y,t,E.x,E.y),L=this._writeVertex(S,P,D,I,E.x,E.y,t.x,t.y,Y.x,Y.y,G),R=this._writeVertex(S,P,D,I,E.x,E.y,n.x,n.y,e.x,e.y,G)}else{const t=L;L=R,R=t}W(u.x,u.y,E.x,E.y,r.x,r.y)}if(t){const t=L;L=R,R=t}break}case r.bf.ROUND:{const t=O<0;let e,r;if(t){const t=L;L=R,R=t,e=A,r=B}else e=B,r=A;const n=t?x(this._inner,z):d(this._inner,z);let a,c;o?(a=t?p(this._innerPrev,C):f(this._innerPrev,C),c=t?f(this._innerNext,E):p(this._innerNext,E)):(a=n,c=n);const u=t?f(this._roundStart,C):p(this._roundStart,C),l=t?p(this._roundEnd,E):f(this._roundEnd,E),h=W(a.x,a.y,-C.x,-C.y,e.x,e.y),y=W(u.x,u.y,-C.x,-C.y,r.x,r.y);if(i)break;const m=this._writeVertex(S,P,D,I,-C.x,-C.y,0,0,0,0,G);o||this._writeTriangle(L,R,m);const b=x(this._outer,n),w=this._writeVertex(S,P,D,I,E.x,E.y,l.x,l.y,r.x,r.y,G);let v,T;const M=s>2;if(M){let e;s!==Number.MAX_VALUE?(b.x/=s,b.y/=s,e=_(C,b),e=(s*(e*e-1)+1)/e):e=-1,v=t?f(this._startBreak,C):p(this._startBreak,C),v.x+=C.x*e,v.y+=C.y*e,T=t?p(this._endBreak,E):f(this._endBreak,E),T.x+=E.x*e,T.y+=E.y*e}g(Y,b,-C.x,-C.y);const N=this._writeVertex(S,P,D,I,-C.x,-C.y,b.x,b.y,Y.x,Y.y,G);g(Y,b,E.x,E.y);const F=k?this._writeVertex(S,P,D,I,E.x,E.y,b.x,b.y,Y.x,Y.y,G):N,U=m,V=k?this._writeVertex(S,P,D,I,E.x,E.y,0,0,0,0,G):m;let H=-1,q=-1;if(M&&(g(Y,v,-C.x,-C.y),H=this._writeVertex(S,P,D,I,-C.x,-C.y,v.x,v.y,Y.x,Y.y,G),g(Y,T,E.x,E.y),q=this._writeVertex(S,P,D,I,E.x,E.y,T.x,T.y,Y.x,Y.y,G)),k?M?(this._writeTriangle(U,y,H),this._writeTriangle(U,H,N),this._writeTriangle(V,F,q),this._writeTriangle(V,q,w)):(this._writeTriangle(U,y,N),this._writeTriangle(V,F,w)):M?(this._writeTriangle(m,y,H),this._writeTriangle(m,H,q),this._writeTriangle(m,q,w)):(this._writeTriangle(m,y,N),this._writeTriangle(m,F,w)),o?(L=this._writeVertex(S,P,D,I,E.x,E.y,c.x,c.y,e.x,e.y,G),R=w):(L=k?this._writeVertex(S,P,D,I,E.x,E.y,c.x,c.y,e.x,e.y,G):h,this._writeTriangle(L,V,w),R=w),t){const t=L;L=R,R=t}break}}}}}}}]);
//# sourceMappingURL=2347.a16fc247.js.map