"use strict";(self["webpackChunkramp_website"]=self["webpackChunkramp_website"]||[]).push([[3688],{33688:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var l=a(44444);const r={class:"rv-geosearch-bar relative h-26 mx-8 mb-8"},s=["placeholder","value","aria-label"],n={class:"absolute inset-y-0 right-8 grid w-10 place-content-center"},o=["aria-label","content"],f=(0,l.fI)({__name:"search-bar",setup(e){const{t:t}=(0,l.fJ)(),a=(0,l.kd)(),f=(0,l.fK)(),i=(0,l.fM)((()=>a.searchVal)),c=(0,l.fM)((()=>['"',"$","!","*","+","?","^","{","}","(",")","|","[","]"].filter((e=>a.searchVal.includes(e))).join(""))),u=e=>{a.setSearchTerm(e),a.setSearchRegex(e)},p=(0,l.g1)(500,(e=>{u(e)}));return(e,a)=>{const u=(0,l.fO)("tippy");return(0,l.fQ)(),(0,l.fU)("div",r,[(0,l.fT)("input",{type:"text",class:(0,l.fW)(["border-b w-full text-base py-8 outline-none focus:shadow-outline border-gray-600 h-full min-w-0",{"border-yellow-500":c.value}]),placeholder:(0,l.fY)(t)("geosearch.searchText"),value:i.value,onInput:a[0]||(a[0]=e=>(0,l.fY)(p)(e.target.value)),onKeyup:a[1]||(a[1]=(0,l.kc)((e=>{(0,l.fY)(f).mobileView&&e.target.blur()}),["enter"])),"aria-label":(0,l.fY)(t)("geosearch.searchText"),onKeypress:a[2]||(a[2]=(0,l.kc)((0,l.kb)((()=>{}),["prevent"]),["enter"])),enterkeyhint:"done"},null,42,s),(0,l.fT)("span",n,[c.value?(0,l.fP)(((0,l.fQ)(),(0,l.fU)("button",{key:0,class:"cursor-default","aria-label":(0,l.fY)(t)("geosearch.badChars",{chars:c.value}),content:(0,l.fY)(t)("geosearch.badChars",{chars:c.value})},a[3]||(a[3]=[(0,l.g6)(" âš  ")]),8,o)),[[u]]):(0,l.g7)("",!0)])])}}}),i={class:"w-fit inline-block sm:w-1/2 h-26 mb-8 sm:mb-0 pr-16 sm:pr-0"},c=["value","aria-label"],u={value:"",disabled:"",hidden:""},p={class:"sm:w-1/2 h-26 sm:mx-16 flex"},v=["value","aria-label"],b={value:"",disabled:"",hidden:""},d=["disabled","content","aria-label"],g=(0,l.fI)({__name:"top-filters",setup(e){const{t:t}=(0,l.fJ)(),a=(0,l.f_)("iApi"),r=(0,l.kd)(),s=(0,l.f$)(),n=(0,l.f$)(),o=(0,l.f$)(),f=(0,l.f$)([]),g=(0,l.f$)([]),h=(0,l.f$)([]),m=(0,l.fM)((()=>r.queryParams)),y=(0,l.fM)((()=>a.language)),x=e=>r.setProvince(e),k=e=>r.setType(e),w=()=>{x({}),k({})},L=()=>{r.initService(a.language,a.fixture.get("geosearch").config);const e=f.value.find((e=>m.value.province===e.name))?.code,t=g.value.find((e=>m.value.type===e.name))?.code;r.getProvinces.then((t=>{f.value=t,x({province:t.find((t=>t.code===e))?.name,forceReRun:!0})})),r.getTypes.then((e=>{g.value=e,k({type:e.find((e=>e.code===t))?.name,forceReRun:!0})}))},T=()=>{n.value._tippy.hide()},_=()=>{o.value._tippy.hide()},Q=e=>{"Tab"===e.key&&n.value?.matches(":focus")&&navigator.userAgent.includes("Firefox")?n.value._tippy.show():n.value._tippy.hide()},U=e=>{"Tab"===e.key&&o.value?.matches(":focus")&&navigator.userAgent.includes("Firefox")?o.value._tippy.show():o.value._tippy.hide()};return(0,l.g2)((()=>{L(),h.value.push((0,l.g3)(y,L))})),(0,l.g4)((()=>{n.value?.addEventListener("blur",T),n.value?.addEventListener("keyup",Q),o.value?.addEventListener("blur",_),o.value?.addEventListener("keyup",U)})),(0,l.g5)((()=>{h.value.forEach((e=>e())),n.value?.removeEventListener("blur",T),n.value?.removeEventListener("keyup",Q),o.value?.removeEventListener("blur",_),o.value?.removeEventListener("keyup",U)})),(e,a)=>{const r=(0,l.fO)("truncate"),h=(0,l.fO)("tippy");return(0,l.fQ)(),(0,l.fU)("div",{class:"rv-geosearch-top-filters sm:flex items-center w-full ml-8 mb-14",ref_key:"el",ref:s},[(0,l.fT)("div",i,[(0,l.fP)(((0,l.fQ)(),(0,l.fU)("select",{class:"border-b border-b-gray-600 w-full h-full py-0 cursor-pointer",value:m.value.province,"aria-label":(0,l.fY)(t)("geosearch.filters.province"),onChange:a[0]||(a[0]=e=>x({province:e.target.value})),ref_key:"selectProvince",ref:n},[(0,l.fP)(((0,l.fQ)(),(0,l.fU)("option",u,[(0,l.g6)((0,l.fX)((0,l.fY)(t)("geosearch.filters.province")),1)])),[[r]]),((0,l.fQ)(!0),(0,l.fU)(l.fZ,null,(0,l.fV)(f.value,(e=>(0,l.fP)(((0,l.fQ)(),(0,l.fU)("option",{key:e.code},[(0,l.g6)((0,l.fX)(e.name),1)])),[[r]]))),128))],40,c)),[[r],[h,{content:(0,l.fY)(t)("select.items"),trigger:"manual",placement:"top-start"}]])]),(0,l.fT)("div",p,[(0,l.fP)(((0,l.fQ)(),(0,l.fU)("select",{class:"border-b border-b-gray-600 w-full h-full py-0 cursor-pointer max-w-150",value:m.value.type,"aria-label":(0,l.fY)(t)("geosearch.filters.type"),onChange:a[1]||(a[1]=e=>k({type:e.target.value})),ref_key:"selectFilter",ref:o},[(0,l.fT)("option",b,(0,l.fX)((0,l.fY)(t)("geosearch.filters.type")),1),((0,l.fQ)(!0),(0,l.fU)(l.fZ,null,(0,l.fV)(g.value,(e=>((0,l.fQ)(),(0,l.fU)("option",{key:e.code},(0,l.fX)(e.name),1)))),128))],40,v)),[[r],[h,{content:(0,l.fY)(t)("select.items"),trigger:"manual",placement:"top-start"}]]),(0,l.fP)(((0,l.fQ)(),(0,l.fU)("button",{type:"button",class:"text-gray-500 w-1/8 h-24 pl-8 pr-16 sm:pr-8 hover:text-black disabled:cursor-default disabled:text-gray-400",disabled:!m.value.type&&!m.value.province,onClick:w,content:(0,l.fY)(t)("geosearch.filters.clear"),"aria-label":(0,l.fY)(t)("geosearch.filters.clear")},a[2]||(a[2]=[(0,l.fT)("div",{class:"rv-geosearch-icon"},[(0,l.fT)("svg",{class:"fill-current w-18 h-18",viewBox:"0 0 23 21"},[(0,l.fT)("path",{d:"M 14.7574,20.8284L 17.6036,17.9822L 14.7574,15.1716L 16.1716,13.7574L 19.0178,16.568L 21.8284,13.7574L 23.2426,15.1716L 20.432,17.9822L 23.2426,20.8284L 21.8284,22.2426L 19.0178,19.3964L 16.1716,22.2426L 14.7574,20.8284 Z M 2,2L 19.9888,2.00001L 20,2.00001L 20,2.01122L 20,3.99999L 19.9207,3.99999L 13,10.9207L 13,22.909L 8.99999,18.909L 8.99999,10.906L 2.09405,3.99999L 2,3.99999L 2,2 Z "})])],-1)]),8,d)),[[h,{placement:"bottom"}]])])],512)}}}),h={class:"rv-geosearch-bottom-filters"},m={class:"bg-white"},y={class:"ml-8 cursor-pointer font-normal"},x=["checked"],k=(0,l.fI)({__name:"bottom-filters",setup(e){const{t:t}=(0,l.fJ)(),a=(0,l.f_)("iApi"),r=(0,l.kd)(),s=(0,l.fM)((()=>r.resultsVisible)),n=(0,l.g1)(300,(e=>{f(e).then((e=>{o({extent:e,visible:s.value})}))})),o=e=>{r.setMapExtent(e)},f=async e=>4326===e.sr.wkid?e:await a.geo.proj.projectGeometry(4326,e),i=e=>{f(a.geo.map.getExtent()).then((t=>{o({extent:t,visible:e})}))};return(0,l.g4)((()=>{a.event.on(l.g9.MAP_EXTENTCHANGE,n,"geosearch_map_extent")})),(0,l.g5)((()=>{a.event.off("geosearch_map_extent")})),(e,a)=>((0,l.fQ)(),(0,l.fU)("div",h,[(0,l.fT)("div",m,[(0,l.fT)("label",y,[(0,l.fT)("input",{type:"checkbox",class:"border-2 mx-8 border-gray-600 cursor-pointer",checked:s.value,onChange:a[0]||(a[0]=e=>i(e.target.checked)),onKeypress:a[1]||(a[1]=(0,l.kc)((0,l.kb)((()=>{}),["prevent"]),["enter"]))},null,40,x),(0,l.g6)((0,l.fX)((0,l.fY)(t)("geosearch.visible")),1)])])]))}}),w={},L={class:"w-full h-6 relative overflow-hidden rounded-full indeterminate mb-14"},T={class:"h-full progressbar bg-blue-800 rounded-full top-0","aria-valuemin":"0","aria-valuemax":"100"},_={class:"flex items-center h-full"};function Q(e,t){return(0,l.fQ)(),(0,l.fU)("div",L,[(0,l.fT)("div",T,[(0,l.fT)("span",_,[(0,l.ky)(e.$slots,"default",{},void 0,!0)])])])}const U=(0,l.jO)(w,[["render",Q],["__scopeId","data-v-0a8d1c36"]]),Y={class:"flex flex-col h-full"},E={key:1,class:"text-red-900 text-xs px-8 mb-10"},M={key:2,class:"px-8 mb-10 py-8 flex-grow text-wrap border-y border-gray-600 overflow-y-auto"},P={class:"relative h-48"},R={class:"font-bold text-blue-600"},X={key:3,class:"rv-results-list flex-grow mb-5 border-t border-b border-gray-600 overflow-y-auto"},C=["onClick"],$={class:"rv-result-description px-8"},O={class:"flex-1 text-left truncate font-bold leading-tight"},V=["innerHTML"],A={key:0,class:"text-gray-600 text-sm"},S={key:1,class:"hidden"},j={key:2,class:"text-sm font-normal"},I=(0,l.fI)({__name:"screen",props:{panel:{type:Object}},setup(e){const{t:t}=(0,l.fJ)(),a=(0,l.f_)("iApi"),r=(0,l.kd)(),s=(0,l.fM)((()=>r.searchVal.replace(/["!*$+?^{}()|[\]\\]/g,"").trim())),n=(0,l.fM)((()=>r.searchResults)),o=(0,l.fM)((()=>r.loadingResults)),i=(0,l.fM)((()=>r.failedServices)),c=e=>{let t=new l.mh("zoomies",[[[e.bbox[0],e.bbox[1]],[e.bbox[0],e.bbox[3]],[e.bbox[2],e.bbox[3]],[e.bbox[2],e.bbox[1]],[e.bbox[0],e.bbox[1]]]],l.mi.latLongSR(),!0);a.geo.map.zoomMapTo(t)},u=(e,t)=>{const a=e.replace(new RegExp(`${r.searchRegex}`,"gi"),(e=>'<span class="font-bold text-blue-600">'+e+"</span>"));return t?a+",":a};return(a,r)=>{const p=(0,l.fN)("panel-screen"),v=(0,l.fO)("truncate"),b=(0,l.fO)("focus-item"),d=(0,l.fO)("focus-list");return(0,l.fQ)(),(0,l.fR)(p,{panel:e.panel},{header:(0,l.fS)((()=>[(0,l.g6)((0,l.fX)((0,l.fY)(t)("geosearch.title")),1)])),content:(0,l.fS)((()=>[(0,l.fT)("div",Y,[(0,l.h4)(f),(0,l.h4)(g),o.value?((0,l.fQ)(),(0,l.fR)(U,{key:0,class:"flex-none"})):(0,l.g7)("",!0),i.value.length>0&&!o.value?((0,l.fQ)(),(0,l.fU)("div",E,(0,l.fX)((0,l.fY)(t)("geosearch.serviceError",{services:i.value.join(", ")})),1)):(0,l.g7)("",!0),s.value&&0===n.value.length&&!o.value?((0,l.fQ)(),(0,l.fU)("div",M,[(0,l.fT)("span",P,[(0,l.g6)((0,l.fX)((0,l.fY)(t)("geosearch.noResults")),1),(0,l.fT)("span",R,'"'+(0,l.fX)(s.value)+'"',1)])])):(0,l.g7)("",!0),n.value.length>0?(0,l.fP)(((0,l.fQ)(),(0,l.fU)("ul",X,[((0,l.fQ)(!0),(0,l.fU)(l.fZ,null,(0,l.fV)(n.value,((e,t)=>((0,l.fQ)(),(0,l.fU)("li",{class:"relative h-56",key:t},[(0,l.fP)(((0,l.fQ)(),(0,l.fU)("button",{type:"button",class:"absolute inset-0 h-full w-full hover:bg-gray-300 default-focus-style",onClick:t=>c(e),style:{"border-bottom":"1px solid lightgray"},"truncate-trigger":""},[(0,l.fT)("div",$,[(0,l.fP)(((0,l.fQ)(),(0,l.fU)("div",O,[(0,l.fT)("span",{innerHTML:u(e.name,e.location.province)},null,8,V),e.location.province?((0,l.fQ)(),(0,l.fU)("span",A,(0,l.fX)(e.location.city?" "+e.location.city+", "+e.location.province.abbr:" "+e.location.province.abbr),1)):(0,l.g7)("",!0),e.type?((0,l.fQ)(),(0,l.fU)("span",S,"; ")):(0,l.g7)("",!0),e.type?((0,l.fQ)(),(0,l.fU)("span",j,[r[0]||(r[0]=(0,l.fT)("br",null,null,-1)),(0,l.g6)((0,l.fX)(e.type),1)])):(0,l.g7)("",!0)])),[[v,{externalTrigger:!0,options:{placement:"top-start"}}]])])],8,C)),[[b,"show-truncate"]])])))),128))])),[[d]]):(0,l.g7)("",!0),(0,l.h4)(k,{class:"mt-auto"})])])),_:1},8,["panel"])}}})}}]);
//# sourceMappingURL=3688.1aa6a75e.js.map